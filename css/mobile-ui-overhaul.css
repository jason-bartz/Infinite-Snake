/* Mobile UI Overhaul - Modern Collapsible Interface */

/* Override existing mobile styles with higher specificity */
body.mobile .leaderboard-box.collapsed .leaderboard-header::after {
    display: none !important;
}

/* Hide existing leaderboard header text when our UI is active */
body.mobile .leaderboard-box .leaderboard-header {
    font-size: 0 !important; /* Hide text but keep element */
}

/* Force hide the boost bar on mobile */
body.mobile .boost-bar-container {
    display: none !important;
    visibility: hidden !important;
    opacity: 0 !important;
    height: 0 !important;
    overflow: hidden !important;
}

/* =============== COLLAPSIBLE STATS PANEL =============== */
body.mobile .player-info-box {
        /* Positioning */
        position: fixed !important;
        top: 10px !important;
        left: 0 !important;
        bottom: unset !important;
        right: unset !important;
        
        /* Dimensions */
        width: 280px !important;
        max-width: 80vw !important;
        
        /* Slide-out behavior */
        transform: translateX(-240px);
        transition: transform 0.3s ease-out;
        
        /* Visual styles */
        background: rgba(16, 16, 64, 0.95) !important;
        border-left: none !important;
        border-radius: 0 8px 8px 0 !important;
        box-shadow: 4px 0 20px rgba(0, 0, 0, 0.5) !important;
        z-index: 100 !important;
    }
    
    /* Stats panel expanded state */
    body.mobile .player-info-box.expanded {
        transform: translateX(0);
    }
    
    /* Tab handle for stats panel */
    body.mobile .player-info-box::after {
        content: '';
        position: absolute;
        right: -40px;
        top: 10px;
        width: 40px;
        height: 60px;
        background: rgba(16, 16, 64, 0.9);
        border: 2px solid var(--snes-light-blue);
        border-left: none;
        border-radius: 0 8px 8px 0;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        box-shadow: 4px 0 10px rgba(0, 0, 0, 0.3);
    }
    
    /* Snake skin preview in tab */
    body.mobile .player-info-box::before {
        content: '';
        position: absolute;
        right: -32px;
        top: 18px;
        width: 44px;
        height: 44px;
        background-image: var(--player-skin-url);
        background-size: contain;
        background-repeat: no-repeat;
        background-position: center;
        image-rendering: pixelated;
        pointer-events: none;
        z-index: 1;
    }
    
/* =============== COLLAPSIBLE LEADERBOARD =============== */
body.mobile .leaderboard-box {
        /* Positioning */
        position: fixed !important;
        top: 80px !important;
        left: 0 !important;
        bottom: unset !important;
        right: unset !important;
        
        /* Dimensions */
        width: 280px !important;
        max-width: 80vw !important;
        
        /* Slide-out behavior */
        transform: translateX(-240px);
        transition: transform 0.3s ease-out;
        
        /* Visual styles */
        background: rgba(0, 0, 0, 0.95) !important;
        border-left: none !important;
        border-radius: 0 8px 8px 0 !important;
        box-shadow: 4px 0 20px rgba(0, 0, 0, 0.5) !important;
        z-index: 100 !important;
    }
    
    /* Leaderboard expanded state */
    body.mobile .leaderboard-box.expanded {
        transform: translateX(0);
    }
    
    /* Tab handle for leaderboard */
    body.mobile .leaderboard-box::after {
        content: 'üèÜ';
        position: absolute;
        right: -40px;
        top: 10px;
        width: 40px;
        height: 60px;
        background: rgba(0, 0, 0, 0.9);
        border: 2px solid var(--snes-white);
        border-left: none;
        border-radius: 0 8px 8px 0;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 24px;
        box-shadow: 4px 0 10px rgba(0, 0, 0, 0.3);
    }
    
/* =============== BOOST BUTTON WITH FILL EFFECT =============== */
body.mobile .boost-bar-container {
        display: none !important; /* Hide the visual boost bar */
    }
    
    body.mobile .boost-button {
        /* Enhanced styling */
        position: relative;
        overflow: hidden;
        background: rgba(78, 205, 196, 0.1) !important;
        border: 3px solid rgba(78, 205, 196, 0.4) !important;
    }
    
    /* Boost fill effect inside button */
    body.mobile .boost-button::before {
        content: '';
        position: absolute;
        bottom: 0;
        left: 0;
        right: 0;
        height: var(--boost-fill, 100%);
        background: linear-gradient(to top, 
            rgba(78, 205, 196, 0.6) 0%, 
            rgba(78, 205, 196, 0.3) 100%);
        transition: height 0.1s linear;
        pointer-events: none;
    }
    
    /* Boost text on top of fill */
    body.mobile .boost-button span {
        position: relative;
        z-index: 1;
    }
    
    /* Active boost state */
    body.mobile .boost-button.active {
        background: rgba(78, 205, 196, 0.2) !important;
        border-color: rgba(78, 205, 196, 0.8) !important;
        animation: boostPulse 0.5s ease-in-out infinite;
    }
    
    @keyframes boostPulse {
        0%, 100% { transform: scale(0.95); }
        50% { transform: scale(1.05); }
    }
    
/* =============== DISCOVERY FEED OPACITY FADE =============== */
body.mobile .discovery-feed {
        display: flex !important; /* Show on mobile */
        position: fixed !important;
        top: 50% !important;
        left: 10px !important;
        transform: translateY(-50%) !important;
        width: 250px !important;
        max-height: 40vh !important;
        
        /* Opacity fade from left to right */
        mask-image: linear-gradient(to right, 
            rgba(0, 0, 0, 0.8) 0%, 
            rgba(0, 0, 0, 0.4) 70%, 
            rgba(0, 0, 0, 0) 100%);
        -webkit-mask-image: linear-gradient(to right, 
            rgba(0, 0, 0, 0.8) 0%, 
            rgba(0, 0, 0, 0.4) 70%, 
            rgba(0, 0, 0, 0) 100%);
        
        opacity: 0.7 !important;
        z-index: 10 !important;
    }
    
    /* Individual messages also fade */
    body.mobile .discovery-message {
        background: linear-gradient(to right,
            rgba(16, 32, 64, 0.9) 0%,
            rgba(16, 32, 64, 0.6) 70%,
            rgba(16, 32, 64, 0) 100%) !important;
        border-right: none !important;
        padding-right: 20px !important;
        backdrop-filter: blur(4px);
        -webkit-backdrop-filter: blur(4px);
    }
    
    /* Ensure text remains readable */
    body.mobile .discovery-message .discovery-name,
    body.mobile .discovery-message .discovery-combo {
        position: relative;
        z-index: 1;
    }
    
/* =============== CONSISTENT BORDERS AND COLORS =============== */
/* Ensure all mobile UI elements have consistent SNES-style borders */
body.mobile .player-info-box,
body.mobile .leaderboard-box {
        border-width: 3px !important;
        border-style: solid !important;
    }
    
    body.mobile .player-info-box {
        border-color: var(--snes-light-blue) var(--snes-dark-blue) var(--snes-dark-blue) var(--snes-light-blue) !important;
    }
    
    body.mobile .leaderboard-box {
        border-color: var(--snes-white) #505050 #505050 var(--snes-white) !important;
    }
    
/* =============== LANDSCAPE ADJUSTMENTS =============== */
@media (orientation: landscape) {
        body.mobile .player-info-box,
        body.mobile .leaderboard-box {
            max-height: 80vh !important;
            overflow-y: auto !important;
        }
        
        body.mobile .discovery-feed {
            max-height: 60vh !important;
        }
    }
    
/* =============== TOUCH INTERACTIONS =============== */
/* Tap target improvements */
body.mobile .player-info-box::after,
body.mobile .leaderboard-box::after {
        min-width: 50px;
        min-height: 70px;
    }
    
/* Prevent accidental taps */
body.mobile .player-info-box.expanded,
body.mobile .leaderboard-box.expanded {
    box-shadow: 0 0 0 100vmax rgba(0, 0, 0, 0.3) !important;
}

/* CSS variable for player skin (set via JavaScript) */
:root {
    --player-skin-url: url('../skins/snake-default-green.png');
}

/* Additional mobile improvements */
@media (max-width: 800px) {
    /* Low boost state styling */
    body.mobile .boost-button.low-boost {
        border-color: rgba(255, 68, 68, 0.5) !important;
        background: rgba(255, 68, 68, 0.1) !important;
    }
    
    body.mobile .boost-button.low-boost::before {
        background: linear-gradient(to top, 
            rgba(255, 68, 68, 0.6) 0%, 
            rgba(255, 68, 68, 0.3) 100%);
    }
    
    /* Ensure controls are always visible and accessible */
    body.mobile .mobile-controls {
        z-index: 90 !important; /* Below panels but above game */
    }
    
    /* Improved text readability */
    body.mobile .stat-label,
    body.mobile .stat-value {
        text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.8) !important;
    }
    
    /* Better touch feedback */
    body.mobile .player-info-box::after:active,
    body.mobile .leaderboard-box::after:active {
        transform: scale(0.95);
    }
    
    /* Smooth panel animations */
    body.mobile .player-info-box,
    body.mobile .leaderboard-box {
        will-change: transform;
        -webkit-transform: translateZ(0);
        backface-visibility: hidden;
    }
    
    /* Fix any z-index conflicts */
    body.mobile #gameContainer {
        z-index: 1;
    }
    
    body.mobile .bottom-ui {
        z-index: 20 !important;
    }
    
    /* Portrait mode specific adjustments */
    @media (orientation: portrait) {
        body.mobile .discovery-feed {
            font-size: 0.9em !important;
            width: 200px !important;
        }
        
        body.mobile .discovery-message {
            padding: 6px 10px !important;
            margin: 2px 0 !important;
        }
    }
    
    /* Ensure boost button text is always visible */
    body.mobile .boost-button {
        font-family: 'Press Start 2P', monospace !important;
        letter-spacing: -1px !important;
    }
}