<!DOCTYPE html>
<html>
<head>
    <title>Mobile Tabs Debug</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>
    <h1>Mobile Tabs Debug</h1>
    
    <div id="debug-output" style="white-space: pre-wrap; font-family: monospace; background: #f0f0f0; padding: 20px; margin: 20px;">
    </div>

    <script>
        const output = document.getElementById('debug-output');
        
        function log(msg) {
            output.textContent += msg + '\n';
        }

        // Check if the page is being loaded as mobile
        log('=== Mobile Detection ===');
        log('User Agent: ' + navigator.userAgent);
        log('Window width: ' + window.innerWidth);
        log('Has touch: ' + ('ontouchstart' in window));
        log('Pointer coarse: ' + window.matchMedia("(pointer: coarse)").matches);
        
        // Check for required elements
        setTimeout(() => {
            log('\n=== DOM Elements Check ===');
            
            const body = document.body;
            log('Body has mobile class: ' + body.classList.contains('mobile'));
            
            const statsPanel = document.querySelector('.player-info-box');
            log('Stats panel found: ' + (statsPanel !== null));
            
            const leaderboardPanel = document.querySelector('.leaderboard-box');
            log('Leaderboard panel found: ' + (leaderboardPanel !== null));
            
            const statsTabs = document.querySelectorAll('.player-info-box .mobile-tab-handle');
            log('Stats tabs found: ' + statsTabs.length);
            
            const leaderboardTabs = document.querySelectorAll('.leaderboard-box .mobile-tab-handle');
            log('Leaderboard tabs found: ' + leaderboardTabs.length);
            
            // Check if UnifiedMobileUI is initialized
            log('\n=== UnifiedMobileUI Status ===');
            log('window.unifiedMobileUI exists: ' + (window.unifiedMobileUI !== undefined));
            if (window.unifiedMobileUI) {
                log('isInitialized: ' + window.unifiedMobileUI.isInitialized);
                log('statsPanel: ' + (window.unifiedMobileUI.statsPanel !== null));
                log('leaderboardPanel: ' + (window.unifiedMobileUI.leaderboardPanel !== null));
            }
            
            // Check CSS
            log('\n=== CSS Check ===');
            const cssFiles = Array.from(document.querySelectorAll('link[rel="stylesheet"]'))
                .map(link => link.href.split('/').pop());
            log('Loaded CSS files: ' + cssFiles.join(', '));
            
            // Check for any console errors
            if (window.console && window.console.error) {
                const originalError = console.error;
                console.error = function() {
                    log('\n!!! Console Error: ' + Array.from(arguments).join(' '));
                    originalError.apply(console, arguments);
                };
            }
            
        }, 1000);
        
        // Load the actual game page in an iframe to test
        log('\n=== Loading game page in iframe ===');
        const iframe = document.createElement('iframe');
        iframe.src = 'index.html';
        iframe.style.width = '100%';
        iframe.style.height = '600px';
        iframe.style.border = '2px solid #333';
        document.body.appendChild(iframe);
        
        iframe.onload = function() {
            setTimeout(() => {
                const iframeDoc = iframe.contentDocument || iframe.contentWindow.document;
                const iframeBody = iframeDoc.body;
                
                log('\n=== Iframe Check ===');
                log('Iframe body has mobile class: ' + iframeBody.classList.contains('mobile'));
                
                const iframeStatsTabs = iframeDoc.querySelectorAll('.player-info-box .mobile-tab-handle');
                log('Iframe stats tabs found: ' + iframeStatsTabs.length);
                
                const iframeLeaderboardTabs = iframeDoc.querySelectorAll('.leaderboard-box .mobile-tab-handle');
                log('Iframe leaderboard tabs found: ' + iframeLeaderboardTabs.length);
                
                // Force mobile class
                if (!iframeBody.classList.contains('mobile')) {
                    log('\nForcing mobile class...');
                    iframeBody.classList.add('mobile');
                    
                    // Try to manually init
                    if (iframe.contentWindow.unifiedMobileUI) {
                        log('Manually calling init()...');
                        iframe.contentWindow.unifiedMobileUI.init();
                    }
                }
                
                // Check again after a delay
                setTimeout(() => {
                    log('\n=== Final Check ===');
                    const finalStatsTabs = iframeDoc.querySelectorAll('.player-info-box .mobile-tab-handle');
                    log('Final stats tabs found: ' + finalStatsTabs.length);
                    
                    const finalLeaderboardTabs = iframeDoc.querySelectorAll('.leaderboard-box .mobile-tab-handle');
                    log('Final leaderboard tabs found: ' + finalLeaderboardTabs.length);
                    
                    if (finalStatsTabs.length > 0) {
                        log('\nStats tab details:');
                        finalStatsTabs.forEach((tab, i) => {
                            const computed = iframe.contentWindow.getComputedStyle(tab);
                            log(`Tab ${i}: display=${computed.display}, visibility=${computed.visibility}, opacity=${computed.opacity}`);
                        });
                    }
                }, 2000);
                
            }, 1500);
        };
    </script>
</body>
</html>