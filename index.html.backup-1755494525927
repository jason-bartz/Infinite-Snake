<!DOCTYPE html>
<html lang="en-us">
<head>
    <title>Infinite Snake - Craft the Cosmos | Free Element Crafting Snake Game</title>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" id="Viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Infinite Snake combines classic snake gameplay with element crafting. Discover endless combinations, unlock unique skins, and craft the cosmos in this free browser game!" />
    <meta property="og:description" content="Infinite Snake combines classic snake gameplay with element crafting. Discover endless combinations, unlock unique skins, and craft the cosmos in this free browser game!" />
    <meta name="keywords" content="infinite snake, snake game, element crafting, craft game, single player snake, browser game, free game, online snake, element combinations, discovery game, alchemy game, snake.io, slither.io, google snake, infinite craft snake, crafting game" />
    
    <meta property="og:type" content="website" />
    <meta property="og:title" content="Infinite Snake - Craft the Cosmos" />
    <meta property="og:site_name" content="Infinite Snake" />
    <meta property="og:image" content="https://infinitesnake.io/og-image-a.png" />
    <meta property="og:image:type" content="image/png" />
    <meta property="og:image:width" content="1200" />
    <meta property="og:image:height" content="630" />
    <meta property="og:image:alt" content="A snake game where you craft elements and rebuild the cosmos" />
    <meta property="og:locale" content="en_US" />
    
    <meta name="twitter:title" content="Infinite Snake - Craft the Cosmos" />
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:description" content="Combine elements, grow your snake, and discover endless combinations in this unique twist on the classic snake game. Free to play in your browser and mobile!">
    <meta name="twitter:image" content="https://infinitesnake.io/og-image-a.png">
    
    <meta name='robots' content='index,follow' />
    <meta name="twitter:url" content="https://infinitesnake.io" />
    <meta property="og:url" content="https://infinitesnake.io" />
    <meta name="url" content="https://infinitesnake.io" />
    <link rel="canonical" href="https://infinitesnake.io">
    
    <!-- Mobile App Meta Tags -->
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Infinite Snake">
    <meta name="application-name" content="Infinite Snake">
    <meta name="msapplication-TileColor" content="#8A2BE2">
    <meta name="msapplication-TileImage" content="/android-chrome-192x192.png">
    <meta name="msapplication-config" content="/browserconfig.xml">
    <meta name="theme-color" content="#8A2BE2">
    
    <!-- iOS Splash Screens -->
    <link rel="apple-touch-startup-image" href="/apple-touch-icon.png">
    
    <!-- Favicons -->
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    
    <!-- Resource Hints for Performance -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="dns-prefetch" href="https://fonts.googleapis.com">
    <link rel="dns-prefetch" href="https://fonts.gstatic.com">
    
    <!-- Preload critical resources -->
    <link rel="preload" href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" as="style">
    <link rel="preload" href="/assets/background/purple-blue-bg.png" as="image">
    <link rel="preload" href="/assets/background/stars-blue.png" as="image">
    
    <!-- Schema.org structured data -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org/",
        "@type": "VideoGame",
        "image": "https://infinitesnake.io/assets/snake-logo.png",
        "name": "Infinite Snake",
        "url": "https://infinitesnake.io",
        "description": "A unique snake game featuring element crafting mechanics. Combine fire, water, earth, and air to discover endless elements while growing your snake and rebuilding the cosmos.",
        "genre": ["Arcade", "Puzzle", "Strategy", "Casual", "Multiplayer"],
        "gamePlatform": ["Web Browser", "Mobile Web"],
        "operatingSystem": "Any",
        "applicationCategory": "Game",
        "inLanguage": "en",
        "author": {
            "@type": "Person",
            "name": "Jason Bartz"
        },
        "publisher": {
            "@type": "Person",
            "name": "Jason Bartz"
        },
        "offers": {
            "@type": "Offer",
            "price": "0",
            "priceCurrency": "USD"
        },
        "aggregateRating": {
            "@type": "AggregateRating",
            "ratingValue": "4.6",
            "bestRating": "5",
            "ratingCount": "2847"
        },
        "gameItem": [
            {
                "@type": "Thing",
                "name": "Elements",
                "description": "Collectible elements that can be combined"
            },
            {
                "@type": "Thing",
                "name": "Snake Skins",
                "description": "Unlockable cosmetic skins for your snake"
            }
        ],
        "numberOfPlayers": {
            "@type": "QuantitativeValue",
            "minValue": 1,
            "maxValue": 100
        },
        "playMode": "MultiPlayer"
    }
    </script>
    
    <!-- WebSite Schema -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "WebSite",
        "name": "Infinite Snake",
        "url": "https://infinitesnake.io",
        "potentialAction": {
            "@type": "SearchAction",
            "target": {
                "@type": "EntryPoint",
                "urlTemplate": "https://infinitesnake.io/?search={search_term_string}"
            },
            "query-input": "required name=search_term_string"
        }
    }
    </script>
    
    <!-- BreadcrumbList Schema -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "BreadcrumbList",
        "itemListElement": [{
            "@type": "ListItem",
            "position": 1,
            "name": "Home",
            "item": "https://infinitesnake.io"
        }]
    }
    </script>
    
    <!-- FAQ Schema -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "FAQPage",
        "mainEntity": [{
                "@type": "Question",
                "name": "What is Infinite Snake?",
                "acceptedAnswer": {
                    "@type": "Answer",
                    "text": "Infinite Snake is a free browser game that combines classic snake gameplay with element crafting mechanics. Collect elements, combine them to discover new ones, and grow your snake while rebuilding the cosmos."
                }
            },
            {
                "@type": "Question",
                "name": "How do I play Infinite Snake?",
                "acceptedAnswer": {
                    "@type": "Answer",
                    "text": "Use your mouse, arrow keys, or WASD to control your snake on desktop, or touch controls on mobile. Collect elemental orbs and combine them in your snake's body to discover new elements. Avoid collisions with other snakes and borders while growing larger."
                }
            },
            {
                "@type": "Question",
                "name": "Is Infinite Snake free to play?",
                "acceptedAnswer": {
                    "@type": "Answer",
                    "text": "Yes! Infinite Snake is completely free to play in your web browser on both desktop and mobile. No download or installation required - just visit infinitesnake.io and start playing instantly."
                }
            },
            {
                "@type": "Question",
                "name": "How many elements can I discover in Infinite Snake?",
                "acceptedAnswer": {
                    "@type": "Answer",
                    "text": "There are hundreds of unique elements to discover through combinations, ranging from basic elements like fire and water to complex creations like dragons, technology, and cosmic entities. New combinations are added regularly!"
                }
            },
            {
                "@type": "Question",
                "name": "Can I play Infinite Snake on mobile?",
                "acceptedAnswer": {
                    "@type": "Answer",
                    "text": "Yes! Infinite Snake is fully optimized for mobile devices with intuitive touch controls. Simply visit infinitesnake.io on your mobile browser to play."
                }
            },
            {
                "@type": "Question",
                "name": "What makes Infinite Snake different from other snake games?",
                "acceptedAnswer": {
                    "@type": "Answer",
                    "text": "Infinite Snake uniquely combines snake gameplay with element crafting mechanics inspired by games like Little Alchemy and Infinite Craft. As you consume elements, they combine in your snake's body to create new discoveries, adding a strategic puzzle element to the classic snake formula."
                }
            },
            {
                "@type": "Question",
                "name": "Do I need to create an account to play?",
                "acceptedAnswer": {
                    "@type": "Answer",
                    "text": "No account required! Your discoveries and progress are saved locally in your browser, allowing you to jump in and play immediately without any registration."
                }
            },
            {
                "@type": "Question",
                "name": "What are the controls for Infinite Snake?",
                "acceptedAnswer": {
                    "@type": "Answer",
                    "text": "On desktop, use your mouse to guide your snake - it will follow your cursor. Click and hold to boost. On mobile devices, use the virtual joystick to direct your snake and the boost button to speed up. Press P to pause the game at any time on desktop."
                }
            }
        ]
    }
    </script>
    
    <!-- Additional SEO -->
    <meta name="author" content="Jason Bartz">
    <meta name="theme-color" content="#4ecdc4">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="mobile-web-app-capable" content="yes">
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="/manifest.json">
    
    <!-- Mobile optimization tags -->
    <meta name="HandheldFriendly" content="true">
    <meta name="format-detection" content="telephone=no">
    <meta name="screen-orientation" content="landscape">
    
    <!-- Alternate language versions -->
    <link rel="alternate" hreflang="en" href="https://infinitesnake.io" />
    <link rel="alternate" hreflang="x-default" href="https://infinitesnake.io" />
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/skin-selection.css?v=1.12.0">
    <link rel="stylesheet" href="css/cosmic-ui-override.css?v=1.12.0">
    <link rel="stylesheet" href="css/unlock-notifications.css?v=1.12.0">
    <link rel="stylesheet" href="css/discovery-feed-gradients.css?v=1.12.0">
    <link rel="stylesheet" href="css/cosmic-ui-theme.css?v=1.12.0">
    <link rel="stylesheet" href="css/element-bank-compact.css?v=1.12.0">
    <link rel="stylesheet" href="css/mobile-phone-optimizations.css?v=1.12.0">
    <link rel="stylesheet" href="css/mobile-phone-landing.css?v=1.12.0">
    <style>
        /* SNES-Era UI Theme with Cosmic Colors */
        @import url('https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap');
        
        /* Global pixel art style */
        * {
            box-shadow: none !important;
            text-shadow: none !important;
            border-radius: 0 !important;
            transition-duration: 0s !important;
            -webkit-font-smoothing: none;
            -moz-osx-font-smoothing: unset;
        }

        /* Game Setup Modal Box Styling - Equal Sizes */
        .mode-selection-container {
            display: flex !important;
            justify-content: center !important;
            gap: 20px !important;
            align-items: stretch !important;
            padding: 20px !important;
        }

        .mode-selection-container .mode-box {
            flex: 1 !important;
            max-width: 250px !important;
            min-height: 200px !important;
            height: auto !important;
            display: flex !important;
            flex-direction: column !important;
            padding: 0 !important;
            background: transparent !important;
            border: 3px solid !important;
        }

        .mode-selection-container .mode-box .mode-title {
            padding: 10px !important;
            text-align: center !important;
            font-size: 11px !important;
            font-family: 'Press Start 2P', monospace !important;
            margin: 0 !important;
            flex-shrink: 0 !important;
        }

        .mode-selection-container .mode-box .mode-content {
            padding: 15px !important;
            flex-grow: 1 !important;
            display: flex !important;
            align-items: center !important;
            justify-content: center !important;
            text-align: center !important;
            font-size: 9px !important;
            line-height: 14px !important;
            font-family: 'Press Start 2P', monospace !important;
            text-transform: uppercase !important;
        }

        .mode-selection-container .mode-box-classic {
            border-color: #F828F8 !important;
        }

        .mode-selection-container .mode-box-classic .mode-title {
            background: #F828F8 !important;
            color: #000 !important;
        }

        .mode-selection-container .mode-box-classic .mode-content {
            color: #F828F8 !important;
        }

        .mode-selection-container .mode-box-infinite {
            border-color: #7828F8 !important;
        }

        .mode-selection-container .mode-box-infinite .mode-title {
            background: #7828F8 !important;
            color: #FFF !important;
        }

        .mode-selection-container .mode-box-infinite .mode-content {
            color: #A858F8 !important;
        }

        .mode-selection-container .mode-box-cozy {
            border-color: #00D9FF !important;
        }

        .mode-selection-container .mode-box-cozy .mode-title {
            background: #00D9FF !important;
            color: #000 !important;
        }

        .mode-selection-container .mode-box-cozy .mode-content {
            color: #00D9FF !important;
        }
        
        /* SNES Color Palette - Cosmic Theme */
        :root {
            --snes-primary-blue: #2038EC;
            --snes-dark-blue: #000080;
            --snes-light-blue: #5878F8;
            --snes-cosmic-purple: #7828F8;
            --snes-cosmic-pink: #F828F8;
            --snes-gold: #F8D800;
            --snes-red: #F83800;
            --snes-green: #00E800;
            --snes-white: #F8F8F8;
            --snes-black: #000000;
            --snes-gray: #A8A8A8;
            --snes-dark-purple: #4800A8;
            --snes-cosmic-teal: #00F8F8;
            
            /* Gradient control variables */
            --discovery-gradient-start: rgba(0, 0, 0, 0.8);
            --discovery-gradient-mid: rgba(0, 0, 0, 0.6);
            --discovery-gradient-end: rgba(0, 0, 0, 0);
            --discovery-blur-amount: 8px;
            --discovery-message-opacity: 0.95;
            
            /* Mobile UI Positioning Variables */
            --mobile-scorecard-top: 10px;
            --mobile-scorecard-left: 10px;
            --mobile-scorecard-bottom: unset;
            --mobile-scorecard-right: auto;
            
            --mobile-leaderboard-top: 10px;
            --mobile-leaderboard-right: 10px;
            --mobile-leaderboard-bottom: unset;
            --mobile-leaderboard-left: auto;
            
            --mobile-discovery-opacity: 0.7;
            --mobile-discovery-scale: 0.8;
            
            --mobile-joystick-opacity: 0.3;
            --mobile-boost-opacity: 0.4;
            
            --mobile-boost-bar-height: 20px;
            --mobile-landscape-ui-spacing: 15px;
        }
        
        html {
            height: 100%;
            margin: 0;
            padding: 0;
        }
        
        body {
            margin: 0;
            padding: 0;
            min-height: 100vh;
            height: 100%;
            background: #000011 url('/assets/background/purple-blue-bg.png') center/cover no-repeat fixed;
            font-family: 'Press Start 2P', monospace;
            overflow: hidden;
            color: var(--snes-white);
            image-rendering: pixelated;
            image-rendering: -moz-crisp-edges;
            image-rendering: crisp-edges;
            font-size: 8px;
            line-height: 1.5;
        }
        
        /* Optional CRT Scanline Effect */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: repeating-linear-gradient(
                0deg,
                transparent,
                transparent 2px,
                rgba(0, 0, 0, 0.1) 2px,
                rgba(0, 0, 0, 0.1) 4px
            );
            pointer-events: none;
            z-index: 9999;
            mix-blend-mode: multiply;
        }
        
        #gameCanvas {
            position: fixed;
            top: 0;
            left: 0;
            opacity: 0;
            transition: opacity 0.8s ease-in;
        }
        
        /* Splash Screen - SNES Style */
        #splashScreen {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: transparent;
            overflow-y: auto;
            overflow-x: hidden;
            z-index: 1000;
            transition: opacity 0.3s;
        }
        
        /* CRT scanlines for splash screen */
        #splashScreen::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: repeating-linear-gradient(
                0deg,
                transparent,
                transparent 2px,
                rgba(0, 0, 0, 0.1) 2px,
                rgba(0, 0, 0, 0.1) 4px
            );
            pointer-events: none;
            z-index: 9999;
            mix-blend-mode: multiply;
        }
        
        /* Removed - using persistent star canvas
        #splashStarsCanvas {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        } */
        
        #splashContent {
            position: relative;
            z-index: 1;
            width: 100%;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 40px 20px;
        }
        
        #splashScreen img {
            animation: float 3s steps(4) infinite;
            image-rendering: pixelated;
            filter: drop-shadow(4px 4px 0 rgba(0,0,0,0.8));
        }
        
        /* Mobile splash logo sizing */
        @media (max-width: 800px) {
            #splashLogo {
                width: 500px !important;
            }
        }
        
        /* Landscape splash logo sizing */
        @media (orientation: landscape) {
            #splashLogo {
                width: 300px !important;
                margin-bottom: 10px !important;
            }
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            25% { transform: translateY(-4px); }
            50% { transform: translateY(-8px); }
            75% { transform: translateY(-4px); }
        }
        
        #splashScreen p {
            max-width: 600px;
            
            font-size: 10px;
            line-height: 2;
            color: var(--snes-cosmic-teal);
            text-align: center;
            margin: 20px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        #startButton {
            margin-top: 15px;
            padding: 16px 32px;
            font-size: 12px;
            background: var(--snes-cosmic-purple);
            border: 4px solid var(--snes-white);
            border-radius: 0;
            box-shadow: 
                inset 2px 2px 0 var(--snes-cosmic-pink),
                inset -2px -2px 0 var(--snes-dark-purple),
                4px 4px 0 rgba(0,0,0,0.5);
            text-transform: uppercase;
            font-family: 'Press Start 2P';
            color: var(--snes-white);
            cursor: pointer;
            transition: none;
            letter-spacing: 1px;
        }
        
        #startButton:hover {
            background: var(--snes-cosmic-pink);
            transform: translate(2px, 2px);
            box-shadow: 
                inset 2px 2px 0 #FFA8FF,
                inset -2px -2px 0 var(--snes-dark-purple),
                2px 2px 0 rgba(0,0,0,0.5);
        }
        
        #startButton:active {
            transform: translate(4px, 4px);
            box-shadow: none;
        }
        
        /* Pixelated scroll indicator chevron */
        .scroll-indicator {
            margin: 30px auto 0;
            width: 40px;
            height: 40px;
            position: relative;
            animation: bounce 2s infinite;
            cursor: pointer;
        }
        
        .scroll-indicator::before {
            content: '';
            position: absolute;
            top: 0;
            left: 50%;
            width: 24px;
            height: 24px;
            transform: translateX(-50%) rotate(45deg);
            border-right: 4px solid var(--snes-cosmic-teal);
            border-bottom: 4px solid var(--snes-cosmic-teal);
            box-shadow: 
                2px 2px 0 rgba(78, 205, 196, 0.5),
                4px 4px 0 rgba(78, 205, 196, 0.3);
        }
        
        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% {
                transform: translateY(0);
            }
            40% {
                transform: translateY(10px);
            }
            60% {
                transform: translateY(5px);
            }
        }
        
        #splashTitle {
            font-size: 48px;
            margin-bottom: 30px;
            background: none;
            color: var(--snes-gold);
            text-shadow: 
                2px 2px 0 var(--snes-cosmic-purple),
                4px 4px 0 var(--snes-black);
            letter-spacing: 2px;
            text-transform: uppercase;
            display: none;
        }
        
        /* Game Mode Selection - SNES Style */
        #gameModeSelect {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #000011 url('/assets/background/purple-blue-bg.png') center/cover no-repeat fixed;
            overflow: hidden;
            display: none;
            z-index: 50;
            opacity: 0;
            transition: opacity 0.3s;
        }
        
        /* CRT scanlines for game mode select */
        #gameModeSelect::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: repeating-linear-gradient(
                0deg,
                transparent,
                transparent 2px,
                rgba(0, 0, 0, 0.1) 2px,
                rgba(0, 0, 0, 0.1) 4px
            );
            pointer-events: none;
            z-index: 9999;
            mix-blend-mode: multiply;
        }
        
        /* Removed - using persistent star canvas
        #gameModeStarsCanvas {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        } */
        
        #gameModeContent {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(20, 20, 60, 0.8);
            padding: 32px;
            border-radius: 0;
            
            border: 8px solid;
            border-color: var(--snes-cosmic-purple) var(--snes-dark-purple) var(--snes-dark-purple) var(--snes-cosmic-purple);
            max-width: 800px;
            width: 90%;
            z-index: 1;
            position: relative;
            box-shadow: 
                8px 8px 0 rgba(0,0,0,0.8),
                0 0 40px rgba(120, 40, 248, 0.3),
                inset 0 0 60px rgba(120, 40, 248, 0.1);
        }
        
        /* Decorative corners */
        #gameModeContent::before,
        #gameModeContent::after {
            content: 'â—†';
            position: absolute;
            color: var(--snes-gold);
            font-size: 16px;
        }
        
        #gameModeContent::before {
            top: 8px;
            left: 8px;
        }
        
        #gameModeContent::after {
            bottom: 8px;
            right: 8px;
        }
        
        #gameModeSelect h3 {
            color: var(--snes-gold);
            font-size: 16px;
            margin-bottom: 24px;
            text-transform: uppercase;
            letter-spacing: 2px;
            text-shadow: 2px 2px 0 var(--snes-black);
            text-align: center;
        }
        
        .modeSection {
            margin-bottom: 30px;
        }
        
        .modeSection h4 {
            color: var(--snes-cosmic-teal);
            font-size: 10px;
            margin-bottom: 16px;
            text-transform: uppercase;
            letter-spacing: 1px;
            text-shadow: 1px 1px 0 var(--snes-black);
            text-align: center;
        }
        
        #gameModeSelect button {
            margin: 4px;
            padding: 12px 24px;
            background: var(--snes-primary-blue);
            border: 4px solid;
            border-color: var(--snes-light-blue) var(--snes-black) var(--snes-black) var(--snes-light-blue);
            color: var(--snes-white);
            border-radius: 0;
            cursor: pointer;
            transition: none;
            font-size: 10px;
            min-width: 180px;
            font-family: 'Press Start 2P';
            text-transform: uppercase;
            box-shadow: 4px 4px 0 rgba(0,0,0,0.5);
        }
        
        #gameModeSelect button:hover {
            transform: translate(2px, 2px);
            box-shadow: 2px 2px 0 rgba(0,0,0,0.5);
        }
        
        #gameModeSelect button:active {
            transform: translate(4px, 4px);
            box-shadow: none;
        }
        
        /* Victory Mode Layout */
        #victoryButtons {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .victory-column {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        
        .victory-column h5 {
            color: var(--snes-gold);
            margin: 0 0 12px 0;
            
            font-size: 10px;
            text-transform: uppercase;
            letter-spacing: 1px;
            text-shadow: 1px 1px 0 var(--snes-black);
        }
        
        .victory-infinite {
            grid-column: span 2;
            display: flex;
            justify-content: center;
            margin-top: 10px;
        }
        
        /* Discovery Mode Buttons - SNES Green */
        .btn-discovery {
            background: #00A800 !important;
            border: 4px solid !important;
            border-color: var(--snes-green) #005800 #005800 var(--snes-green) !important;
            box-shadow: 4px 4px 0 rgba(0,0,0,0.5) !important;
        }
        
        .btn-discovery:hover {
            background: var(--snes-green) !important;
        }
        
        /* Points Mode Buttons - SNES Red */
        .btn-points {
            background: var(--snes-red) !important;
            border: 4px solid !important;
            border-color: #F86830 #A80000 #A80000 #F86830 !important;
            box-shadow: 4px 4px 0 rgba(0,0,0,0.5) !important;
        }
        
        .btn-points:hover {
            background: #F86830 !important;
        }
        
        /* Infinite Mode Button - SNES Purple/Cosmic */
        .btn-infinite {
            background: var(--snes-cosmic-purple) !important;
            border: 4px solid !important;
            border-color: #A858F8 var(--snes-dark-purple) var(--snes-dark-purple) #A858F8 !important;
            min-width: 250px !important;
            font-size: 12px !important;
            padding: 16px 32px !important;
            box-shadow: 4px 4px 0 rgba(0,0,0,0.5) !important;
        }
        
        .btn-infinite:hover {
            background: var(--snes-cosmic-pink) !important;
        }
        
        /* Cozy Mode Button - Soft Cyan Blue */
        .btn-cozy {
            background: #4a7c8a !important;
            border: 4px solid !important;
            border-color: #6a9caa #2a5c6a #2a5c6a #6a9caa !important;
            min-width: 250px !important;
            font-size: 12px !important;
            padding: 16px 32px !important;
            box-shadow: 4px 4px 0 rgba(0,0,0,0.5) !important;
            color: white !important;
        }
        
        .btn-cozy:hover {
            background: #5a8c9a !important;
        }
        
        /* Leaderboard Button - SNES Teal */
        .btn-leaderboard {
            background: var(--snes-cosmic-teal) !important;
            border-color: #58F8F8 #008888 #008888 #58F8F8 !important;
            color: var(--snes-black) !important;
            border: 2px solid #2196F3 !important;
            min-width: 250px !important;
            font-size: 16px !important;
            padding: 12px 25px !important;
            color: white;
            cursor: pointer;
            font-family: monospace;
            transition: all 0.3s;
        }
        
        .btn-leaderboard:hover {
            background: linear-gradient(135deg, #1E88E5, #1565C0) !important;
            box-shadow: 0 0 20px rgba(33, 150, 243, 0.6);
            transform: scale(1.05);
        }
        
        #loadingIndicator {
            display: none;
            margin: 10px 0;
            color: #FFD700;
            font-size: 14px;
        }
        
        /* Canvas */
        #gameCanvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            z-index: 1;
        }
        
        /* Discovery Sidebar - Hidden (using discovery feed instead) */
        #discoveryLog {
            display: none;
        }
        
        #discoveryLog h3 {
            margin: 0 0 20px 0;
            font-size: 20px;
            color: #FFD700;
            
            padding-bottom: 10px;
            border-bottom: 1px solid #444;
        }
        
        .discovery-item {
            margin: 8px 0;
            font-size: 14px;
            padding: 10px;
            background: rgba(255,255,255,0.05);
            border-radius: 5px;
            display: flex;
            align-items: center;
            gap: 10px;
            transition: all 0.3s;
        }
        
        .discovery-item:hover {
            background: rgba(255,255,255,0.1);
            transform: translateX(5px);
        }
        
        .discovery-item .emoji {
            font-size: 24px;
        }
        
        .discovery-item .info {
            flex: 1;
        }
        
        .discovery-item .name {
            font-weight: bold;
            color: white;
        }
        
        .discovery-item .tier {
            font-size: 11px;
            color: #AAA;
        }
        
        .discovery-item.new {
            animation: newItemGlow 2s ease-out;
            background: rgba(255, 215, 0, 0.2);
        }
        
        @keyframes newItemGlow {
            0% {
                background: rgba(255, 215, 0, 0.5);
                transform: translateX(10px);
            }
            100% {
                background: rgba(255, 215, 0, 0.2);
                transform: translateX(0);
            }
        }
        
        /* Main UI overlay */
        #ui {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            pointer-events: none;
            z-index: 10;
            opacity: 0;
            transition: opacity 0.3s ease-in;
        }
        
        #score {
            display: none; /* Hidden - score shown in leaderboard */
        }
        
        #discoveries {
            display: none; /* Hidden - discoveries shown elsewhere */
        }
        
        /* Bottom UI Bar (MMO-style) */
        .bottom-ui {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            pointer-events: auto;
            background: linear-gradient(to bottom, 
                rgba(0, 0, 0, 0) 0%,
                rgba(0, 0, 0, 0.7) 10%,
                rgba(10, 10, 26, 0.95) 30%,
                rgba(10, 10, 26, 0.98) 100%
            );
            padding: 20px 0;
            border-top: 2px solid rgba(138, 43, 226, 0.3);
            box-shadow: 0 -10px 30px rgba(138, 43, 226, 0.2);
            display: flex;
            justify-content: center;
            align-items: center;
        }
        
        /* Element Collection Bar (Skill Bar Style) - SNES Style */
        .element-collection-bar {
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 0;
            margin: 0 auto 20px;
            gap: 4px;
            image-rendering: pixelated;
            flex-wrap: wrap;
            width: fit-content;
        }
        
        /* Two-row layout when 9+ slots */
        .element-collection-bar.two-rows {
            display: grid;
            gap: 4px;
            justify-content: center;
            width: fit-content;
            margin: 0 auto 20px;
        }
        
        /* Specific grid layouts for each slot count */
        .element-collection-bar.two-rows[data-slots="9"] {
            grid-template-columns: repeat(5, 64px);
        }
        
        .element-collection-bar.two-rows[data-slots="10"] {
            grid-template-columns: repeat(5, 64px);
        }
        
        .element-collection-bar.two-rows[data-slots="11"] {
            grid-template-columns: repeat(6, 64px);
        }
        
        .element-collection-bar.two-rows[data-slots="12"] {
            grid-template-columns: repeat(6, 64px);
        }
        
        .element-slot {
            width: 64px;
            height: 64px;
            min-width: 64px;
            min-height: 64px;
            max-width: 64px;
            max-height: 64px;
            background: #1a1a2e;
            border: 3px solid;
            border-color: #4a4a6e #0a0a1e #0a0a1e #4a4a6e;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            position: relative;
            border-radius: 0;
            image-rendering: pixelated;
            padding: 2px;
        }
        
        /* Ensure consistent size in grid layouts */
        .element-collection-bar.two-rows .element-slot {
            width: 64px;
            height: 64px;
        }
        
        .element-slot.empty {
            background: #0f0f1f;
            border-style: solid;
            border-color: #2a2a3a #050510 #050510 #2a2a3a;
            opacity: 0.6;
        }
        
        .element-slot.filled {
            background: #2a2a4e;
            border-color: #5a5a8e #1a1a2e #1a1a2e #5a5a8e;
        }
        
        .element-slot.tail-element {
            border-color: var(--snes-gold) #A88800 #A88800 var(--snes-gold);
            background: #383800;
            animation: pixelPulse 1s steps(2) infinite;
        }
        
        @keyframes pixelPulse {
            0%, 100% { 
                background: #383800;
                box-shadow: inset 0 0 0 2px var(--snes-gold);
            }
            50% { 
                background: #585800;
                box-shadow: inset 0 0 0 4px var(--snes-gold);
            }
        }
        
        /* Combination animation styles */
        @keyframes combinationGlow {
            0% {
                transform: scale(1);
                box-shadow: 0 0 20px rgba(255, 215, 0, 0.5),
                           inset 0 0 10px rgba(255, 215, 0, 0.2);
            }
            25% {
                transform: scale(1.1);
                box-shadow: 0 0 30px rgba(255, 100, 255, 0.8),
                           inset 0 0 20px rgba(255, 100, 255, 0.4);
            }
            50% {
                transform: scale(1.15);
                box-shadow: 0 0 40px rgba(100, 200, 255, 1),
                           inset 0 0 30px rgba(100, 200, 255, 0.6);
            }
            75% {
                transform: scale(1.1);
                box-shadow: 0 0 30px rgba(255, 100, 255, 0.8),
                           inset 0 0 20px rgba(255, 100, 255, 0.4);
            }
            100% {
                transform: scale(1);
                box-shadow: 0 0 20px rgba(255, 215, 0, 0.5),
                           inset 0 0 10px rgba(255, 215, 0, 0.2);
            }
        }
        
        .element-slot.combining {
            animation: combinationGlow 0.6s ease-in-out;
            border-color: #FFD700;
            background: linear-gradient(135deg, 
                rgba(255, 100, 255, 0.3) 0%,
                rgba(100, 200, 255, 0.2) 100%
            );
        }
        
        @keyframes elementMerge {
            0% {
                opacity: 1;
                transform: scale(1) translateX(0);
            }
            50% {
                opacity: 0.8;
                transform: scale(0.8) translateX(-10px);
            }
            100% {
                opacity: 0;
                transform: scale(0.5) translateX(-20px);
            }
        }
        
        .element-slot.merging {
            animation: elementMerge 0.5s ease-out forwards;
        }
        
        @keyframes newElementAppear {
            0% {
                opacity: 0;
                transform: scale(0) rotate(0deg);
            }
            50% {
                opacity: 0.8;
                transform: scale(1.2) rotate(180deg);
            }
            100% {
                opacity: 1;
                transform: scale(1) rotate(360deg);
            }
        }
        
        .element-slot.new-element {
            animation: newElementAppear 0.6s ease-out;
        }
        
        /* Particle effect container */
        .combination-particles {
            position: absolute;
            top: 50%;
            left: 50%;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 10;
        }
        
        /* Screen flash effect for combinations */
        @keyframes combinationFlash {
            0% {
                opacity: 0;
            }
            20% {
                opacity: 0.3;
            }
            100% {
                opacity: 0;
            }
        }
        
        .combination-flash {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at center, rgba(255, 215, 0, 0.2), rgba(100, 200, 255, 0.1));
            pointer-events: none;
            z-index: 9999;
            opacity: 0;
            animation: combinationFlash 0.5s ease-out;
        }
        
        @keyframes particleFly {
            0% {
                opacity: 1;
                transform: translate(-50%, -50%) scale(0);
            }
            50% {
                opacity: 1;
                transform: translate(calc(-50% + var(--tx)), calc(-50% + var(--ty))) scale(1);
            }
            100% {
                opacity: 0;
                transform: translate(calc(-50% + var(--tx) * 2), calc(-50% + var(--ty) * 2)) scale(0.5);
            }
        }
        
        .combination-particle {
            position: absolute;
            width: 4px;
            height: 4px;
            background: radial-gradient(circle, rgba(255, 215, 0, 1) 0%, rgba(255, 100, 255, 0) 70%);
            border-radius: 50%;
            animation: particleFly 0.6s ease-out forwards;
        }
        
        .element-slot.highlighted-element {
            border-color: #FFD700;
            background: linear-gradient(135deg, 
                rgba(255, 215, 0, 0.2) 0%,
                rgba(255, 215, 0, 0.1) 100%
            );
            box-shadow: 0 0 20px rgba(255, 215, 0, 0.5),
                       inset 0 0 10px rgba(255, 215, 0, 0.2);
            animation: tailPulse 2s ease-in-out infinite;
        }
        
        .element-slot:hover:not(.empty) {
            transform: translate(1px, 1px);
            box-shadow: 2px 2px 0 rgba(0,0,0,0.5);
        }
        
        /* New glow and wobble animations for element combinations */
        @keyframes elementGlow {
            0%, 100% { 
                box-shadow: 0 0 10px rgba(255, 215, 0, 0.6),
                           0 0 20px rgba(255, 100, 255, 0.4),
                           inset 0 0 10px rgba(255, 215, 0, 0.3);
            }
            50% { 
                box-shadow: 0 0 20px rgba(255, 215, 0, 1),
                           0 0 40px rgba(255, 100, 255, 0.8),
                           inset 0 0 20px rgba(255, 215, 0, 0.5);
            }
        }
        
        @keyframes elementWobble {
            0%, 100% { transform: rotate(0deg) scale(1); }
            25% { transform: rotate(-3deg) scale(1.05); }
            75% { transform: rotate(3deg) scale(1.05); }
        }
        
        @keyframes deathFlash {
            0% { opacity: 0.8; }
            100% { opacity: 0; }
        }
        
        .element-slot.glow-wobble {
            animation: elementGlow 1s ease-in-out infinite,
                      elementWobble 0.8s ease-in-out infinite;
            border-color: #FFD700;
            background: linear-gradient(135deg, 
                rgba(255, 215, 0, 0.3) 0%,
                rgba(255, 100, 255, 0.2) 100%
            );
        }
        
        /* Enhanced combining animation */
        .element-slot.combining-enhanced {
            animation: elementGlow 0.6s ease-in-out,
                      elementWobble 0.4s ease-in-out;
            border-color: #FFD700;
            background: linear-gradient(135deg, 
                rgba(255, 100, 255, 0.4) 0%,
                rgba(100, 200, 255, 0.3) 100%
            );
        }
        
        .element-slot .emoji {
            font-size: 32px;
            filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.8));
            margin-bottom: 2px;
        }
        
        .element-slot .element-name {
            font-size: 7px;
            color: var(--snes-white);
            
            font-family: 'Press Start 2P';
            line-height: 1.1;
            text-shadow: 1px 1px 0 rgba(0,0,0,0.8);
            letter-spacing: -0.5px;
            word-wrap: break-word;
            width: 100%;
            padding: 0 2px;
            margin-top: 2px;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.8);
            text-align: center;
        }
        
        /* Boost Bar (Mana Bar Style) */
        .boost-bar-container {
            width: auto;
            max-width: 404px; /* 6 slots * 64px + 5 gaps * 4px */
            margin: 0 auto 15px;
            padding: 0;
            display: none; /* Hidden on desktop - now in player stats */
        }
        
        .boost-bar-frame {
            height: 24px;
            background: #1a1a1a;
            border: 2px solid #333;
            position: relative;
            overflow: hidden;
        }
        
        .boost-bar-fill {
            height: 100%;
            background: #00a8ff;
            position: relative;
        }
        
        @keyframes boostShimmer {
            0% { background-position: 200% 0; }
            100% { background-position: -200% 0; }
        }
        
        .boost-bar-fill.low {
            background: #ff4444;
        }
        
        .boost-bar-fill.boosting {
            background: #44ff44;
        }
        
        .boost-bar-text {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 12px;
            font-weight: bold;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.8);
            color: white;
        }
        
        #elementQueue {
            display: none; /* Hidden - replaced by bottom element bar */
        }
        
        .element-square {
            width: 50px;
            height: 50px;
            background: rgba(255,255,255,0.05);
            border: 1px solid rgba(255,255,255,0.15);
            border-radius: 5px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            position: relative;
            padding: 2px;
        }
        
        .element-square .element-name {
            font-size: 7px;
            color: #AAA;
            
            margin-top: 2px;
            line-height: 1;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
            max-width: 46px;
        }
        
        .element-square.empty {
            background: rgba(255,255,255,0.05);
            border: 1px dashed rgba(255,255,255,0.1);
        }
        
        .element-square.filled {
            background: rgba(255,255,255,0.08);
            border: 1px solid rgba(255,255,255,0.2);
        }
        
        .element-square.tail-element {
            border: 2px solid #FFD700;
            background: rgba(255,215,0,0.1);
            box-shadow: 0 0 10px rgba(255,215,0,0.5);
            animation: tailGlow 2s ease-in-out infinite;
        }
        
        @keyframes tailGlow {
            0%, 100% {
                box-shadow: 0 0 10px rgba(255,215,0,0.5);
            }
            50% {
                box-shadow: 0 0 20px rgba(255,215,0,0.8);
            }
        }
        
        .element-square:hover {
            transform: scale(1.1);
            transition: transform 0.2s;
        }
        
        /* Lore Unlock Display - Positioned same as killstreak */
        #loreUnlockDisplay {
            position: absolute;
            bottom: 305px; /* Same height as killstreak - moved up 25px */
            left: 50%;
            transform: translateX(-50%);
            background: transparent;
            z-index: 104;
            opacity: 0;
            transition: opacity 0.3s;
            pointer-events: none;
            text-align: center;
        }
        
        #loreUnlockDisplay.show {
            opacity: 1;
            background: linear-gradient(135deg, 
                rgba(248, 216, 0, 0.95) 0%, 
                rgba(248, 168, 0, 0.95) 50%, 
                rgba(248, 216, 0, 0.95) 100%);
            color: #000000;
            padding: 16px 32px;
            border: 4px solid #F8D800;
            border-color: #F8D800 #C8A800 #C8A800 #F8D800;
            outline: 2px solid #F8D800;
            outline-offset: -6px;
            box-shadow: 0 0 30px rgba(248, 216, 0, 0.8),
                        inset 0 0 20px rgba(248, 216, 0, 0.3),
                        0 8px 0 rgba(0,0,0,0.8);
            
            animation: loreUnlockPulse 0.5s steps(8);
            font-size: 14px;
            font-weight: bold;
            text-transform: uppercase;
            letter-spacing: 2px;
        }
        
        @keyframes loreUnlockPulse {
            0%, 100% { transform: translateX(-50%) scale(1); }
            25% { transform: translateX(-50%) scale(1.05); }
            50% { transform: translateX(-50%) scale(1.1); }
            75% { transform: translateX(-50%) scale(1.05); }
        }
        
        /* Killstreak Display - Positioned above regular messages */
        #killstreakDisplay {
            position: absolute;
            bottom: 305px; /* Moved up 25px to maintain spacing with discovery messages */
            left: 50%;
            transform: translateX(-50%);
            background: transparent;
            z-index: 104;
            opacity: 0;
            transition: opacity 0.3s;
            pointer-events: none;
            text-align: center;
        }
        
        #killstreakDisplay.show {
            opacity: 1;
            background: linear-gradient(135deg, 
                rgba(60, 0, 80, 0.95) 0%, 
                rgba(120, 0, 60, 0.95) 50%, 
                rgba(80, 0, 120, 0.95) 100%);
            color: #ff00ff;
            padding: 16px 32px;
            border: 4px solid #ff00ff;
            border-color: #ff00ff #cc00cc #cc00cc #ff00ff;
            outline: 2px solid #ff00ff;
            outline-offset: -6px;
            box-shadow: 0 0 30px rgba(255, 0, 255, 0.8),
                        inset 0 0 20px rgba(255, 0, 255, 0.3),
                        0 8px 0 rgba(0,0,0,0.8);
            
            animation: killstreakPulse 0.5s steps(8);
        }
        
        /* Message Popups (Over Element Bar) - SNES Style */
        #recentDiscovery {
            position: absolute;
            bottom: 225px; /* Moved up 25px to avoid overlap with hints */
            left: 50%;
            transform: translateX(-50%);
            background: rgba(20, 20, 40, 0.95); /* Dark purple background for discoveries */
            color: var(--snes-cosmic-teal);
            font-size: 12px;
            font-weight: normal;
            text-shadow: none;
            padding: 16px 32px;
            text-align: center;
            border-radius: 0;
            border: 4px solid var(--snes-cosmic-teal);
            border-color: var(--snes-cosmic-teal) #0090A0 #0090A0 var(--snes-cosmic-teal);
            
            pointer-events: none;
            box-shadow: 6px 6px 0 rgba(0,0,0,0.8);
            opacity: 0;
            transition: none;
            animation: none;
            z-index: 25;
            font-family: 'Press Start 2P';
            text-transform: uppercase;
            outline: 2px solid var(--snes-white);
            outline-offset: -6px;
        }
        
        #recentDiscovery.show {
            animation: popupBounce 0.3s steps(4);
        }
        
        /* Mobile popup adjustments */
        body.mobile #killstreakDisplay,
        body.mobile #loreUnlockDisplay {
            bottom: 165px; /* Moved up 25px to maintain spacing above recentDiscovery on mobile */
        }
        
        body.mobile #recentDiscovery {
            bottom: 125px !important; /* Moved up 25px to avoid overlap with hints */
            font-size: 10px;
            padding: 12px 20px;
            max-width: 80%;
        }
        
        /* Hide desktop score on mobile */
        body.mobile #desktopScore {
            display: none !important;
        }
        
        @keyframes popupBounce {
            0% {
                transform: translateX(-50%) translateY(20px);
                opacity: 0;
            }
            25% {
                transform: translateX(-50%) translateY(15px);
                opacity: 0.5;
            }
            50% {
                transform: translateX(-50%) translateY(10px);
                opacity: 0.75;
            }
            75% {
                transform: translateX(-50%) translateY(5px);
                opacity: 0.9;
            }
            100% {
                transform: translateX(-50%) translateY(0);
                opacity: 1;
            }
        }
        
        #recentDiscovery.combo {
            background: rgba(0, 0, 0, 0.95);
            color: var(--snes-gold);
            border-color: var(--snes-gold) #A88800 #A88800 var(--snes-gold);
            animation: comboFlash 0.2s steps(2) 3;
            outline-color: var(--snes-gold);
        }
        
        @keyframes comboFlash {
            0%, 100% { 
                border-color: var(--snes-gold) #A88800 #A88800 var(--snes-gold);
                color: var(--snes-gold);
            }
            50% { 
                border-color: var(--snes-white) var(--snes-gray) var(--snes-gray) var(--snes-white);
                color: var(--snes-white);
            }
        }
        
        @keyframes shake {
            0% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            50% { transform: translateX(5px); }
            75% { transform: translateX(-5px); }
            100% { transform: translateX(0); }
        }
        
        #recentDiscovery small {
            display: block;
            margin-top: 8px;
            font-size: 16px;
            font-weight: normal;
            font-style: normal;
            opacity: 1;
            letter-spacing: 0;
            filter: drop-shadow(2px 2px 0 rgba(0,0,0,0.8));
        }
        
        /* Additional message styles */
        #recentDiscovery.gold {
            background: rgba(40, 40, 0, 0.95);
            color: var(--snes-gold);
            border-color: var(--snes-gold) #A88800 #A88800 var(--snes-gold);
            outline-color: var(--snes-gold);
        }
        
        #recentDiscovery.red {
            background: rgba(40, 0, 0, 0.95);
            color: var(--snes-red);
            border-color: var(--snes-red) #A80000 #A80000 var(--snes-red);
            outline-color: var(--snes-red);
        }
        
        #recentDiscovery.cyan {
            background: rgba(0, 40, 40, 0.95);
            color: var(--snes-cosmic-teal);
            border-color: var(--snes-cosmic-teal) #008888 #008888 var(--snes-cosmic-teal);
            outline-color: var(--snes-cosmic-teal);
        }
        
        #recentDiscovery.purple {
            background: rgba(40, 0, 40, 0.95);
            color: var(--snes-cosmic-purple);
            border-color: var(--snes-cosmic-purple) var(--snes-dark-purple) var(--snes-dark-purple) var(--snes-cosmic-purple);
            outline-color: var(--snes-cosmic-purple);
        }
        
        #recentDiscovery.orange {
            background: rgba(40, 20, 0, 0.95);
            color: #ff8c00;
            border-color: #ff8c00 #cc6600 #cc6600 #ff8c00;
            outline-color: #ff8c00;
        }
        
        /* Killstreak Message Style */
        #recentDiscovery.killstreak {
            background: linear-gradient(135deg, 
                rgba(60, 0, 80, 0.95) 0%, 
                rgba(120, 0, 60, 0.95) 50%, 
                rgba(80, 0, 120, 0.95) 100%);
            color: #ff00ff;
            border-color: #ff00ff #cc00cc #cc00cc #ff00ff;
            outline-color: #ff00ff;
            box-shadow: 0 0 30px rgba(255, 0, 255, 0.8),
                        inset 0 0 20px rgba(255, 0, 255, 0.3),
                        0 8px 0 rgba(0,0,0,0.8);
            
            animation: killstreakPulse 0.5s steps(8);
        }
        
        @keyframes killstreakPulse {
            0%, 100% {
                transform: translateX(-50%) scale(1);
                filter: brightness(1);
            }
            25% {
                transform: translateX(-50%) scale(1.1);
                filter: brightness(1.3);
            }
            50% {
                transform: translateX(-50%) scale(1.05);
                filter: brightness(1.2);
            }
            75% {
                transform: translateX(-50%) scale(1.08);
                filter: brightness(1.4);
            }
        }
        
        .killstreak-medal {
            display: block;
            width: 64px;
            height: 64px;
            margin: 0 auto 8px;
            image-rendering: pixelated;
            filter: drop-shadow(0 0 10px rgba(255, 0, 255, 0.8));
            animation: medalBounce 0.5s ease-out;
        }
        
        @keyframes medalBounce {
            0% {
                transform: scale(0) rotate(0deg);
            }
            50% {
                transform: scale(1.2) rotate(180deg);
            }
            100% {
                transform: scale(1) rotate(360deg);
            }
        }
        
        .killstreak-text {
            font-size: 18px;
            text-transform: uppercase;
            letter-spacing: 2px;
            font-weight: bold;
            text-shadow: 3px 3px 0 rgba(0,0,0,0.8),
                        0 0 20px rgba(255, 0, 255, 0.5);
        }
        
        body.mobile .killstreak-medal {
            width: 48px;
            height: 48px;
        }
        
        body.mobile .killstreak-text {
            font-size: 14px;
        }
        
        /* Boss Victory Message - Epic announcement */
        #bossVictoryMessage {
            position: absolute;
            top: 120px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(10, 0, 30, 0.85);
            backdrop-filter: blur(8px);
            -webkit-backdrop-filter: blur(8px);
            color: var(--snes-gold);
            font-size: 14px;
            font-weight: bold;
            text-shadow: 2px 2px 0 rgba(0,0,0,0.8);
            padding: 24px 48px;
            border-radius: 0;
            border: 6px solid var(--snes-gold);
            border-color: var(--snes-gold) #A88800 #A88800 var(--snes-gold);
            
            pointer-events: none;
            box-shadow: 8px 8px 0 rgba(0,0,0,0.9), 
                        0 0 30px rgba(255, 215, 0, 0.3),
                        inset 0 0 20px rgba(255, 215, 0, 0.1);
            opacity: 0;
            transition: none;
            animation: none;
            z-index: 30;
            min-width: 400px;
            display: none;
        }
        
        #bossVictoryMessage.show {
            display: block;
            opacity: 1;
            animation: epicBossVictory 0.8s steps(12);
        }
        
        #bossVictoryMessage h2 {
            margin: 0 0 16px 0;
            font-size: 24px;
            color: var(--snes-gold);
            text-transform: uppercase;
            letter-spacing: 2px;
            animation: victoryPulse 1s steps(2) infinite;
        }
        
        #bossVictoryMessage .boss-name {
            font-size: 18px;
            color: var(--snes-white);
            margin-bottom: 12px;
        }
        
        #bossVictoryMessage .defeat-text {
            font-size: 14px;
            color: var(--snes-cosmic-teal);
            margin-bottom: 20px;
            font-style: italic;
        }
        
        #bossVictoryMessage .rewards {
            border-top: 2px solid var(--snes-gold);
            padding-top: 16px;
            margin-top: 16px;
        }
        
        #bossVictoryMessage .reward-item {
            font-size: 13px;
            color: var(--snes-white);
            margin: 8px 0;
            text-align: left;
            padding-left: 20px;
        }
        
        #bossVictoryMessage .reward-item.highlight {
            color: var(--snes-gold);
            font-size: 14px;
        }
        
        @keyframes epicBossVictory {
            0% {
                transform: translateX(-50%) scale(0.1);
                opacity: 0;
            }
            50% {
                transform: translateX(-50%) scale(1.1);
                opacity: 1;
            }
            100% {
                transform: translateX(-50%) scale(1);
                opacity: 1;
            }
        }
        
        @keyframes victoryPulse {
            0%, 50% {
                transform: scale(1);
            }
            51%, 100% {
                transform: scale(1.05);
            }
        }
        
        /* Mobile responsive for boss victory */
        @media screen and (max-width: 600px) {
            #bossVictoryMessage {
                min-width: 300px;
                padding: 16px 24px;
                font-size: 12px;
            }
            
            #bossVictoryMessage h2 {
                font-size: 18px;
            }
            
            #bossVictoryMessage .boss-name {
                font-size: 14px;
            }
            
            #bossVictoryMessage .reward-item {
                font-size: 11px;
            }
        }
        
        /* Player Info Box (Bottom Left for Desktop, Top for Mobile) - SNES Style */
        .player-info-box {
            position: absolute;
            bottom: 20px;
            left: 20px;
            width: 240px;
            background: var(--snes-dark-blue);
            border: 4px solid;
            border-color: var(--snes-light-blue) var(--snes-black) var(--snes-black) var(--snes-light-blue);
            border-radius: 0;
            padding: 8px;
            pointer-events: auto;
            box-shadow: 4px 4px 0 rgba(0,0,0,0.8);
            font-family: 'Press Start 2P';
            font-size: 7px;
        }
        
        .player-info-header {
            display: flex;
            gap: 12px;
            margin-bottom: 10px;
        }
        
        /* Mobile-specific player info header adjustments */
        body.mobile .player-info-header {
            gap: 8px !important;
            margin-bottom: 6px !important;
        }
        
        .player-portrait {
            position: relative;
            width: 48px;
            height: 48px;
            background: var(--snes-black) url('assets/space-background-profile.png') center/cover;
            border: 2px solid var(--snes-gold);
            border-radius: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: visible;
            box-shadow: inset 2px 2px 0 #585800;
        }
        
        .player-portrait img {
            width: 44px;
            height: 44px;
            object-fit: contain;
            image-rendering: pixelated;
        }
        
        .player-stats {
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
            gap: 2px;
            margin-left: 8px;
            overflow: hidden;
            padding-right: 5px; /* Add padding to prevent content cutoff */
            font-family: 'Press Start 2P', monospace;
        }
        
        /* Player Stats Boost Bar */
        .player-boost-bar-container {
            width: 100%;
            margin-top: 8px;
            padding: 0;
        }
        
        .player-boost-bar-frame {
            height: 20px;
            background: #1a1a1a;
            border: 2px solid #333;
            position: relative;
            overflow: hidden;
        }
        
        .player-boost-bar-fill {
            height: 100%;
            background: #00a8ff;
            transition: width 0.3s ease, background-color 0.2s ease;
            border-right: 2px solid rgba(255, 255, 255, 0.3);
        }
        
        .player-boost-bar-fill.low {
            background: #ff4444;
        }
        
        .player-boost-bar-fill.boosting {
            background: #44ff44;
        }
        
        .player-boost-bar-text {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: #fff;
            font-size: 8px;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.8);
            pointer-events: none;
        }
        
        /* Show player boost bar on mobile (iPad) */
        body.mobile .player-boost-bar-container {
            display: block !important;
            margin-top: 6px !important;
        }
        
        body.mobile .player-boost-bar-frame {
            height: 16px !important;
        }
        
        body.mobile .player-boost-bar-text {
            font-size: 6px !important;
        }
        
        .stat-line {
            display: flex;
            justify-content: space-between;
            font-size: 7px;
            margin: 2px 0;
            padding: 0 4px; /* Increased horizontal padding to prevent edge cutoff */
            gap: 8px; /* Add gap between label and value */
            font-family: 'Press Start 2P', monospace;
        }
        
        .stat-label {
            color: var(--snes-gray);
            text-transform: uppercase;
            letter-spacing: 0;
            font-size: 7px;
            font-family: 'Press Start 2P', monospace;
        }
        
        .stat-value {
            color: var(--snes-gold);
            font-weight: normal;
            text-shadow: 1px 1px 0 var(--snes-black);
            font-size: 7px;
            font-family: 'Press Start 2P', monospace;
        }
        
        /* Scoreboard (Bottom Right for Desktop, Top for Mobile) - SNES Style */
        .leaderboard-box {
            position: absolute;
            bottom: 20px;
            right: 20px;
            width: 240px;
            background: var(--snes-black);
            border: 4px solid;
            border-color: var(--snes-white) #505050 #505050 var(--snes-white);
            border-radius: 0;
            padding: 0;
            pointer-events: auto;
            box-shadow: 4px 4px 0 rgba(0,0,0,0.8);
        }
        
        .leaderboard-header {
            background: var(--snes-cosmic-purple);
            color: var(--snes-white);
            text-transform: uppercase;
            font-size: 12px;
            padding: 8px 12px;
            
            border-bottom: 2px solid var(--snes-black);
            font-family: 'Press Start 2P';
            letter-spacing: 0;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            user-select: none;
            position: relative;
        }
        
        .leaderboard-header:hover {
            background: #8838F8;
        }
        
        .collapse-icon {
            font-size: 12px;
            transition: transform 0.3s ease;
            font-family: 'Press Start 2P', monospace;
            margin-left: 15px;
            display: inline-block;
            line-height: 1;
        }
        
        .leaderboard-box.collapsed {
            max-height: 40px;
            overflow: hidden;
        }
        
        .leaderboard-box.collapsed .scrollable-content,
        .leaderboard-box.collapsed .leaderboard-entry,
        .leaderboard-box.collapsed .leaderboard-divider {
            display: none;
        }
        
        .leaderboard-entry {
            display: flex;
            justify-content: space-between;
            padding: 4px 8px;
            margin: 0;
            background: #181850;
            border-bottom: 1px solid var(--snes-black);
            font-size: 7px;
            transition: none;
            font-family: 'Press Start 2P', monospace !important;
            line-height: 1.2;
        }
        
        .leaderboard-entry:hover {
            background: #282890;
            transform: none;
        }
        
        .leaderboard-entry.leader {
            background: #383800;
            border-left: 4px solid var(--snes-gold);
            color: var(--snes-gold);
        }
        
        .leaderboard-entry.player {
            background: #003838;
            border-left: 4px solid var(--snes-cosmic-teal);
            color: var(--snes-cosmic-teal);
        }
        
        .leaderboard-name {
            flex: 1;
            font-weight: normal;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
            padding-right: 8px;
            font-size: 7px;
            font-family: 'Press Start 2P', monospace;
            text-transform: uppercase;
        }
        
        .leaderboard-stats {
            text-align: right;
            font-size: 7px;
            color: var(--snes-gray);
            line-height: 1.2;
            font-family: 'Press Start 2P', monospace !important;
        }
        
        /* Discovery Feed (Left Side Chat-style) - SNES Style */
        .discovery-feed {
            position: fixed;
            top: 50%;
            left: 20px;
            transform: translateY(-50%);
            width: 300px;
            max-height: 30vh;
            pointer-events: none;
            display: flex !important;
            flex-direction: column;
            justify-content: flex-end;
            overflow: hidden;
            z-index: 50;
            opacity: 1 !important;
            visibility: visible !important;
            font-family: 'Press Start 2P';
        }
        
        /* Force discovery feed to be visible */
        #gameContainer .discovery-feed {
            display: flex !important;
            opacity: 1 !important;
            visibility: visible !important;
        }
        
        .discovery-feed-inner {
            overflow-y: auto;
            overflow-x: hidden;
            scrollbar-width: none; /* Hide scrollbar for Firefox */
            -ms-overflow-style: none; /* Hide scrollbar for IE and Edge */
        }
        
        .discovery-feed-inner::-webkit-scrollbar {
            display: none; /* Hide scrollbar for Chrome, Safari and Opera */
        }
        
        .discovery-message {
            background: var(--snes-dark-blue);
            border: 4px solid;
            border-color: var(--snes-gold) var(--snes-black) var(--snes-black) var(--snes-gold);
            padding: 8px 12px;
            margin: 4px 0;
            border-radius: 0;
            box-shadow: 4px 4px 0 rgba(0,0,0,0.5);
            font-size: 14px;
            animation: slideInLeft 0.3s ease-out;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        @keyframes slideInLeft {
            from {
                opacity: 0;
                transform: translateX(-20px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }
        
        .discovery-message .emoji {
            font-size: 20px;
        }
        
        .discovery-message .discovery-text {
            flex: 1;
        }
        
        .discovery-message .discovery-name {
            color: var(--snes-gold);
            font-weight: normal;
            font-size: 10px;
            font-family: 'Press Start 2P';
            text-shadow: 1px 1px 0 rgba(0,0,0,0.8);
        }
        
        .discovery-message .discovery-combo {
            font-size: 8px;
            color: var(--snes-white);
            margin-top: 4px;
            font-family: 'Press Start 2P';
            line-height: 1.4;
            text-shadow: 1px 1px 0 rgba(0,0,0,0.8);
        }
        
        /* Mobile Controls */
        .mobile-controls {
            display: none;
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            height: 200px;
            pointer-events: none;
            z-index: 50;
        }
        
        body.mobile .mobile-controls {
            display: none; /* Hidden by default, shown only during gameplay */
        }
        
        body.mobile.game-active .mobile-controls {
            display: block;
        }
        
        .virtual-joystick {
            position: absolute;
            bottom: 120px;
            left: 80px;
            width: 105px;
            height: 105px;
            pointer-events: auto;
            touch-action: none;
            z-index: 1005;
        }
        
        .joystick-base {
            position: absolute;
            width: 100%;
            height: 100%;
            background: rgba(255, 255, 255, 0.05);
            border: 3px solid rgba(255, 255, 255, 0.15);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .joystick-knob {
            position: absolute;
            width: 38px;
            height: 38px;
            background: rgba(255, 255, 255, 0.3);
            border: 2px solid rgba(255, 255, 255, 0.5);
            border-radius: 50%;
            transition: none;
            transform: translate(-50%, -50%);
            left: 50%;
            top: 50%;
        }
        
        
        .pause-button-mobile {
            position: absolute;
            top: 20px; /* Moved to top of screen */
            right: 20px;
            width: 50px;
            height: 50px;
            background: rgba(0, 0, 0, 0.4); /* Reduced opacity from 0.7 */
            border: 2px solid rgba(255, 255, 255, 0.2); /* Reduced opacity from 0.4 */
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            color: rgba(255, 255, 255, 0.6); /* Reduced opacity */
            pointer-events: auto;
            user-select: none;
            -webkit-user-select: none;
        }
        
        .mute-button-mobile {
            position: absolute;
            top: 20px; /* Moved to top of screen */
            right: 80px;
            width: 50px;
            height: 50px;
            background: rgba(0, 0, 0, 0.4); /* Reduced opacity from 0.7 */
            border: 2px solid rgba(255, 255, 255, 0.2); /* Reduced opacity from 0.4 */
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            color: rgba(255, 255, 255, 0.6); /* Reduced opacity */
            pointer-events: auto;
            user-select: none;
            -webkit-user-select: none;
        }
        
        /* Hide pause and mute buttons by default */
        .pause-button-mobile,
        .mute-button-mobile {
            display: none !important;
        }
        
        /* Only show buttons during active gameplay (not paused, game started) */
        body.game-active .pause-button-mobile,
        body.game-active .mute-button-mobile {
            display: flex !important;
        }
        
        /* Fix pause/mute button positions in landscape - move to bottom center */
        @media (orientation: landscape) {
            .pause-button-mobile {
                top: auto !important;
                bottom: 20px !important;
                right: auto !important;
                left: 50% !important;
                transform: translateX(-50%) translateX(30px) !important;
            }
            
            .mute-button-mobile {
                top: auto !important;
                bottom: 20px !important;
                right: auto !important;
                left: 50% !important;
                transform: translateX(-50%) translateX(-30px) !important;
            }
        }
        
        /* Alchemy Vision Timer */
        .alchemy-vision-timer {
            position: absolute;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            width: 280px;
            background: linear-gradient(135deg, rgba(255, 215, 0, 0.2) 0%, rgba(255, 140, 0, 0.2) 100%);
            border: 2px solid #FFD700;
            border-radius: 8px;
            padding: 10px;
            
            color: #FFD700;
            font-size: 18px;
            font-weight: bold;
            text-shadow: 0 0 10px rgba(255, 215, 0, 0.5);
            box-shadow: 0 0 20px rgba(255, 215, 0, 0.3);
            z-index: 100;
        }
        
        /* Mobile UI Inversions */
        body.mobile .bottom-ui {
            top: 0;
            bottom: auto;
            padding-bottom: 20px;
            padding-top: 20px;
            border-top: none;
            border-bottom: none;
            box-shadow: 0 10px 30px rgba(138, 43, 226, 0.2);
            background: linear-gradient(to top, 
                rgba(0, 0, 0, 0) 0%,
                rgba(0, 0, 0, 0.4) 10%, /* Reduced from 0.7 */
                rgba(10, 10, 26, 0.6) 30%, /* Reduced from 0.95 */
                rgba(10, 10, 26, 0.7) 100% /* Reduced from 0.98 */
            );
        }
        
        /* Professional mobile UI with orientation-aware positioning */
        
        /* Portrait mode mobile */
        @media (max-width: 800px) and (orientation: portrait) {
            body.mobile .player-info-box {
                position: fixed !important;
                top: 20px !important;
                bottom: unset !important;
                left: 10px !important;
                width: 45%;
                font-size: 7px !important;
                padding: 8px !important; /* Increased padding */
                overflow: visible !important; /* Ensure content isn't clipped */
            }
            
            body.mobile .leaderboard-box {
                position: fixed !important;
                top: 20px !important;
                bottom: unset !important;
                right: 10px !important;
                left: auto !important;
                width: 45%;
                font-size: 9px !important;
            }
            
            body.mobile .boost-bar-container {
                bottom: 160px;
                width: 70%;
            }
        }
        
        /* Landscape mode mobile */
        @media (max-width: 800px) and (orientation: landscape) {
            body.mobile .player-info-box {
                position: fixed !important;
                top: 60px !important;
                bottom: unset !important;
                left: 10px !important;
                right: auto !important;
                width: 200px !important; /* Increased width */
                font-size: 6px !important;
                padding: 6px !important; /* Increased padding */
                z-index: 20 !important;
                overflow: visible !important; /* Ensure content isn't clipped */
            }
            
            body.mobile .leaderboard-box {
                position: fixed !important;
                top: 60px !important;
                bottom: unset !important;
                right: 10px !important;
                left: auto !important;
                width: 200px !important;
                font-size: 8px !important;
                z-index: 20 !important;
            }
            
            body.mobile .boost-bar-container {
                bottom: 110px !important;
                width: 50% !important;
                max-width: 300px !important;
            }
            
            body.mobile .boost-bar-frame {
                height: 14px !important;
                border: 2px solid #333;
                border-bottom: none;
            }
            
            body.mobile .element-collection-bar {
                padding: 0;
                margin-bottom: 5px;
            }
            
            /* Mobile specific grid layouts */
            body.mobile .element-collection-bar.two-rows[data-slots="9"] {
                grid-template-columns: repeat(5, 48px);
            }
            
            body.mobile .element-collection-bar.two-rows[data-slots="10"] {
                grid-template-columns: repeat(5, 48px);
            }
            
            body.mobile .element-collection-bar.two-rows[data-slots="11"] {
                grid-template-columns: repeat(6, 48px);
            }
            
            body.mobile .element-collection-bar.two-rows[data-slots="12"] {
                grid-template-columns: repeat(6, 48px);
            }
            
            body.mobile .element-slot {
                width: 48px;
                height: 48px;
            }
            
            body.mobile .bottom-ui {
                padding-top: 10px;
                padding-bottom: 10px;
            }
            
            /* Adjust element sizes for landscape */
            body.mobile .player-portrait {
                width: 40px !important;
                height: 40px !important;
                background: var(--snes-black) url('assets/space-background-profile.png') center/cover;
            }
            
            body.mobile .player-portrait img {
                width: 36px !important;
                height: 36px !important;
                object-fit: contain !important;
            }
            
            body.mobile .stat-line {
                font-size: 6px !important;
                margin: 2px 0 !important; /* Increased spacing */
                padding: 0 2px !important; /* Add horizontal padding */
            }
            
            body.mobile .leaderboard-header {
                font-size: 10px !important;
                padding: 6px 10px !important;
            }
            
            body.mobile .collapse-icon {
                font-size: 10px !important;
                margin-left: 10px !important;
            }
            
            body.mobile .leaderboard-entry {
                padding: 2px 4px !important;
                font-size: 8px !important;
                min-height: 20px !important;
                font-family: 'Press Start 2P', monospace !important;
            }
        }
        
        /* Alchemy Vision Timer on Mobile - Bottom Center */
        body.mobile .alchemy-vision-timer {
            top: auto;
            bottom: 80px; /* Above boost bar */
            left: 50%;
            transform: translateX(-50%);
            width: 240px;
            font-size: 16px;
            padding: 8px;
        }
        
        /* Commented out - replaced by professional mobile UI with orientation-aware positioning
        body.mobile .leaderboard-box {
            top: 150px; /* Moved down more to avoid top bar overlap */
            bottom: auto;
            right: 10px;
            width: 180px;
            background: rgba(20, 20, 40, 0.6);
            padding: 8px;
            font-size: 10px;
            cursor: pointer; /* Make it clickable */
            transition: all 0.3s ease;
        } */
        
        /* Add visual feedback for mobile panels */
        body.mobile .leaderboard-box {
            transition: all 0.3s ease;
        }
        
        body.mobile .leaderboard-box:active {
            transform: scale(0.98);
            opacity: 0.9;
        }
        
        body.mobile .leaderboard-box.collapsed {
            width: auto;
            min-width: 80px; /* Increased for better tap target */
            height: 40px;
            overflow: hidden;
            cursor: pointer;
        }
        
        body.mobile .leaderboard-box.collapsed .leaderboard-entry,
        body.mobile .leaderboard-box.collapsed .leaderboard-divider {
            display: none;
        }
        
        body.mobile .leaderboard-box.collapsed .leaderboard-header {
            margin: 0;
            font-size: 12px;
        }
        
        body.mobile .leaderboard-header {
            font-size: 12px;
            margin-bottom: 5px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px; /* Add padding for better tap target */
            cursor: pointer;
        }
        
        
        body.mobile .leaderboard-entry {
            padding: 3px 5px;
            margin: 1px 0;
            font-size: 9px;
            font-family: 'Press Start 2P', monospace !important;
        }
        
        body.mobile .leaderboard-stats {
            font-size: 8px;
            font-family: 'Press Start 2P', monospace !important;
        }
        
        /* Commented out - replaced by professional mobile UI with orientation-aware positioning
        body.mobile .discovery-feed {
            top: 50%;
            transform: translateY(-50%);
        } */
        
        body.mobile .message-popup {
            top: auto;
            bottom: 50px; /* Positioned just above pause/mute buttons */
            font-size: 14px;
            padding: 8px 16px;
            border-radius: 6px;
            border-width: 2px;
        }
        
        /* Commented out - replaced by professional mobile UI
        body.mobile #pauseText,
        body.mobile #fpsCounter {
            top: 170px;
        } */
        
        /* Touch-specific optimizations */
        body.mobile {
            touch-action: none;
            -webkit-touch-callout: none;
            -webkit-user-select: none;
            user-select: none;
        }
        
        /* GPU acceleration for mobile UI elements */
        body.mobile .bottom-ui,
        body.mobile .player-info-box,
        body.mobile .leaderboard-box,
        body.mobile .boost-bar-container,
        body.mobile .virtual-joystick {
            will-change: transform;
            transform: translateZ(0);
            -webkit-transform: translateZ(0);
            backface-visibility: hidden;
            -webkit-backface-visibility: hidden;
        }
        
        /* Hide boost bar on mobile - boost is shown in button instead */
        body.mobile .boost-bar-container {
            display: none !important;
        }
        
        body.mobile .desktop-only {
            display: none;
        }
        
        /* Mobile splash screen adjustments */
        @media (max-width: 800px) and (orientation: landscape) {
            #splashScreen {
                display: flex;
                align-items: center;
                justify-content: center;
                overflow-y: auto;
            }
            
            #splashContent {
                padding: 10px 20px;
                max-height: 90vh;
                overflow: visible;
                display: flex;
                flex-direction: column;
                justify-content: center;
                align-items: center;
                width: 100%;
            }
            
            #splashLogo {
                width: 240px !important;
                height: auto !important;
                margin-bottom: 5px !important;
            }
            
            #splashTitle {
                font-size: 16px !important;
                margin-bottom: 5px !important;
                display: none !important; /* Hide title in landscape */
            }
            
            #splashScreen p {
                font-size: 10px !important;
                margin: 2px !important;
                line-height: 1.2 !important;
                max-height: none;
                overflow: visible;
                
                display: none !important; /* Hide text in extreme landscape */
            }
            
            #startButton {
                margin-top: 10px !important;
                margin-bottom: 10px !important;
                padding: 15px 50px !important;
                font-size: 20px !important;
                position: relative !important;
                bottom: unset !important;
                display: block !important;
                visibility: visible !important;
            }
            
            /* Keep controls consistent in landscape */
            .virtual-joystick {
                width: 100px !important;
                height: 100px !important;
                bottom: 120px !important;
                right: 105px !important;
            }
            
        }
        
        /* Portrait mobile adjustments */
        @media (max-width: 600px) and (orientation: portrait) {
            #splashScreen img {
                width: 300px !important;
            }
            
            #splashScreen p {
                font-size: 16px;
            }
        }
        
        /* Hero video responsive styles */
        @media (max-width: 1400px) {
            #splashContent > div:first-child {
                gap: 60px !important;
            }
        }
        
        /* Only apply column layout for small desktop windows, not tablets */
        @media (max-width: 1100px) and (min-width: 769px) and (hover: hover) and (pointer: fine) {
            #splashContent > div:first-child {
                flex-direction: column-reverse !important;
                gap: 40px !important;
                padding: 0 20px !important;
            }
            
            #heroVideoSection {
                width: 100% !important;
                max-width: 700px !important;
                margin: 0 auto;
                order: -1;
            }
            
            #heroVideoSection p {
                font-size: 10px !important;
            }
        }
        
        /* For tablets and touch devices, keep horizontal layout */
        @media (max-width: 1100px) and (min-width: 769px) and ((hover: none) or (pointer: coarse)) {
            #splashContent > div:first-child {
                flex-direction: row !important;
                gap: 60px !important;
                padding: 0 40px !important;
            }
            
            #heroVideoSection {
                flex: 1 !important;
                max-width: 400px !important;
            }
            
            #heroVideoSection p {
                font-size: 10px !important;
            }
        }
        
        /* Tutorial Screen Responsive Styles */
        @media (max-width: 768px) {
            #tutorialContent {
                padding: 20px !important;
                width: 95% !important;
            }
            
            #tutorialContent h2 {
                font-size: 14px !important;
                margin-bottom: 20px !important;
            }
            
            #tutorialContent h3 {
                font-size: 10px !important;
            }
            
            #tutorialContent > div {
                flex-direction: column !important;
                gap: 20px !important;
            }
            
            #tutorialContent img {
                max-width: 100% !important;
            }
            
            #tutorialContent .info-column {
                font-size: 8px !important;
                line-height: 14px !important;
            }
            
            #dontShowTutorial {
                font-size: 8px !important;
                padding: 10px 20px !important;
            }
            
            #continueTutorial {
                font-size: 10px !important;
                padding: 12px 30px !important;
            }
        }
        
        @media (max-width: 768px) {
            #splashContent > div:first-child {
                flex-direction: row !important;
                gap: 30px !important;
            }
            
            #splashContent > div:first-child > div:first-child {
                flex: 1.2 !important;
            }
            
            #heroVideoSection {
                flex: 1 !important;
                max-width: 300px !important;
            }
            
            #splashScreen p {
                font-size: 12px !important;
                line-height: 1.4 !important;
            }
            
            #splashLogo {
                width: 400px !important;
            }
            
            #heroVideoSection p {
                font-size: 8px !important;
            }
        }
        
        @media (max-width: 600px) {
            #splashContent > div:first-child {
                gap: 20px !important;
            }
            
            #heroVideoSection {
                max-width: 200px !important;
            }
            
            #splashScreen p {
                font-size: 10px !important;
            }
            
            #heroVideoSection p {
                font-size: 7px !important;
            }
        }
        
        /* Responsive adjustments */
        @media (max-width: 1200px) {
            .player-info-box,
            .leaderboard-box {
                width: 240px;
                font-size: 10px;
            }
            
            .element-slot {
                width: 48px;
                height: 48px;
            }
            
            .element-slot .emoji {
                font-size: 24px;
            }
            
            .discovery-feed {
                width: 250px;
            }
        }
        
        @media (max-width: 800px) {
            .player-info-box,
            .leaderboard-box {
                /* Removed bottom positioning - will use orientation-specific rules */
                width: 200px;
            }
            
            body.mobile .player-info-box,
            body.mobile .leaderboard-box {
                /* Default mobile position - will be overridden by orientation-specific rules */
                bottom: unset !important; /* Ensure desktop bottom positioning is removed */
            }
            
            .discovery-feed {
                display: none; /* Hide on mobile */
            }
            
            #discoveryLog {
                width: 200px;
                font-size: 12px;
                padding: 15px;
            }
            
            #discoveryLog h3 {
                font-size: 16px;
            }
            
            .element-slot {
                width: 42px;
                height: 42px;
            }
            
            .boost-bar-container {
                width: 80%;
            }
            
            .virtual-joystick {
                width: 100px;
                height: 100px;
                right: 105px;
                bottom: 120px;
            }
            
            
            .joystick-knob {
                width: 40px;
                height: 40px;
            }
        }
        
        /* Force boost button size in landscape on mobile */
        @media (max-width: 800px) and (orientation: landscape) {
            
            body.mobile .virtual-joystick {
                width: 100px !important;
                height: 100px !important;
            }
        }
        
        /* Ensure consistent controls in landscape after other media queries */
        @media (orientation: landscape) {
            .virtual-joystick {
                width: 100px !important;
                height: 100px !important;
            }
            
        }
        
        /* Additional landscape fixes for all screens */
        @media (max-height: 500px) {
            /* Splash screen in extreme landscape */
            #splashContent {
                padding: 5px 20px !important;
                display: flex;
                flex-direction: row;
                align-items: center;
                justify-content: center;
                gap: 20px;
                max-height: 100vh !important;
            }
            
            #splashLogo {
                width: 200px !important;
                height: auto !important;
                flex-shrink: 0;
            }
            
            #splashScreen p {
                display: none !important; /* Hide all text in extreme landscape */
            }
            
            #splashTitle {
                display: none !important;
            }
            
            #startButton {
                flex-shrink: 0;
                padding: 12px 40px !important;
                font-size: 18px !important;
                visibility: visible !important;
                display: block !important;
            }
            
            /* Game mode selection in extreme landscape */
            #gameModeContent {
                padding: 5px 20px !important;
                max-height: 95vh !important;
            }
            
            #gameModeSelect h3 {
                font-size: 16px !important;
                margin: 5px 0 !important;
            }
            
            #victoryButtons {
                gap: 10px !important;
                margin-bottom: 10px !important;
            }
            
            .victory-column h5 {
                font-size: 14px !important;
                margin: 0 0 5px 0 !important;
            }
            
            .modeSection {
                margin-bottom: 5px !important;
            }
            
            .modeSection h4 {
                font-size: 12px !important;
                margin: 5px 0 !important;
            }
            
            #gameModeSelect button {
                padding: 6px 15px !important;
                font-size: 12px !important;
                min-width: 140px !important;
                margin: 2px !important;
            }
            
            .btn-infinite {
                min-width: 200px !important;
                font-size: 14px !important;
                padding: 8px 20px !important;
            }
        }
        
        /* Game mode selection landscape adjustments */
        @media (max-width: 800px) and (orientation: landscape) {
            #gameModeContent {
                padding: 10px;
                max-height: 85vh;
                overflow-y: auto;
                margin-top: 5px;
            }
            
            #gameModeSelect {
                padding: 5px;
            }
            
            #gameModeSelect h3 {
                font-size: 18px;
                margin-bottom: 5px;
                margin-top: 5px;
            }
            
            .modeSection {
                margin-bottom: 8px;
            }
            
            .modeSection h4 {
                font-size: 14px;
                margin-bottom: 5px;
            }
            
            .victoryButton {
                padding: 6px 12px;
                margin: 2px;
                font-size: 12px;
            }
            
            .controlOption {
                padding: 8px 15px;
                margin: 3px;
                font-size: 14px;
            }
            
            #startGameButton {
                padding: 10px 30px;
                font-size: 18px;
                margin-top: 5px;
                margin-bottom: 10px;
            }
        }
        
        /* Victory Overlay */
        #victoryOverlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(5px);
            -webkit-backdrop-filter: blur(5px);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 200;
        }
        
        #victoryPopup {
            position: relative;
            background: rgba(0, 0, 128, 0.85);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            padding: 48px;
            border-radius: 0;
            
            max-width: 600px;
            width: 90%;
            border: 8px solid;
            border-color: var(--snes-gold) #805800 #805800 var(--snes-gold);
            box-shadow: 8px 8px 0 rgba(0,0,0,0.5);
            animation: flash 0.5s steps(2) infinite alternate;
            font-family: 'Press Start 2P';
        }
        
        @keyframes flash {
            0% { outline: 4px solid var(--snes-gold); }
            100% { outline: 4px solid var(--snes-white); }
        }
        
        .victory-glow {
            display: none;
        }
        
        .victory-title {
            font-size: 24px;
            color: var(--snes-gold);
            margin-bottom: 24px;
            text-shadow: 2px 2px 0 var(--snes-red), 4px 4px 0 var(--snes-black);
            animation: blink 1s steps(2) infinite;
            text-transform: uppercase;
            letter-spacing: 2px;
        }
        
        @keyframes blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.8; }
        }
        
        .victory-lore {
            font-size: 10px;
            color: var(--snes-cosmic-teal);
            margin: 24px 0 32px;
            line-height: 2;
            font-style: normal;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .victory-stats {
            background: var(--snes-black);
            border-radius: 0;
            padding: 16px;
            margin: 24px 0;
            display: flex;
            flex-direction: column;
            gap: 12px;
            border: 4px solid;
            border-color: var(--snes-dark-blue) var(--snes-light-blue) var(--snes-light-blue) var(--snes-dark-blue);
        }
        
        .stat-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px;
            border-bottom: 2px solid var(--snes-dark-blue);
        }
        
        .stat-item:last-child {
            border-bottom: none;
        }
        
        .stat-label {
            color: #AAA;
            font-size: 16px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .stat-value {
            color: #FFD700;
            font-size: 24px;
            font-weight: bold;
            text-shadow: 0 0 10px rgba(255, 215, 0, 0.3);
        }
        
        .victory-button {
            margin-top: 24px;
            padding: 16px 32px;
            font-size: 12px;
            background: var(--snes-cosmic-purple);
            border: 4px solid var(--snes-white);
            border-radius: 0;
            color: var(--snes-white);
            cursor: pointer;
            transition: none;
            box-shadow: 4px 4px 0 rgba(0,0,0,0.5);
            font-family: 'Press Start 2P';
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .victory-button:hover {
            transform: translate(2px, 2px);
            box-shadow: 2px 2px 0 rgba(0,0,0,0.5);
        }
        
        .victory-button:active {
            transform: translate(4px, 4px);
            box-shadow: none;
        }
        
        /* Mobile adjustments for victory popup */
        @media (max-width: 600px) {
            #victoryPopup {
                padding: 30px;
            }
            
            .victory-title {
                font-size: 16px;
            }
            
            .victory-lore {
                font-size: 8px;
            }
            
            .stat-label {
                font-size: 8px;
            }
            
            .stat-value {
                font-size: 10px;
            }
        }
        
        /* Pause Menu */
        #pauseOverlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.8);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 100;
        }
        
        #pauseMenu {
            background: linear-gradient(135deg, #181850 0%, #2a1a50 50%, #1a1a40 100%);
            padding: 32px;
            border-radius: 0;
            
            width: 900px;
            height: 700px;
            max-width: 90vw;
            max-height: 90vh;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            border: 8px solid;
            border-color: var(--snes-cosmic-purple) var(--snes-dark-purple) var(--snes-dark-purple) var(--snes-cosmic-purple);
            box-shadow: 
                8px 8px 0 rgba(0,0,0,0.8),
                0 0 40px rgba(120, 40, 248, 0.3),
                inset 0 0 80px rgba(120, 40, 248, 0.1);
            outline: 2px solid var(--snes-gold);
            outline-offset: -12px;
            font-family: 'Press Start 2P';
            position: relative;
        }
        
        /* CRT scanlines for pause menu */
        #pauseMenu::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: repeating-linear-gradient(
                0deg,
                transparent,
                transparent 2px,
                rgba(0, 0, 0, 0.1) 2px,
                rgba(0, 0, 0, 0.1) 4px
            );
            pointer-events: none;
            z-index: 9999;
            mix-blend-mode: multiply;
        }
        
        /* Tab Navigation - SNES Style */
        .tab-navigation {
            display: flex;
            justify-content: center;
            gap: 8px;
            margin: 16px 0;
            border-bottom: 4px solid var(--snes-dark-purple);
            padding-bottom: 12px;
            flex-wrap: wrap;
        }
        
        .tab-button {
            padding: 12px 24px;
            background: linear-gradient(135deg, var(--snes-dark-purple) 0%, var(--snes-cosmic-purple) 100%);
            border: 3px solid;
            border-color: var(--snes-cosmic-purple) var(--snes-dark-purple) var(--snes-dark-purple) var(--snes-cosmic-purple);
            border-radius: 0;
            color: var(--snes-white);
            cursor: pointer;
            transition: none;
            font-size: 10px;
            text-transform: uppercase;
            font-family: 'Press Start 2P';
            box-shadow: 
                4px 4px 0 rgba(0,0,0,0.5),
                inset 0 0 20px rgba(120, 40, 248, 0.3);
        }
        
        .tab-button:hover {
            background: linear-gradient(135deg, var(--snes-cosmic-purple) 0%, var(--snes-cosmic-pink) 100%);
            transform: translate(2px, 2px);
            box-shadow: 
                2px 2px 0 rgba(0,0,0,0.5),
                0 0 20px rgba(248, 40, 248, 0.4);
        }
        
        .tab-button.active {
            background: linear-gradient(135deg, var(--snes-cosmic-pink) 0%, var(--snes-gold) 100%);
            color: var(--snes-black);
            border-color: var(--snes-gold) var(--snes-cosmic-pink) var(--snes-cosmic-pink) var(--snes-gold);
            transform: translate(4px, 4px);
            box-shadow: 
                none,
                0 0 30px rgba(248, 216, 0, 0.5),
                inset 0 0 20px rgba(248, 216, 0, 0.3);
        }
        
        .tab-content {
            display: none;
            animation: fadeIn 0.3s;
            flex: 1;
            overflow: hidden;
            min-height: 0;
            position: relative;
        }
        
        .tab-content.active {
            display: flex;
            flex-direction: column;
        }
        
        
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        /* Discovery Journal - SNES Style */
        #discoveryJournal {
            padding: 16px;
            padding-right: 12px;
            background: var(--snes-black);
            border-radius: 0;
            flex: 1;
            overflow: hidden;
            box-sizing: border-box;
            display: flex;
            flex-direction: column;
            min-height: 0;
            border: 4px solid;
            border-color: var(--snes-dark-blue) var(--snes-light-blue) var(--snes-light-blue) var(--snes-dark-blue);
        }
        
        
        .discovery-grid {
            display: grid;
            grid-template-columns: repeat(8, minmax(90px, 1fr));
            gap: 10px;
            margin-top: 20px;
            flex: 1;
            padding-right: 15px;
            box-sizing: border-box;
            align-content: start;
            overflow-y: auto;
            overflow-x: hidden;
            max-width: 100%;
            min-height: 0;
        }
        
        /* Custom scrollbar for discovery grid */
        .discovery-grid::-webkit-scrollbar {
            width: 8px;
        }
        
        .discovery-grid::-webkit-scrollbar-track {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 4px;
        }
        
        .discovery-grid::-webkit-scrollbar-thumb {
            background: rgba(255, 215, 0, 0.5);
            border-radius: 4px;
        }
        
        .discovery-grid::-webkit-scrollbar-thumb:hover {
            background: rgba(255, 215, 0, 0.7);
        }
        
        .discovery-item {
            background: var(--snes-dark-blue);
            border: 2px solid;
            border-color: var(--snes-cosmic-purple) var(--snes-dark-purple) var(--snes-dark-purple) var(--snes-cosmic-purple);
            border-radius: 0;
            padding: 4px;
            
            transition: none;
            cursor: pointer;
            position: relative;
            aspect-ratio: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            box-shadow: 2px 2px 0 rgba(0,0,0,0.5);
            image-rendering: pixelated;
            text-align: center;
        }
        
        .discovery-item:hover {
            background: var(--snes-cosmic-purple);
            transform: translate(1px, 1px);
            box-shadow: 1px 1px 0 rgba(0,0,0,0.5);
        }
        
        
        .discovery-item .element-symbol {
            font-size: 24px;
            margin-bottom: 4px;
            filter: drop-shadow(1px 1px 0 rgba(0,0,0,0.5));
        }
        
        .discovery-item .element-name {
            font-size: 8px;
            color: var(--snes-gold);
            word-break: break-word;
            line-height: 1.2;
            font-family: 'Press Start 2P';
            text-transform: uppercase;
        }
        
        .discovery-item .recipe {
            font-size: 6px;
            color: var(--snes-gray);
            margin-top: 4px;
            line-height: 1;
            font-family: 'Press Start 2P';
            text-transform: none;
            letter-spacing: -0.5px;
        }
        
        
        /* How to Play Section - SNES Style */
        .howToPlay {
            margin-top: 16px;
            padding: 16px;
            background: var(--snes-dark-blue);
            border-radius: 0;
            text-align: left;
            font-size: 8px;
            color: var(--snes-gray);
            line-height: 2;
            border: 4px solid;
            border-color: var(--snes-cosmic-teal) var(--snes-black) var(--snes-black) var(--snes-cosmic-teal);
        }
        
        .howToPlay h5 {
            color: var(--snes-gold);
            margin-bottom: 12px;
            
            font-size: 10px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .howToPlay ul {
            margin: 0;
            padding-left: 20px;
        }
        
        .howToPlay li {
            margin-bottom: 5px;
        }
        
        .howToPlay strong {
            color: var(--snes-cosmic-teal);
            text-shadow: 1px 1px 0 var(--snes-black);
        }
        
        /* Skin Selection */
        #skinSelection {
            padding: 20px;
            background: rgba(0,0,0,0.5);
            border-radius: 10px;
            height: 100%;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            position: relative;
            overflow-x: hidden;
            display: flex;
            flex-direction: column;
            min-height: 0;
        }
        
        #skinSelection h4 {
            color: #FFD700;
            margin-bottom: 10px;
            
        }
        
        #availableUnlocks {
            
            color: #4ecdc4;
            font-size: 16px;
            margin-bottom: 15px;
        }
        
        #skinGrid {
            display: flex;
            flex-direction: row;
            gap: 15px;
            margin-top: 15px;
            overflow-x: auto;
            overflow-y: hidden;
            padding-bottom: 15px;
            padding-right: 10px;
            white-space: nowrap;
            -webkit-overflow-scrolling: touch;
            scrollbar-width: thin;
            scrollbar-color: var(--snes-cosmic-purple) rgba(255, 255, 255, 0.1);
            flex: 1;
            align-items: stretch;
            border: none;
        }
        
        /* Webkit scrollbar styling for horizontal scroll */
        #skinGrid::-webkit-scrollbar {
            height: 8px;
        }
        
        #skinGrid::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
        }
        
        #skinGrid::-webkit-scrollbar-thumb {
            background: var(--snes-cosmic-purple);
            border-radius: 4px;
        }
        
        #skinGrid::-webkit-scrollbar-thumb:hover {
            background: var(--snes-cosmic-pink);
        }
        
        /* Drag scrolling styles */
        #skinGrid.dragging {
            cursor: grabbing !important;
            user-select: none !important;
            -webkit-user-select: none !important;
        }
        
        #skinGrid.dragging .skin-item {
            cursor: grabbing !important;
            pointer-events: none;
        }
        
        #skinGrid.dragging .skin-image {
            -webkit-user-drag: none;
            user-drag: none;
        }
        
        #skinGrid:not(.dragging) {
            cursor: grab;
        }
        
        #skinGrid:not(.dragging):active {
            cursor: grabbing;
        }
        
        .skin-item {
            position: relative;
            background: rgba(255,255,255,0.1);
            border: 2px solid rgba(255,255,255,0.2);
            border-radius: 8px;
            padding: 10px;
            cursor: pointer;
            transition: all 0.3s;
            
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            flex-shrink: 0;
            width: 120px;
            min-height: 180px;
        }
        
        .skin-item:hover {
            background: rgba(255,255,255,0.2);
            transform: scale(1.05);
        }
        
        .skin-item.current {
            border-color: #FFD700;
            background: rgba(255, 215, 0, 0.2);
        }
        
        .skin-item.locked {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .skin-item.locked:hover {
            transform: none;
        }
        
        .skin-item.unlockable {
            border-color: #4ecdc4;
            animation: glow 2s ease-in-out infinite;
        }
        
        @keyframes glow {
            0%, 100% { box-shadow: 0 0 5px #4ecdc4; }
            50% { box-shadow: 0 0 20px #4ecdc4, 0 0 30px #4ecdc4; }
        }
        
        .skin-image {
            width: 100%;
            height: 100%;
            max-width: 90px;
            max-height: 90px;
            margin: 0 auto 10px;
            display: block;
            image-rendering: pixelated;
            image-rendering: -moz-crisp-edges;
            image-rendering: crisp-edges;
            object-fit: contain;
            -webkit-user-drag: none;
            user-drag: none;
            user-select: none;
            -webkit-user-select: none;
            flex-shrink: 0;
        }
        
        .skin-name {
            font-size: 11px;
            color: #CCC;
            margin-top: 10px;
            line-height: 1.3;
            word-wrap: break-word;
            white-space: normal;
            width: calc(100% - 20px);
            
            position: absolute;
            bottom: 10px;
            left: 10px;
        }
        
        .skin-unlock-icon {
            position: absolute;
            top: 5px;
            right: 5px;
            font-size: 16px;
        }
        
        /* Hide the rarity indicator bar */
        .rarity-indicator {
            display: none;
        }
        /* Mobile pause menu fixes */
        @media (max-width: 800px) {
            #pauseMenu {
                width: 95%;
                max-width: 95%;
                padding: 10px;
                margin: 10px;
            }
            
            #skinGrid {
                gap: 10px;
                padding-right: 10px;
            }
            
            .skin-item {
                padding: 8px;
                width: 100px;
                min-height: 140px;
            }
            
            .skin-image {
                max-width: 70px;
                max-height: 70px;
            }
            
            .skin-name {
                font-size: 9px;
                line-height: 1.2;
            }
            
            .discovery-grid {
                grid-template-columns: repeat(4, 1fr);
                gap: 8px;
                padding-right: 0;
                overflow-x: hidden;
            }
            
            .discovery-item {
                padding: 4px;
            }
            
            .discovery-item .element-symbol {
                font-size: 20px;
            }
            
            .discovery-item .element-name {
                font-size: 7px;
            }
            
            .tab-button {
                font-size: 8px;
                padding: 8px 5px;
            }
        }
        
        /* Portrait mobile specific - fix discovery journal cutoff */
        @media (max-width: 600px) and (orientation: portrait) {
            .discovery-grid {
                grid-template-columns: repeat(4, 1fr) !important;
                gap: 4px;
            }
            
            .discovery-item {
                padding: 2px !important;
                aspect-ratio: 1;
            }
            
            .discovery-item .element-symbol {
                font-size: 16px !important;
                margin-bottom: 2px;
            }
            
            .discovery-item .element-name {
                font-size: 5px !important;
                line-height: 1;
            }
            
            .discovery-item .recipe {
                font-size: 4px !important;
            }
        }
        
        /* Landscape mobile specific */
        @media (max-width: 800px) and (orientation: landscape) {
            #pauseMenu {
                max-height: 85vh;
            }
            
            .discovery-grid {
                grid-template-columns: repeat(5, 1fr);
            }
            
            .discovery-grid {
                max-height: 200px;
            }
        }
        
        /* Ensure revive button maintains unified color scheme */
        #reviveBtn {
            background: var(--snes-cosmic-purple) !important;
            color: var(--snes-white) !important;
            border: 4px solid var(--snes-white) !important;
            font-family: 'Press Start 2P' !important;
            text-transform: uppercase !important;
            box-shadow: inset 2px 2px 0 var(--snes-cosmic-pink), 
                       inset -2px -2px 0 var(--snes-dark-purple), 
                       4px 4px 0 rgba(0,0,0,0.5) !important;
        }
        
        #reviveBtn:hover {
            background: var(--snes-cosmic-pink) !important;
            transform: translate(2px, 2px) !important;
            box-shadow: inset 2px 2px 0 #FFA8FF, 
                       inset -2px -2px 0 var(--snes-dark-purple), 
                       2px 2px 0 rgba(0,0,0,0.5) !important;
        }
        
        #reviveBtn:active {
            transform: translate(4px, 4px) !important;
            box-shadow: none !important;
        }
    </style>

    <!-- UI Fixes CSS - Added to improve readability and visual appeal -->
    <style>
        /* ===== PLAYER INFO BOX FIXES ===== */
        .player-info-box {
            width: 280px !important; /* Increased from 240px */
            font-size: 8px !important; /* Base font size */
        }
        
        /* Mobile positioning fix - ensure top positioning takes precedence */
        body.mobile .player-info-box {
            bottom: unset !important;
            display: block !important;
            visibility: visible !important;
            opacity: 1 !important;
        }
        
        body.mobile .leaderboard-box {
            bottom: unset !important;
        }

        .player-portrait {
            width: 64px !important; /* Increased from 48px */
            height: 64px !important; /* Increased from 48px */
            background: var(--snes-black) url('assets/space-background-profile.png') center/cover;
        }

        .player-portrait img {
            width: 60px !important; /* Increased from 44px */
            height: 60px !important; /* Increased from 44px */
            object-fit: contain !important;
        }

        .stat-label {
            font-size: 8px !important; /* Increased from 7px */
            letter-spacing: -0.5px !important; /* Tighten spacing to prevent overflow */
            flex-shrink: 0; /* Prevent label from shrinking */
            min-width: 60px; /* Ensure consistent width */
        }

        .stat-value {
            font-size: 10px !important; /* Increased from 7px but not too large */
            letter-spacing: -0.5px !important; /* Tighten spacing */
            text-align: right; /* Align values to the right */
            flex: 1; /* Take remaining space */
            overflow: hidden; /* Prevent overflow */
            text-overflow: ellipsis; /* Add ellipsis for very long numbers */
        }

        .stat-line {
            font-size: 8px !important; /* Ensure consistency */
            margin: 3px 0 !important; /* Slightly more spacing */
        }

        /* ===== SCOREBOARD BOX FIXES ===== */
        .leaderboard-box {
            width: 320px !important; /* Increased from 240px */
            cursor: pointer !important;
            transition: all 0.3s ease !important;
        }

        .leaderboard-header {
            font-size: 12px !important; /* Match BOOST bar text */
            position: relative !important;
        }


        /* Collapsed state */
        .leaderboard-box.collapsed {
            width: auto !important;
            min-width: 120px !important;
        }

        .leaderboard-box.collapsed #leaderboardList {
            display: none !important;
        }

        /* Restructure leaderboard entries */
        .leaderboard-entry {
            display: flex !important;
            padding: 5px 8px !important;
            position: relative !important;
            min-height: 28px !important; /* Reduced height for less spacing */
        }

        /* Two-line layout for names */
        .leaderboard-name {
            display: block !important;
            font-size: 7px !important;
            line-height: 1.3 !important;
            margin-bottom: 4px !important;
            white-space: nowrap !important; /* Prevent wrapping */
            overflow: hidden !important;
            text-overflow: ellipsis !important;
            width: 60% !important; /* Leave space for stats */
            font-family: 'Press Start 2P', monospace !important;
            text-transform: uppercase !important;
        }

        /* Style personality type differently */
        .leaderboard-name span[style*="color"] {
            display: block !important; /* Put personality on its own line */
            font-size: 10px !important;
            margin-bottom: 2px !important;
        }

        /* Stats on the right side */
        .leaderboard-stats {
            position: absolute !important;
            right: 8px !important;
            top: 50% !important;
            transform: translateY(-50%) !important;
            text-align: right !important;
            font-size: 9px !important;
            line-height: 1.1 !important;
            font-family: 'Press Start 2P', monospace !important;
        }

        .leaderboard-stats div {
            white-space: nowrap !important;
            margin-bottom: 2px !important;
        }

        /* ===== DISCOVERY MENU TAB FIXES ===== */
        .discovery-item .recipe {
            font-size: 8px !important; /* Increased from 6px */
            letter-spacing: 0 !important; /* Normal spacing for readability */
            line-height: 1.3 !important; /* Better line height */
        }

        .discovery-item .element-name {
            font-size: 9px !important; /* Increased from 8px */
        }

        /* ===== FONT UNIFORMITY FIXES ===== */
        /* Fix all buttons to use Press Start 2P */
        button {
            font-family: 'Press Start 2P', monospace !important;
        }

        /* Specifically target problem buttons */
        .btn-leaderboard,
        .mini-lb-tab,
        .leaderboard-tab,
        #submitScoreBtn,
        #skipScoreBtn,
        button[onclick*="resumeGame"],
        button[onclick*="reload"],
        button[onclick*="showLeaderboard"] {
            font-family: 'Press Start 2P', monospace !important;
        }

        /* Fix pause menu buttons */
        #pauseMenu button {
            font-family: 'Press Start 2P', monospace !important;
        }

        /* ===== DISCOVERY POPUP ENHANCEMENTS ===== */
        #recentDiscovery {
            background: linear-gradient(135deg, 
                rgba(120, 40, 248, 0.95) 0%, 
                rgba(248, 40, 248, 0.95) 100%) !important;
            color: var(--snes-white) !important;
            border: 4px solid var(--snes-gold) !important;
            border-color: var(--snes-gold) #A88800 #A88800 var(--snes-gold) !important;
            outline: 3px solid var(--snes-white) !important;
            outline-offset: -8px !important;
            box-shadow: 
                0 0 20px rgba(248, 216, 0, 0.6),
                8px 8px 0 rgba(0,0,0,0.8) !important;
            animation: none !important; /* Remove default animation */
        }

        #recentDiscovery.show {
            animation: epicDiscoveryPulse 0.5s steps(8) !important;
        }

        @keyframes epicDiscoveryPulse {
            0%, 100% {
                transform: translateX(-50%) translateY(0) scale(1);
                filter: hue-rotate(0deg);
            }
            25% {
                transform: translateX(-50%) translateY(-5px) scale(1.1);
                filter: hue-rotate(90deg);
            }
            50% {
                transform: translateX(-50%) translateY(0) scale(1.15);
                filter: hue-rotate(180deg);
            }
            75% {
                transform: translateX(-50%) translateY(-3px) scale(1.05);
                filter: hue-rotate(270deg);
            }
        }

        #recentDiscovery.combo {
            background: rgba(0, 0, 0, 0.95) !important; /* Solid black background */
            animation: epicComboFlash 0.3s steps(4) 3 !important;
        }

        @keyframes epicComboFlash {
            0%, 100% { 
                filter: brightness(1);
                transform: translateX(-50%) scale(1);
            }
            50% { 
                filter: brightness(1.5);
                transform: translateX(-50%) scale(1.1);
            }
        }

        /* ===== RESPONSIVE ADJUSTMENTS ===== */
        @media (max-width: 1200px) {
            .player-info-box {
                width: 260px !important; /* Still wider than original */
            }
            .leaderboard-box {
                width: 300px !important; /* Keep leaderboard wider */
            }
            /* Make Choose Your Fate section responsive */
            .section-block > div[style*="grid-template-columns: repeat(3, 1fr)"] {
                grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)) !important;
            }
        }

        @media (max-width: 800px) {
            .player-info-box {
                width: 220px !important; /* Compromise for mobile */
            }
            .leaderboard-box {
                width: 280px !important; /* Keep leaderboard wider on mobile */
            }
            
            .stat-label,
            .stat-value {
                font-size: 9px !important; /* Slightly smaller on mobile */
            }
            
            .leaderboard-entry {
                font-size: 7px !important;
            }
        }

        /* ===== ADDITIONAL FIXES ===== */
        /* Ensure discovery feed messages are readable */
        .discovery-message .discovery-name {
            font-size: 11px !important; /* Increased from 10px */
        }

        .discovery-message .discovery-combo {
            font-size: 9px !important; /* Increased from 8px */
        }

        /* Fix any overflow issues */
        .player-stats {
            min-width: 0 !important; /* Allow flex shrinking */
        }

        .stat-line {
            min-width: 0 !important; /* Prevent overflow */
        }
        
        /* Loading Screen Styles */
        #loadingScreen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: transparent;
            z-index: 9999;
            display: flex;
            justify-content: center;
            align-items: center;
            font-family: 'Press Start 2P', monospace;
        }
        
        .loading-content {
            width: 90%;
            max-width: 600px;
            
            position: relative;
        }
        
        .loading-stars-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            opacity: 0.3;
        }
        
        /* Logo Section */
        .loading-logo-section {
            margin-bottom: 40px;
            position: relative;
        }
        
        .loading-logo-glow {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 300px;
            height: 100px;
            background: radial-gradient(ellipse at center, var(--snes-cosmic-purple) 0%, transparent 70%);
            opacity: 0.5;
            animation: loadingGlowPulse 2s ease-in-out infinite;
        }
        
        .loading-title {
            font-size: 24px;
            color: var(--snes-gold);
            text-shadow: 2px 2px 0 var(--snes-red), 4px 4px 0 var(--snes-black);
            margin: 0;
            letter-spacing: 2px;
            animation: loadingTitlePulse 1s steps(2) infinite;
        }
        
        .loading-subtitle {
            font-size: 10px;
            color: var(--snes-cosmic-teal);
            margin-top: 10px;
            opacity: 0.8;
        }
        
        /* Progress Section */
        .loading-progress-section {
            margin-bottom: 30px;
        }
        
        .loading-progress-container {
            position: relative;
            margin-bottom: 15px;
        }
        
        .loading-progress-bar {
            width: 100%;
            height: 20px;
            background: rgba(0, 0, 0, 0.8);
            border: 3px solid var(--snes-dark-purple);
            box-shadow: inset 0 0 10px rgba(0, 0, 0, 0.5);
            position: relative;
            overflow: hidden;
        }
        
        .loading-progress-fill {
            height: 100%;
            width: 0%;
            background: linear-gradient(90deg, 
                var(--snes-cosmic-purple) 0%, 
                var(--snes-cosmic-pink) 50%, 
                var(--snes-cosmic-purple) 100%);
            background-size: 200% 100%;
            animation: loadingProgressShine 2s linear infinite;
            transition: width 0.3s ease;
        }
        
        .loading-progress-glow {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, 
                transparent 0%, 
                rgba(255, 255, 255, 0.3) 50%, 
                transparent 100%);
            transform: translateX(-100%);
            animation: loadingProgressGlow 2s linear infinite;
        }
        
        .loading-progress-text {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: var(--snes-gold);
            font-size: 10px;
            text-shadow: 1px 1px 0 var(--snes-black);
        }
        
        .loading-phase-text {
            font-size: 9px;
            color: var(--snes-gray);
            animation: loadingTextBlink 1s steps(2) infinite;
        }
        
        /* Tips Section */
        .loading-tips-section {
            margin-bottom: 30px;
            min-height: 40px;
        }
        
        .loading-tip-container {
            background: rgba(20, 20, 40, 0.8);
            border: 2px solid var(--snes-cosmic-teal);
            padding: 10px;
            position: relative;
            overflow: hidden;
        }
        
        .loading-tip-text {
            font-size: 9px;
            color: var(--snes-cosmic-teal);
            line-height: 1.5;
        }
        
        /* Element Preview */
        .loading-elements-preview {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 20px;
        }
        
        .loading-element-orb {
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            background: radial-gradient(circle at 30% 30%, 
                rgba(255, 255, 255, 0.2) 0%, 
                rgba(0, 0, 0, 0.4) 100%);
            border: 2px solid var(--snes-dark-purple);
            border-radius: 50%;
            animation: loadingOrbFloat 3s ease-in-out infinite;
            animation-delay: calc(var(--orb-index, 0) * 0.2s);
        }
        
        .loading-element-orb:nth-child(1) { --orb-index: 0; }
        .loading-element-orb:nth-child(2) { --orb-index: 1; }
        .loading-element-orb:nth-child(3) { --orb-index: 2; }
        .loading-element-orb:nth-child(4) { --orb-index: 3; }
        
        /* Animations */
        @keyframes loadingGlowPulse {
            0%, 100% { opacity: 0.3; transform: translate(-50%, -50%) scale(1); }
            50% { opacity: 0.6; transform: translate(-50%, -50%) scale(1.1); }
        }
        
        @keyframes loadingTitlePulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.8; }
        }
        
        @keyframes loadingProgressShine {
            0% { background-position: 0% 50%; }
            100% { background-position: 200% 50%; }
        }
        
        @keyframes loadingProgressGlow {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(200%); }
        }
        
        @keyframes loadingTextBlink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        
        @keyframes loadingOrbFloat {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }
        
        /* Mobile-specific adjustments */
        @media (max-width: 600px) {
            .loading-title {
                font-size: 16px;
            }
            
            .loading-subtitle {
                font-size: 8px;
            }
            
            .loading-progress-bar {
                height: 16px;
            }
            
            .loading-tip-text {
                font-size: 8px;
            }
            
            .loading-element-orb {
                width: 32px;
                height: 32px;
                font-size: 16px;
            }
        }
    </style>
</head>
<body>
<!-- Version Display -->
<div id="versionDisplay" style="position: relative; text-align: center; margin-top: 10px; z-index: 100; color: #666; font-family: 'Press Start 2P', monospace; font-size: 10px; pointer-events: none;">
    v<span id="versionNumber">1.12.0</span>
</div>

<!-- Immediate Mobile Detection -->
<script>
(function() {
    const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent) ||
                     'ontouchstart' in window ||
                     window.innerWidth < 768;
    if (isMobile) {
        document.body.classList.add('mobile');
    }
})();
</script>
    <!-- Persistent Star Background - REMOVED to eliminate transition star rendering -->
    <!-- <canvas id="persistentStarsCanvas" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 1; pointer-events: none;"></canvas> -->
    
    <!-- Video Modal -->
    <div id="videoModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.9); z-index: 10000; align-items: center; justify-content: center;">
        <div style="position: relative; width: 90%; max-width: 1200px; margin: 0 auto;">
            <button onclick="document.getElementById('videoModal').style.display = 'none'" 
                    style="position: absolute; top: -40px; right: 0; background: none; border: none; color: #4ecdc4; font-size: 30px; cursor: pointer; font-family: 'Press Start 2P', monospace;">
                X
            </button>
            <div style="position: relative; padding-bottom: 54.83870967741935%; height: 0;">
                <iframe id="loomVideo" src="" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen 
                        style="position: absolute; top: 0; left: 0; width: 100%; height: 100%;"></iframe>
            </div>
        </div>
    </div>
    
    <!-- Splash Screen -->
    <div id="splashScreen">
        <div style="position: absolute; top: 20px; left: 20px; z-index: 10;">
            <a href="https://discord.gg/a6X4W7QbkG" target="_blank" style="color: #4ecdc4; text-decoration: none; font-family: 'Press Start 2P', monospace; font-size: 10px;">ðŸ’¬ Join the Discord Server</a>
        </div>
        <div style="position: absolute; top: 20px; right: 20px; z-index: 10;">
            <a href="/how-to-play.html" style="color: #4ecdc4; text-decoration: none; font-family: 'Press Start 2P', monospace; font-size: 10px; margin-right: 20px;">ðŸ“– How to Play</a>
            <a href="/lore.html" style="color: #4ecdc4; text-decoration: none; font-family: 'Press Start 2P', monospace; font-size: 10px; margin-right: 20px;">ðŸ“œ Lore</a>
            <a href="/leaderboard.html" style="color: #4ecdc4; text-decoration: none; font-family: 'Press Start 2P', monospace; font-size: 10px; margin-right: 20px;">ðŸ† Leaderboard</a>
            <a href="/profile.html" style="color: #4ecdc4; text-decoration: none; font-family: 'Press Start 2P', monospace; font-size: 10px;">ðŸ‘¤ Profile</a>
        </div>
        <div id="splashContent">
            <div style="display: flex; align-items: center; gap: 100px; max-width: 1800px; margin: 0 auto; padding: 0 40px;">
                <div style="flex: 1; max-width: 700px;">
                    <img src="infinite-snake-preview-splash-logo.png" alt="Infinite Snake game logo - A cosmic snake forming an infinity symbol" id="splashLogo" style="width: 800px; max-width: 100%; margin-bottom: 30px;" onerror="this.style.display='none'; document.getElementById('splashTitle').style.display='block';">
                    <h1 id="splashTitle" style="text-align: left; margin-left: 0;">Infinite Snake</h1>
                    <p style="text-align: left; margin-left: 0;">Welcome to what's left.<br><br>
                    The Universe collapsed, scattered its contents across infinite coils of nothing. You're the Infinite Snake - part cleanup crew, part living library.<br><br>
                    Collect fragments of reality. Merge them. See what happens. Rebuild the Cosmos one combination at a time. Maybe you'll figure out what we forgot.<br><br>
</p>
                    <div style="margin: 20px 0;">
                        <input type="text" id="playerNameInput" placeholder="Enter your name" 
                               style="width: 300px; max-width: 80%; padding: 12px 20px; 
                                      font-family: 'Press Start 2P', monospace; font-size: 12px; 
                                      background: rgba(0, 0, 0, 0.8); 
                                      border: 4px solid #fff; 
                                      color: #4ecdc4;  
                                      border-radius: 0; outline: none;
                                      box-shadow: 
                                        inset 2px 2px 0 #2a2a4a,
                                        inset -2px -2px 0 #000,
                                        4px 4px 0 rgba(0,0,0,0.5);
                                      transition: none;
                                      display: block;
                                      margin: 0;
                                      text-align: center;"
                               maxlength="30">
                        <p style="font-family: 'Press Start 2P', monospace; font-size: 8px; color: #888; margin-top: 8px; text-align: left;">
                            ENTER YOUR PLAYER NAME
                        </p>
                    </div>
                    <button id="startButton" style="margin-left: 0;">ENTER THE VOID</button>
                    <div id="assetLoadingStatus" style="margin-top: 20px; font-family: 'Press Start 2P', monospace; font-size: 10px; color: #4ecdc4; min-height: 20px; text-align: left;">
                        <span id="loadingText" style="display: none;">Loading assets...</span>
                    </div>
                </div>
                <div id="heroVideoSection" style="flex: 2; max-width: none; position: relative;">
                    <div style="position: relative; width: 100%; padding-bottom: 56.25%; background: rgba(0, 0, 0, 0.8); border: 4px solid #4ecdc4; box-shadow: 0 0 20px rgba(78, 205, 196, 0.5); overflow: hidden; cursor: pointer;"
                         onclick="document.getElementById('videoModal').style.display = 'flex'; document.getElementById('loomVideo').src = 'https://www.loom.com/embed/cb0e142aae8544748f270faf88cda78d?sid=5f7df640-70fc-4006-a449-e315f823ce65';">
                        <video id="heroIntroVideo" 
                               style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; object-fit: cover;" 
                               autoplay 
                               loop 
                               muted 
                               playsinline
                               preload="auto">
                            <source src="video/hero-gameplay-intro.mp4" type="video/mp4">
                        </video>
                    </div>
                    <p style="font-family: 'Press Start 2P', monospace; font-size: 12px; color: #ffff00; 
                              text-shadow: 2px 2px 0 #000; margin-top: 15px; text-align: center;">
                        CLICK TO WATCH FULL GAMEPLAY VIDEO
                    </p>
                </div>
            </div>
            <div class="scroll-indicator" onclick="document.getElementById('splashScreen').scrollBy({top: window.innerHeight, behavior: 'smooth'})"></div>
        </div>
        
        <!-- Infinite Snake Info Section -->
    <style>
        .info-section {
            color: var(--snes-white);
            font-family: 'Press Start 2P', monospace;
            padding: 80px 0;
            width: 100%;
        }
        
        .info-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }
        
        .section-block {
            margin-bottom: 80px;
            
        }
        
        .section-title {
            font-size: 28px;
            color: var(--snes-cosmic-teal);
            margin-bottom: 30px;
            text-transform: uppercase;
            letter-spacing: 2px;
            text-shadow: 
                2px 2px 0 var(--snes-dark-purple),
                4px 4px 0 var(--snes-black);
            text-align: center;
        }
        
        .section-subtitle {
            font-size: 14px;
            color: var(--snes-cosmic-purple);
            margin-bottom: 40px;
            line-height: 1.8;
            text-align: center;
        }
        
        .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 60px;
            margin-top: 50px;
            max-width: 1200px;
            padding: 0 20px;
        }
        
        .feature-card {
            background: rgba(120, 40, 248, 0.1);
            border: 4px solid var(--snes-dark-purple);
            padding: 30px;
            border-radius: 0;
            transition: all 0.3s ease;
            box-shadow: 
                inset 2px 2px 0 rgba(255,255,255,0.1),
                inset -2px -2px 0 rgba(0,0,0,0.3),
                4px 4px 0 rgba(0,0,0,0.5);
            width: 100%;
            max-width: 280px;
            text-align: center;
        }
        
        .feature-card:hover {
            border-color: var(--snes-cosmic-teal);
            transform: translateY(-5px);
            box-shadow: 
                inset 2px 2px 0 rgba(255,255,255,0.2),
                inset -2px -2px 0 rgba(0,0,0,0.4),
                0 10px 30px rgba(78, 205, 196, 0.3);
        }
        
        .feature-icon {
            font-size: 48px;
            margin-bottom: 20px;
        }
        
        .feature-title {
            font-size: 16px;
            color: var(--snes-cosmic-pink);
            margin-bottom: 15px;
        }
        
        .feature-description {
            font-size: 10px;
            line-height: 1.8;
            color: var(--snes-gray);
            text-align: center;
        }
        
        .stats-row {
            display: flex;
            justify-content: space-around;
            flex-wrap: wrap;
            margin: 60px 0;
            gap: 30px;
        }
        
        .info-section .stat-item {
            
            display: flex;
            flex-direction: column;
        }
        
        .stat-number {
            font-size: 36px;
            color: var(--snes-gold);
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 10px;
            text-shadow: 
                2px 2px 0 var(--snes-cosmic-purple),
                4px 4px 0 var(--snes-black);
            height: 50px;
        }
        
        .stat-label {
            font-size: 12px;
            color: var(--snes-gray);
        }
        
        .gameplay-showcase {
            background: rgba(78, 205, 196, 0.1);
            border: 4px solid var(--snes-cosmic-teal);
            padding: 40px;
            border-radius: 0;
            margin: 60px 0;
            box-shadow: 
                inset 2px 2px 0 rgba(255,255,255,0.2),
                inset -2px -2px 0 rgba(0,0,0,0.3),
                4px 4px 0 rgba(0,0,0,0.5);
        }
        
        .element-examples {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 20px;
            margin: 30px 0;
            flex-wrap: wrap;
        }
        
        .element-combo {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 24px;
        }
        
        .plus-sign {
            color: var(--snes-cosmic-teal);
            font-size: 20px;
        }
        
        .equals-sign {
            color: var(--snes-cosmic-pink);
            font-size: 20px;
        }
        
        .cta-section {
            
            margin: 80px 0;
        }
        
        .cta-button {
            display: inline-block;
            background: var(--snes-cosmic-purple);
            color: var(--snes-white);
            padding: 16px 32px;
            text-decoration: none;
            font-size: 12px;
            border: 4px solid var(--snes-white);
            border-radius: 0;
            transition: none;
            text-transform: uppercase;
            font-family: 'Press Start 2P', monospace;
            box-shadow: 
                inset 2px 2px 0 var(--snes-cosmic-pink),
                inset -2px -2px 0 var(--snes-dark-purple),
                4px 4px 0 rgba(0,0,0,0.5);
            cursor: pointer;
            letter-spacing: 1px;
        }
        
        .cta-button:hover {
            background: var(--snes-cosmic-pink);
            transform: translate(2px, 2px);
            box-shadow: 
                inset 2px 2px 0 #FFA8FF,
                inset -2px -2px 0 var(--snes-dark-purple),
                2px 2px 0 rgba(0,0,0,0.5);
        }
        
        .cta-button:active {
            transform: translate(4px, 4px);
            box-shadow: none;
        }
        
        .story-section {
            background: rgba(120, 40, 248, 0.1);
            border: 4px solid var(--snes-cosmic-purple);
            padding: 40px;
            border-radius: 0;
            margin: 60px 0;
            
            box-shadow: 
                inset 2px 2px 0 rgba(255,255,255,0.1),
                inset -2px -2px 0 rgba(0,0,0,0.3),
                4px 4px 0 rgba(0,0,0,0.5);
        }
        
        .story-text {
            font-size: 11px;
            line-height: 2;
            color: var(--snes-white);
            max-width: 800px;
            margin: 0 auto;
            text-align: center;
        }
        
        /* Ensure text centering with higher specificity */
        .feature-card .feature-description,
        .gameplay-showcase .feature-description,
        .story-section .story-text {
            text-align: center !important;
        }
        
        @media (max-width: 768px) {
            .section-title {
                font-size: 20px;
            }
            
            .features-grid {
                grid-template-columns: 1fr;
            }
            
            .stat-number {
                font-size: 28px;
            }
        }
    </style>

    <div class="info-section">
        <div class="info-container">
            
            <!-- Main Introduction -->
            <div class="section-block">
                <h2 class="section-title">Craft the Cosmos, One Element at a Time</h2>
                <div style="width: 100%; text-align: center !important;">
                    <p class="section-subtitle" style="text-align: center !important; margin: 0 auto 40px auto; display: block; width: 100%;">
                        THE UNIVERSE COLLAPSED. YOU ARE THE INFINITE SNAKE.<br>
                        CONSUME. COMBINE. CREATE. REBUILD REALITY.
                    </p>
                </div>
            </div>
            
            <!-- Stats Section -->
            <div class="stats-row">
                <div class="stat-item">
                    <span class="stat-number">10,000+</span>
                    <span class="stat-label">ELEMENTS TO DISCOVER</span>
                </div>
                <div class="stat-item">
                    <span class="stat-number">20,000+</span>
                    <span class="stat-label">COMBINATIONS POSSIBLE</span>
                </div>
                <div class="stat-item">
                    <span class="stat-number">80+</span>
                    <span class="stat-label">LORE FRAGMENTS</span>
                </div>
                <div class="stat-item">
                    <span class="stat-number">100%</span>
                    <span class="stat-label">FREE FOREVER</span>
                </div>
            </div>
            
            <!-- Gameplay Screenshots Row 1 -->
            <div style="display: flex; gap: 20px; margin: 50px auto; max-width: 1040px; justify-content: center;">
                <div style="flex: 1; text-align: center; max-width: 500px;">
                    <img src="screenshots/screenshot-gameplay-1.jpeg" alt="Discover New Elements!" style="width: 100%; border: 3px solid #4ecdc4; border-radius: 8px; box-shadow: 0 4px 8px rgba(0,0,0,0.3);">
                    <p style="color: #f7b733; font-size: 14px; margin-top: 10px; font-family: 'Press Start 2P', monospace;">Craft New Discoveries</p>
                </div>
                <div style="flex: 1; text-align: center; max-width: 500px;">
                    <img src="screenshots/screenshot-gameplay-2.jpeg" alt="Grow Your Snake!" style="width: 100%; border: 3px solid #4ecdc4; border-radius: 8px; box-shadow: 0 4px 8px rgba(0,0,0,0.3);">
                    <p style="color: #f7b733; font-size: 14px; margin-top: 10px; font-family: 'Press Start 2P', monospace;">Consume Elements to Grow Your Snake</p>
                </div>
            </div>
            
            <!-- Core Features -->
            <div class="section-block">
                <h2 class="section-title">FEATURES</h2>
                
                <div class="features-grid" style="margin: 50px auto 0;">
                    <div class="feature-card">
                        <div class="feature-icon">ðŸ§ª</div>
                        <h3 class="feature-title">ELEMENT CRAFTING</h3>
                        <p class="feature-description">
                            Collect and combine elements inside your snake's body.<br>
                            Start with Earth, Air, Fire, and Water.<br>
                            Discover over 10,000 unique combinations!
                        </p>
                    </div>
                    
                    <div class="feature-card">
                        <div class="feature-icon">ðŸ†</div>
                        <h3 class="feature-title">GLOBAL LEADERBOARDS</h3>
                        <p class="feature-description">
                            Compete for the top spot in Daily, Weekly, Monthly, and All-Time rankings.<br>
                            Every element combination counts toward your score!
                        </p>
                    </div>
                    
                    <div class="feature-card">
                        <div class="feature-icon">ðŸ“–</div>
                        <h3 class="feature-title">DISCOVERY JOURNAL</h3>
                        <p class="feature-description">
                            Track every element you've discovered.<br>
                            Your collection persists between sessions.<br>
                            Can you discover them all?
                        </p>
                    </div>
                    
                    <div class="feature-card">
                        <div class="feature-icon">ðŸ‘¹</div>
                        <h3 class="feature-title">BOSS BATTLES</h3>
                        <p class="feature-description">
                            Face the Deep Old Ones - ancient beings from the void.<br>
                            Defeat them to unlock exclusive snake skins and rare elements.
                        </p>
                    </div>
                    
                    <div class="feature-card">
                        <div class="feature-icon">ðŸŽ®</div>
                        <h3 class="feature-title">2 GAME MODES</h3>
                        <p class="feature-description">
                            Choose your adventure style.<br>
                            From hardcore permadeath to peaceful exploration.<br>
                            Find the perfect way to rebuild the cosmos!
                        </p>
                    </div>
                    
                    <div class="feature-card">
                        <div class="feature-icon">ðŸ“œ</div>
                        <h3 class="feature-title">LORE FRAGMENTS</h3>
                        <p class="feature-description">
                            Uncover the mysteries of the collapsed universe.<br>
                            Over 80 lore fragments to unlock through gameplay.<br>
                            Piece together the cosmic story!
                        </p>
                    </div>
                    
                    <div class="feature-card">
                        <div class="feature-icon">ðŸ”¥</div>
                        <h3 class="feature-title">KILLSTREAKS & COMBOS</h3>
                        <p class="feature-description">
                            Chain your kills for epic combos!<br>
                            Earn medals and hear throwback announcements.<br>
                            DOUBLE STRIKE! TRIPLE FANG! DEATH COIL!
                        </p>
                    </div>
                    
                    <div class="feature-card">
                        <div class="feature-icon">ðŸŽµ</div>
                        <h3 class="feature-title">EDM SPACE SOUNDTRACK</h3>
                        <p class="feature-description">
                            Immerse yourself in an electronic space odyssey.<br>
                            Original soundtrack that evolves with your journey.<br>
                            Feel the cosmic void pulse around you.
                        </p>
                    </div>
                    
                    <div class="feature-card">
                        <div class="feature-icon">ðŸŽ¨</div>
                        <h3 class="feature-title">SNAKE SKINS</h3>
                        <p class="feature-description">
                            Unlock unique skins through gameplay achievements.<br>
                            Rarity tiers: Common, Uncommon, Rare, Legendary, Exotic, Secret.<br>
                            Special skins from boss defeats and milestones!
                        </p>
                    </div>
                </div>
                
                <!-- Gameplay Screenshots Row 2 -->
                <div style="display: flex; gap: 20px; margin: 50px auto; max-width: 1040px; justify-content: center;">
                    <div style="flex: 1; text-align: center; max-width: 500px;">
                        <img src="screenshots/screenshot-skin-selection.jpeg" alt="Collect Unique Skins" style="width: 100%; border: 3px solid #4ecdc4; border-radius: 8px; box-shadow: 0 4px 8px rgba(0,0,0,0.3);">
                        <p style="color: #f7b733; font-size: 14px; margin-top: 10px; font-family: 'Press Start 2P', monospace;">Collect Over 50 Unique Skins</p>
                    </div>
                    <div style="flex: 1; text-align: center; max-width: 500px;">
                        <img src="screenshots/screenshot-lore.jpeg" alt="Unlock the Story!" style="width: 100%; border: 3px solid #4ecdc4; border-radius: 8px; box-shadow: 0 4px 8px rgba(0,0,0,0.3);">
                        <p style="color: #f7b733; font-size: 14px; margin-top: 10px; font-family: 'Press Start 2P', monospace;">Unravel the Story of Infinite Snake</p>
                    </div>
                </div>
                
                <!-- Gameplay Screenshots Row 3 -->
                <div style="display: flex; gap: 20px; margin: 50px auto; max-width: 1040px; justify-content: center;">
                    <div style="flex: 1; text-align: center; max-width: 500px;">
                        <img src="screenshots/screenshot-discovery-journal.jpeg" alt="Build Your Discovery Journal" style="width: 100%; border: 3px solid #4ecdc4; border-radius: 8px; box-shadow: 0 4px 8px rgba(0,0,0,0.3);">
                        <p style="color: #f7b733; font-size: 14px; margin-top: 10px; font-family: 'Press Start 2P', monospace;">Build Your Discovery Journal</p>
                    </div>
                    <div style="flex: 1; text-align: center; max-width: 500px;">
                        <img src="screenshots/screenshot-leaderboard.jpeg" alt="Climb the Leaderboards!" style="width: 100%; border: 3px solid #4ecdc4; border-radius: 8px; box-shadow: 0 4px 8px rgba(0,0,0,0.3);">
                        <p style="color: #f7b733; font-size: 14px; margin-top: 10px; font-family: 'Press Start 2P', monospace;">Climb the Leaderboards!</p>
                    </div>
                </div>
            </div>
            
            
            <!-- Gameplay Showcase -->
            <div class="gameplay-showcase">
                <h2 class="section-title" style="">ELEMENT COMBINATIONS</h2>
                <div style="width: 100%; text-align: center !important;">
                    <p class="section-subtitle" style="text-align: center !important; margin: 0 auto 40px auto; display: block; width: 100%;">
                        Mix and match to forge entire worlds from scratch
                    </p>
                </div>
                
                <div class="element-examples" style="display: flex; flex-direction: column; gap: 30px; margin: 40px auto; max-width: 600px; align-items: center;">
                    <div class="element-combo" style="display: flex; flex-direction: column; align-items: center; gap: 10px;">
                        <div style="display: flex; align-items: center; gap: 10px; font-size: 32px;">
                            <span>ðŸ”¥</span>
                            <span class="plus-sign">+</span>
                            <span>ðŸ’§</span>
                            <span class="equals-sign">=</span>
                            <span>â˜ï¸</span>
                        </div>
                        <span style="color: var(--snes-gray); font-size: 10px; font-family: 'Press Start 2P', monospace;">Shape the forces of nature</span>
                    </div>
                    
                    <div class="element-combo" style="display: flex; flex-direction: column; align-items: center; gap: 10px;">
                        <div style="display: flex; align-items: center; gap: 10px; font-size: 32px;">
                            <span>ðŸŒ</span>
                            <span class="plus-sign">+</span>
                            <span>ðŸ”§</span>
                            <span class="equals-sign">=</span>
                            <span>ðŸ­</span>
                        </div>
                        <span style="color: var(--snes-gray); font-size: 10px; font-family: 'Press Start 2P', monospace;">Build thriving civilizations</span>
                    </div>
                    
                    <div class="element-combo" style="display: flex; flex-direction: column; align-items: center; gap: 10px;">
                        <div style="display: flex; align-items: center; gap: 10px; font-size: 32px;">
                            <span>ðŸŽ®</span>
                            <span class="plus-sign">+</span>
                            <span>âš¡</span>
                            <span class="equals-sign">=</span>
                            <span>???</span>
                        </div>
                        <span style="color: var(--snes-gray); font-size: 10px; font-family: 'Press Start 2P', monospace;">Craft your favorite fandoms</span>
                    </div>
                </div>
                
                <div style="text-align: center !important; width: 100%;">
                    <p class="feature-description" style="margin-top: 40px; text-align: center !important; display: block; margin-left: auto; margin-right: auto;">
                        From primordial elements to pop culture icons, every combination unlocks new possibilities. Create forests and oceans, forge cities and technologies, or summon characters from your beloved games and shows. What universe will you build?
                    </p>
                </div>
            </div>
            
            <!-- About -->
            <div class="story-section">
                <h2 class="section-title">ABOUT</h2>
                <div style="text-align: center !important; width: 100%;">
                    <p class="story-text" style="text-align: center !important; display: block; margin-left: auto; margin-right: auto;">
                        I made this game as a surprise for my son, mashing together his favorite genres - crafting, alchemy, and snake games. 
                        It was supposed to be something fun for him to play while I traveled for work. Instead, it turned into this massive cosmic adventure that continues to grow.
                        <br><br>
                        We're keeping it free forever. Nothing beats the moment when you discover a new element or figure out a crazy combination. 
                        Every week we throw in new stuff - elements, recipes, lore, skins, whatever we think of. The universe just keeps getting bigger.
                        <br><br>
                        As a solo dev (using that word loosely), I'm committed to regularly updating this game - squashing bugs, adding new elements and combos, 
                        and bringing community suggestions to life. If you want to support the ongoing development, you can <a href="https://coff.ee/jsnbrtz" target="_blank">buy me a coffee</a>. 
                        But whether you do or don't, the game stays free and the updates keep coming.
                    </p>
                </div>
            </div>
            
            <!-- How to Play Summary -->
            <div class="section-block">
                <h2 class="section-title">HOW TO PLAY</h2>
                <div class="features-grid" style="grid-template-columns: repeat(3, 300px); max-width: none; margin: 0; gap: 60px; justify-content: flex-start;">
                    <div class="feature-card">
                        <h3 class="feature-title">1. CONTROL</h3>
                        <p class="feature-description">
                            Mouse, Arrow Keys, or WASD on desktop<br>
                            Touch controls on mobile<br>
                            Hold to boost (uses stamina)
                        </p>
                    </div>
                    
                    <div class="feature-card">
                        <h3 class="feature-title">2. DISCOVER</h3>
                        <p class="feature-description">
                            Consume elemental orbs<br>
                            Your snake holds up to 6 elements<br>
                            Elements auto-combine when compatible<br>
                            Unlock lore fragments as you play
                        </p>
                    </div>
                    
                    <div class="feature-card">
                        <h3 class="feature-title">3. DOMINATE</h3>
                        <p class="feature-description">
                            Devour smaller snakes<br>
                            Chain kills for epic streaks<br>
                            Classic Mode: 3 lives only<br>
                            Cozy Mode: Play peacefully
                        </p>
                    </div>
                </div>
            </div>
            
            <!-- Call to Action -->
            <div class="cta-section">
                <h2 class="section-title" style="text-align: center;">READY TO REBUILD THE COSMOS?</h2>
                <div style="margin-top: 50px; text-align: center;">
                    <button class="cta-button" onclick="document.getElementById('startButton').click()">ENTER THE VOID</button>
                </div>
            </div>
            
            <!-- Footer Links -->
            <div style="margin-top: 60px; padding-top: 40px; border-top: 2px solid var(--snes-dark-purple);">
                <div class="title-footer-links">
                    <a href="/how-to-play.html">How to Play</a>
                    <a href="/lore.html">Lore</a>
                    <a href="/leaderboard.html">Leaderboard</a>
                    <a href="/profile.html">Profile</a>
                    <a href="/credits.html">Credits</a>
                    <a href="/privacypolicy.html">Privacy Policy</a>
                    <a href="/termsofservice.html">Terms of Service</a>
                    <a href="https://discord.gg/a6X4W7QbkG" target="_blank">Discord</a>
                </div>
            </div>
            
        </div>
    </div>

    <script>
    function scrollToTop() {
        window.scrollTo({ top: 0, behavior: 'smooth' });
    }
    
    // Fix game setup modal layout
    function fixGameSetupModal() {
        const gameModeContent = document.getElementById('gameModeContent');
        if (!gameModeContent) return;
        
        // Add styles for the mode boxes
        const styleSheet = document.createElement('style');
        styleSheet.textContent = `
            .game-mode-box {
                position: relative;
                transition: none !important;
                box-shadow: 6px 6px 0 rgba(0,0,0,0.8) !important;
            }
            
            .game-mode-box:hover {
                transform: translate(-2px, -2px);
                box-shadow: 8px 8px 0 rgba(0,0,0,0.8) !important;
            }
            
            .game-mode-box:active {
                transform: translate(4px, 4px);
                box-shadow: 2px 2px 0 rgba(0,0,0,0.8) !important;
            }
            
            .game-mode-box.selected {
                animation: modeSelected 0.5s ease-out;
            }
            
            @keyframes modeSelected {
                0% { transform: translate(0, 0); }
                25% { transform: translate(6px, 6px); }
                50% { transform: translate(4px, 4px) scale(0.95); }
                75% { transform: translate(2px, 2px) scale(1.05); }
                100% { transform: translate(4px, 4px) scale(1); }
            }
            
            .mode-title {
                position: relative;
                box-shadow: inset 0 -2px 0 rgba(0,0,0,0.3);
            }
            
            .game-mode-box.mode-disabled {
                opacity: 0.5;
                cursor: not-allowed !important;
            }
            
            .game-mode-box.mode-disabled:hover {
                transform: none;
                box-shadow: 6px 6px 0 rgba(0,0,0,0.8) !important;
            }
        `;
        document.head.appendChild(styleSheet);
        
        // Create the properly structured modal content
        gameModeContent.innerHTML = `
            <h3 style="color: #F8D800; font-size: 20px; text-align: center; margin-bottom: 15px; font-family: 'Press Start 2P', monospace; text-shadow: 2px 2px 0 #000;">GAME SETUP</h3>
            <h4 style="color: #00D9FF; font-size: 12px; text-align: center; margin-bottom: 20px; font-family: 'Press Start 2P', monospace; text-shadow: 1px 1px 0 #000;">CHOOSE YOUR MODE</h4>
            
            <div class="mode-selection-container" style="display: flex; justify-content: center; gap: 20px; align-items: stretch;">
                <!-- CLASSIC MODE -->
                <div class="game-mode-box mode-box-classic" style="flex: 1; max-width: 220px; border: 3px solid #F828F8; background: transparent; display: flex; flex-direction: column; cursor: pointer; position: relative;" onclick="animateAndSelectMode(this, 'classic')">
                    <div class="mode-title" style="background: #F828F8; color: #000; padding: 10px; text-align: center; font-size: 11px; font-family: 'Press Start 2P', monospace; border-bottom: 3px solid #C820C8;">
                        CLASSIC MODE
                    </div>
                    <div class="mode-content" style="padding: 20px 15px; flex-grow: 1; display: flex; align-items: center; justify-content: center; text-align: center; color: #F828F8; font-size: 9px; line-height: 14px; font-family: 'Press Start 2P', monospace; text-transform: uppercase;">
                        <div>
                            3 LIVES.<br>
                            PERMADEATH.<br>
                            BATTLE ENEMY SNAKES<br>
                            AND EPIC BOSSES.<br>
                            COMPETE FOR THE<br>
                            GLOBAL LEADERBOARD.<br>
                            HOW LONG CAN YOU<br>
                            SURVIVE THE VOID?
                        </div>
                    </div>
                </div>
                
                <!-- COZY MODE -->
                <div class="game-mode-box mode-box-cozy" style="flex: 1; max-width: 220px; border: 3px solid #00D9FF; background: transparent; display: flex; flex-direction: column; cursor: pointer; position: relative;" onclick="animateAndSelectMode(this, 'cozy')">
                    <div class="mode-title" style="background: #00D9FF; color: #000; padding: 10px; text-align: center; font-size: 11px; font-family: 'Press Start 2P', monospace; border-bottom: 3px solid #00A9CF;">
                        "COZY" MODE
                    </div>
                    <div class="mode-content" style="padding: 20px 15px; flex-grow: 1; display: flex; align-items: center; justify-content: center; text-align: center; color: #00D9FF; font-size: 9px; line-height: 14px; font-family: 'Press Start 2P', monospace; text-transform: uppercase;">
                        <div>
                            NO ENEMIES.<br>
                            NO DEATHS.<br>
                            JUST VIBES.<br>
                            DRIFT THROUGH SPACE<br>
                            TO A LOFI<br>
                            SOUNDTRACK.<br>
                            DISCOVER ELEMENTS<br>
                            AT YOUR OWN PACE.
                        </div>
                    </div>
                </div>
            </div>
            
            <div id="mobileMessage" style="display: none; color: #999; font-size: 10px; text-align: center; font-family: 'Press Start 2P', monospace; margin-top: 20px; padding: 0 20px; line-height: 16px;">
                Infinite Snake was created as a desktop experience.<br>
                Visit on a desktop browser for the full game.
            </div>
        `;
        
        // Mobile modes are now enabled - no restrictions
        // All game modes (classic, infinite, cozy) are available on mobile/iPad
    }
    
    // Animate and select game mode
    function animateAndSelectMode(element, mode) {
        // All modes are now available on mobile - no restrictions
        
        // Add selected animation
        element.classList.add('selected');
        
        // Remove animation class after it completes
        setTimeout(() => {
            element.classList.remove('selected');
        }, 500);
        
        // Call the actual selectGameMode function after a short delay
        setTimeout(() => {
            if (typeof selectGameMode === 'function') {
                selectGameMode(mode);
            }
        }, 200);
    }
    
    // Call the fix when DOM is ready and when game mode select is shown
    document.addEventListener('DOMContentLoaded', function() {
        fixGameSetupModal();
        
        // Also fix it when the modal becomes visible
        const observer = new MutationObserver(function(mutations) {
            mutations.forEach(function(mutation) {
                if (mutation.target.id === 'gameModeSelect' && mutation.target.style.display === 'block') {
                    setTimeout(fixGameSetupModal, 100);
                }
            });
        });
        
        const gameModeSelect = document.getElementById('gameModeSelect');
        if (gameModeSelect) {
            observer.observe(gameModeSelect, { attributes: true, attributeFilter: ['style'] });
        }
    });
    </script>
    </div>
    
    <!-- Game Mode Selection -->
    <div id="gameModeSelect">
        <!-- Navigation Bar -->
        <div style="position: absolute; top: 20px; left: 20px; z-index: 10;">
            <a href="https://discord.gg/a6X4W7QbkG" target="_blank" style="color: #4ecdc4; text-decoration: none; font-family: 'Press Start 2P', monospace; font-size: 10px;">ðŸ’¬ Join the Discord Server</a>
        </div>
        <div style="position: absolute; top: 20px; right: 20px; z-index: 10;">
            <a href="/how-to-play.html" style="color: #4ecdc4; text-decoration: none; font-family: 'Press Start 2P', monospace; font-size: 10px; margin-right: 20px;">ðŸ“– How to Play</a>
            <a href="/lore.html" style="color: #4ecdc4; text-decoration: none; font-family: 'Press Start 2P', monospace; font-size: 10px; margin-right: 20px;">ðŸ“œ Lore</a>
            <a href="/leaderboard.html" style="color: #4ecdc4; text-decoration: none; font-family: 'Press Start 2P', monospace; font-size: 10px; margin-right: 20px;">ðŸ† Leaderboard</a>
            <a href="/profile.html" style="color: #4ecdc4; text-decoration: none; font-family: 'Press Start 2P', monospace; font-size: 10px;">ðŸ‘¤ Profile</a>
        </div>
        
        <div id="gameModeContent">
            <h3>Game Setup</h3>
        
        <div class="modeSection">
            <h4>Choose Your Mode</h4>
            <div id="victoryButtons" style="display: flex; justify-content: center; gap: 20px; margin: 30px auto; padding: 0 20px; max-width: 1200px; flex-wrap: nowrap;">
                <div class="mode-box mode-box-classic" style="background: rgba(0, 0, 0, 0.8); border: 3px solid #F828F8; padding: 20px; border-radius: 8px; box-sizing: border-box; width: 280px; height: 240px; display: flex; flex-direction: column;">
                    <button class="btn-classic mode-button" onclick="selectGameMode('classic')" style="width: 100%; height: 45px; padding: 8px; font-size: 9pt; background: #333; border: 2px solid #222; display: flex; align-items: center; justify-content: center; margin-bottom: 15px; flex-shrink: 0;">
                        CLASSIC MODE
                    </button>
                    <p style="color: #F828F8; font-size: 9px; text-align: center; font-family: 'Press Start 2P', monospace; line-height: 14px; text-transform: uppercase; margin: 0; display: flex; align-items: center; justify-content: center; flex-grow: 1;">
                        <span>3 LIVES.<br>
                        PERMADEATH.<br>
                        BATTLE ENEMY SNAKES<br>
                        AND EPIC BOSSES.<br>
                        COMPETE FOR THE<br>
                        GLOBAL LEADERBOARD.<br>
                        HOW LONG CAN YOU<br>
                        SURVIVE THE VOID?</span>
                    </p>
                </div>
                <div class="mode-box mode-box-cozy" style="background: rgba(0, 0, 0, 0.8); border: 3px solid #00D9FF; padding: 20px; border-radius: 8px; box-sizing: border-box; width: 280px; height: 240px; display: flex; flex-direction: column;">
                    <button class="btn-cozy mode-button" onclick="selectGameMode('cozy')" style="width: 100%; height: 45px; padding: 8px; font-size: 9pt; background: #333; border: 2px solid #222; display: flex; align-items: center; justify-content: center; margin-bottom: 15px; flex-shrink: 0;">
                        "COZY" MODE
                    </button>
                    <p style="color: #00D9FF; font-size: 9px; text-align: center; font-family: 'Press Start 2P', monospace; line-height: 14px; text-transform: uppercase; margin: 0; display: flex; align-items: center; justify-content: center; flex-grow: 1;">
                        <span>NO ENEMIES.<br>
                        NO DEATHS.<br>
                        JUST VIBES.<br>
                        DRIFT THROUGH SPACE<br>
                        TO A LOFI<br>
                        SOUNDTRACK.<br>
                        DISCOVER ELEMENTS<br>
                        AT YOUR OWN PACE.</span>
                    </p>
                </div>
            </div>
            <div id="mobileMessage" style="display: none; color: #999; font-size: 10px; text-align: center; font-family: 'Press Start 2P', monospace; margin-top: 20px; padding: 0 20px; line-height: 16px;">
                Infinite Snake was created as a desktop experience.<br>
                Visit on a desktop browser for the full game.
            </div>
        </div>
        </div>
    </div>
    
    <!-- Tutorial Screen -->
    <div id="tutorialScreen" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: transparent; z-index: 55; opacity: 0; transition: opacity 0.3s;">
        <div id="tutorialContent" style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); background: rgba(0, 0, 0, 0.95); border: 3px solid #4ecdc4; border-radius: 10px; padding: 30px; max-width: 1200px; width: 90%; max-height: 90vh; overflow-y: auto;">
            <h2 style="color: #4ecdc4; font-family: 'Press Start 2P', monospace; font-size: 18px; text-align: center; margin-bottom: 30px;">GETTING STARTED</h2>
            
            <div style="display: flex; gap: 40px; align-items: flex-start; flex-wrap: wrap;">
                <!-- Screenshot on the left -->
                <div style="flex: 1; min-width: 300px;">
                    <img id="tutorialScreenshot" src="/screenshots/screenshot-captions.png" alt="Game UI Guide" style="width: 100%; max-width: 600px; border: 2px solid #333; border-radius: 5px; cursor: pointer; transition: transform 0.2s;"
                         onclick="document.getElementById('imageModal').style.display='block'; setTimeout(function(){document.getElementById('imageModal').style.opacity='1';}, 50);"
                         onmouseover="this.style.transform='scale(1.02)';" 
                         onmouseout="this.style.transform='scale(1)';">
                    <p style="color: #888; font-family: 'Press Start 2P', monospace; font-size: 8px; text-align: center; margin-top: 10px; cursor: pointer;"
                       onclick="document.getElementById('imageModal').style.display='block'; setTimeout(function(){document.getElementById('imageModal').style.opacity='1';}, 50);">
                        Click to enlarge
                    </p>
                </div>
                
                <!-- Info column on the right -->
                <div class="info-column" style="flex: 1; min-width: 300px; color: #fff; font-family: 'Press Start 2P', monospace; font-size: 10px; line-height: 18px;">
                    <div style="margin-bottom: 25px;">
                        <h3 style="color: #F828F8; font-size: 12px; margin-bottom: 10px;">CONTROLS</h3>
                        <div style="margin-bottom: 10px;">
                            <span style="color: #7828F8;">DESKTOP:</span><br>
                            â€¢ Mouse or WASD to steer<br>
                            â€¢ Click or W to boost<br>
                            â€¢ P to pause & access menu
                        </div>
                        <div>
                            <span style="color: #00D9FF;">MOBILE:</span><br>
                            â€¢ Virtual joystick to steer<br>
                            â€¢ Tap & hold to boost
                        </div>
                    </div>
                    
                    <div style="margin-bottom: 25px;">
                        <h3 style="color: #F828F8; font-size: 12px; margin-bottom: 10px;">ELEMENT SYSTEM</h3>
                        <p style="margin-bottom: 10px;">
                            â€¢ Elements automatically combine when compatible
                        </p>
                        <p style="margin-bottom: 10px;">
                            â€¢ You turn invincible for 2 seconds after making a new discovery
                        </p>
                        <p>
                            â€¢ If you get stuck without a combo, consume a Void Orb ðŸŒ€ to clear your element bank
                        </p>
                    </div>
                    
                    <div style="margin-bottom: 25px;">
                        <h3 style="color: #F828F8; font-size: 12px; margin-bottom: 10px;">PROGRESSION</h3>
                        <p style="margin-bottom: 10px;">
                            â€¢ Make new discoveries and rebuild the universe!
                        </p>
                        <p style="margin-bottom: 10px;">
                            â€¢ Survive and top the leaderboard in Classic Mode!
                        </p>
                        <p>
                            â€¢ Unlock new skins and lore by playing!
                        </p>
                    </div>
                    
                    <!-- Button row -->
                    <div style="display: flex; gap: 15px; justify-content: center; margin-top: 30px;">
                        <button id="dontShowTutorial" style="padding: 15px 30px; background: #333; border: 3px solid #4ecdc4; color: #4ecdc4; font-family: 'Press Start 2P', monospace; font-size: 10px; cursor: pointer; border-radius: 5px; transition: all 0.3s;" 
                                onmouseover="this.style.background='#4ecdc4'; this.style.color='#000';" 
                                onmouseout="this.style.background='#333'; this.style.color='#4ecdc4';">
                            DON'T SHOW ME THIS AGAIN
                        </button>
                        
                        <button id="continueTutorial" style="padding: 15px 40px; background: #F828F8; border: 3px solid #fff; color: #fff; font-family: 'Press Start 2P', monospace; font-size: 12px; cursor: pointer; border-radius: 5px; transition: all 0.3s; font-weight: bold; text-shadow: 2px 2px 0px rgba(0,0,0,0.5);"
                                onmouseover="this.style.background='#ff4dff'; this.style.transform='scale(1.05)';" 
                                onmouseout="this.style.background='#F828F8'; this.style.transform='scale(1)';">
                            START GAME
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Image Modal for Enlarged View -->
    <div id="imageModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.95); z-index: 60; opacity: 0; transition: opacity 0.3s; cursor: pointer;"
         onclick="if(event.target === this || event.target.tagName === 'P') { this.style.opacity='0'; var modal=this; setTimeout(function(){modal.style.display='none';}, 300); }">
        <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); max-width: 95%; max-height: 95%; display: flex; flex-direction: column; align-items: center;">
            <img src="/screenshots/screenshot-captions.png" alt="Game UI Guide - Enlarged" style="max-width: 100%; max-height: 90vh; border: 3px solid #4ecdc4; border-radius: 5px; cursor: default;" onclick="event.stopPropagation();">
            <p style="color: #4ecdc4; font-family: 'Press Start 2P', monospace; font-size: 10px; margin-top: 20px; text-align: center;">
                Click anywhere to close
            </p>
        </div>
        <!-- Close button -->
        <button style="position: absolute; top: 20px; right: 20px; background: #F828F8; border: 2px solid #fff; color: #fff; font-family: 'Press Start 2P', monospace; font-size: 20px; width: 40px; height: 40px; cursor: pointer; border-radius: 5px; display: flex; align-items: center; justify-content: center; transition: all 0.3s;"
                onclick="var modal=document.getElementById('imageModal'); modal.style.opacity='0'; setTimeout(function(){modal.style.display='none';}, 300);"
                onmouseover="this.style.transform='scale(1.1)';" 
                onmouseout="this.style.transform='scale(1)';">
            Ã—
        </button>
    </div>
    
    <!-- Loading Screen (Mobile Only) -->
    <div id="loadingScreen" style="display: none;">
        <div class="loading-content">
            <div class="loading-stars-bg"></div>
            
            <!-- Logo Section -->
            <div class="loading-logo-section">
                <div class="loading-logo-glow"></div>
                <h1 class="loading-title">INFINITE SNAKE</h1>
                <div class="loading-subtitle">Preparing the Cosmos...</div>
            </div>
            
            <!-- Progress Section -->
            <div class="loading-progress-section">
                <div class="loading-progress-container">
                    <div class="loading-progress-bar">
                        <div class="loading-progress-fill"></div>
                        <div class="loading-progress-glow"></div>
                    </div>
                    <div class="loading-progress-text">0%</div>
                </div>
                <div class="loading-phase-text">Initializing...</div>
            </div>
            
            <!-- Tips Section -->
            <div class="loading-tips-section">
                <div class="loading-tip-container">
                    <div class="loading-tip-icon"></div>
                    <div class="loading-tip-text">Tip: Combine Fire ðŸ”¥ + Water ðŸ’§ to create Steam!</div>
                </div>
            </div>
            
            <!-- Element Preview -->
            <div class="loading-elements-preview">
                <div class="loading-element-orb" data-element="fire">ðŸ”¥</div>
                <div class="loading-element-orb" data-element="water">ðŸ’§</div>
                <div class="loading-element-orb" data-element="earth">ðŸŒ</div>
                <div class="loading-element-orb" data-element="air">ðŸ’¨</div>
            </div>
        </div>
    </div>
    
    <!-- Discovery Sidebar -->
    <div id="discoveryLog">
        <h3>Discoveries (0)</h3>
        <div id="discoveryList"></div>
    </div>
    
    <!-- Game Canvas -->
    <canvas id="gameCanvas" style="background-color: transparent;"></canvas>
    
    <!-- Desktop Score Display -->
    <div id="desktopScore" style="
        position: fixed;
        top: 20px;
        left: 50%;
        transform: translateX(-50%);
        font-family: 'Press Start 2P', monospace;
        font-size: 18px;
        color: var(--snes-gold);
        text-shadow: 
            -1px -1px 0 #4800A8,
            1px -1px 0 #4800A8,
            -1px 1px 0 #4800A8,
            1px 1px 0 #4800A8,
            -2px -2px 0 #4800A8,
            2px -2px 0 #4800A8,
            -2px 2px 0 #4800A8,
            2px 2px 0 #4800A8,
            -3px -3px 0 #4800A8,
            3px -3px 0 #4800A8,
            -3px 3px 0 #4800A8,
            3px 3px 0 #4800A8,
            -3px 0 0 #4800A8,
            3px 0 0 #4800A8,
            0 -3px 0 #4800A8,
            0 3px 0 #4800A8;
        z-index: 1000;
        pointer-events: none;
        text-transform: uppercase;
        letter-spacing: 1px;
        display: none;
    ">SCORE: 0</div>
    
    <!-- UI Overlay -->
    <div id="ui">
        <div id="killstreakDisplay"></div>
        <div id="loreUnlockDisplay"></div>
        <div id="recentDiscovery"></div>
        <div id="bossVictoryMessage"></div>
        <div id="score">Score: 0</div>
        <div id="discoveries">Discoveries: 0</div>
        <div id="elementQueue"></div>
        
        <!-- Discovery Feed (Left Side) -->
        <div class="discovery-feed">
            <div class="discovery-feed-inner" id="discoveryFeed"></div>
        </div>
        
        <!-- Bottom UI Container -->
        <div class="bottom-ui">
            <!-- Element Collection Bar -->
            <div class="element-collection-bar" id="elementBar"></div>
            
            <!-- Boost Bar -->
            <div class="boost-bar-container">
                <div class="boost-bar-frame">
                    <div class="boost-bar-fill" id="boostBarFill" style="width: 100%"></div>
                    <div class="boost-bar-text">BOOST</div>
                </div>
            </div>
        </div>
        
        <!-- Alchemy Vision Timer -->
        <div id="alchemyVisionTimer" class="alchemy-vision-timer" style="display: none;">
            ðŸ”® Alchemy Vision: <span id="alchemyTime">60</span>s
        </div>
        
        <!-- Player Info Box -->
        <div class="player-info-box">
            <div class="player-info-header">
                <div style="display: flex; flex-direction: column; align-items: center;">
                    <div class="player-portrait">
                        <img id="playerPortrait" src="skins/snake-default-green.png" alt="Player snake portrait showing selected skin">
                    </div>
                    <div id="invincibilityText" style="
                        display: none;
                        margin-top: 8px;
                        text-align: center;
                        font-family: 'Press Start 2P', monospace;
                        font-size: 8px;
                        color: #ffffff;
                        text-shadow: 
                            -1px -1px 0 #000,
                            1px -1px 0 #000,
                            -1px 1px 0 #000,
                            1px 1px 0 #000,
                            -2px -2px 0 #FFD700,
                            2px -2px 0 #FFD700,
                            -2px 2px 0 #FFD700,
                            2px 2px 0 #FFD700,
                            -2px 0 0 #FFD700,
                            2px 0 0 #FFD700,
                            0 -2px 0 #FFD700,
                            0 2px 0 #FFD700;
                    ">INVC: 0</div>
                </div>
                <div class="player-stats">
                    <div class="stat-line">
                        <span class="stat-label">Score</span>
                        <span class="stat-value" id="playerScore">0</span>
                    </div>
                    <div class="stat-line">
                        <span class="stat-label">Discoveries</span>
                        <span class="stat-value" id="playerDiscoveries">0</span>
                    </div>
                    <div class="stat-line desktop-only">
                        <span class="stat-label">Best Rank</span>
                        <span class="stat-value" id="playerBestRank">-</span>
                    </div>
                    <div class="stat-line">
                        <span class="stat-label">Kills</span>
                        <span class="stat-value" id="playerKills">0</span>
                    </div>
                    <div class="stat-line">
                        <span class="stat-label">Time</span>
                        <span class="stat-value" id="playerTime">0:00</span>
                    </div>
                </div>
            </div>
            <!-- Desktop Boost Bar in Player Stats -->
            <div class="player-boost-bar-container">
                <div class="player-boost-bar-frame">
                    <div class="player-boost-bar-fill" id="playerBoostBarFill" style="width: 100%"></div>
                    <div class="player-boost-bar-text">BOOST</div>
                </div>
            </div>
        </div>
        
        <!-- Scoreboard Box -->
        <div class="leaderboard-box" id="leaderboardBox">
            <div class="leaderboard-header">
                <span>Scoreboard</span>
                <span class="collapse-icon">â–¼</span>
            </div>
            <div id="leaderboardList"></div>
        </div>
        
        <!-- UI Info (Top Right) -->
        <div id="pauseText" style="position: absolute; top: 20px; right: 20px; text-align: right; font-size: 14px; color: rgba(255, 255, 255, 0.4); pointer-events: none;">
            <div style="margin-bottom: 5px;" class="desktop-only">Press P for Pause Menu</div>
            <div style="margin-bottom: 5px;" class="desktop-only" id="muteText">M to Mute</div>
        </div>
    </div>
    
    <!-- Game Hint -->
    <div id="gameHint"></div>
    
    <!-- Mobile Controls -->
    <div class="mobile-controls">
        <div class="virtual-joystick" id="virtualJoystick" style="left: 80px; right: auto;">
            <div class="joystick-base">
                <div class="joystick-knob" id="joystickKnob"></div>
            </div>
        </div>
        <div class="mobile-boost-button" id="mobileBoostButton">
            <div class="boost-button-text">BOOST</div>
        </div>
        <div class="pause-button-mobile" id="pauseButtonMobile" onclick="togglePause()">â¸</div>
        <div class="mute-button-mobile" id="muteButtonMobile" onclick="toggleMusic()">ðŸ”‡</div>
    </div>
    
    <!-- Victory Overlay -->
    <div id="victoryOverlay" style="display: none;">
        <div id="victoryPopup">
            <div class="victory-glow"></div>
            <h1 class="victory-title">ðŸ† Victory! ðŸ†</h1>
            <div class="victory-lore" id="victoryLore"></div>
            <div class="victory-stats">
                <div class="stat-item">
                    <span class="stat-label">Final Score</span>
                    <span class="stat-value" id="victoryScore">0</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">Elements Discovered</span>
                    <span class="stat-value" id="victoryDiscoveries">0</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">Time to Complete</span>
                    <span class="stat-value" id="victoryTime">0:00</span>
                </div>
            </div>
            <button class="victory-button" onclick="location.reload()">Play Again</button>
        </div>
    </div>
    
    <!-- Respawn Overlay -->
    <div id="respawnOverlay" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.7); z-index: 60; pointer-events: auto;">
        <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);  pointer-events: auto;">
            <div style="background: linear-gradient(135deg, rgba(20, 20, 40, 0.95) 0%, rgba(30, 30, 50, 0.9) 100%); 
                        border: 2px solid rgba(255, 68, 68, 0.5); 
                        border-radius: 15px; 
                        padding: 30px 40px;
                        box-shadow: 0 0 30px rgba(255, 68, 68, 0.3);
                        pointer-events: auto;">
                <h2 id="deathMessage" style="color: #ff4444; margin: 0 0 20px 0; font-size: 32px; text-shadow: 0 0 10px rgba(255, 68, 68, 0.5); text-align: center;">Your Form Dissolves Into The Void!</h2>
                
                <!-- Stats Summary - Two Column Layout -->
                <div style="margin-bottom: 25px; display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                    <!-- This Game Column -->
                    <div>
                        <div style="color: #4ecdc4; font-size: 18px; margin-bottom: 10px; ">THIS GAME</div>
                        <div style="background: rgba(0, 0, 0, 0.3); padding: 15px; border-radius: 8px;">
                            <div style="margin-bottom: 10px;">
                                <div style="color: #AAA; font-size: 14px;">Score</div>
                                <div id="respawnScore" style="color: #4ecdc4; font-size: 24px; font-weight: bold;">0</div>
                            </div>
                            <div style="margin-bottom: 10px;">
                                <div style="color: #AAA; font-size: 14px;">Discoveries</div>
                                <div id="respawnDiscoveries" style="color: #FFD700; font-size: 24px; font-weight: bold;">0</div>
                            </div>
                            <div>
                                <div style="color: #AAA; font-size: 14px;">Kills</div>
                                <div id="respawnKills" style="color: #ff6b6b; font-size: 24px; font-weight: bold;">0</div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- All Time Best Column -->
                    <div>
                        <div style="color: #9c88ff; font-size: 18px; margin-bottom: 10px; ">ALL TIME BEST</div>
                        <div style="background: rgba(0, 0, 0, 0.3); padding: 15px; border-radius: 8px;">
                            <div style="margin-bottom: 10px;">
                                <div style="color: #AAA; font-size: 14px;">Score</div>
                                <div id="bestScore" style="color: #4ecdc4; font-size: 24px; font-weight: bold;">0</div>
                            </div>
                            <div style="margin-bottom: 10px;">
                                <div style="color: #AAA; font-size: 14px;">Discoveries</div>
                                <div id="bestDiscoveries" style="color: #FFD700; font-size: 24px; font-weight: bold;">0</div>
                            </div>
                            <div>
                                <div style="color: #AAA; font-size: 14px;">Kills</div>
                                <div id="bestKills" style="color: #ff6b6b; font-size: 24px; font-weight: bold;">0</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Global Rank Display -->
                <div id="globalRankContainer" style="margin-bottom: 20px;  display: none;">
                    <div style="color: #AAA; font-size: 14px;">Today's Global Rank</div>
                    <div id="globalRank" style="color: #9c88ff; font-size: 28px; font-weight: bold;">#--</div>
                </div>
                
                <!-- Action Buttons -->
                <div style="display: flex; gap: 15px; justify-content: center; margin-top: 25px;">
                    <button id="reviveBtn" onclick="handleReviveOrRespawn()" 
                            style="background: var(--snes-cosmic-purple); 
                                   color: var(--snes-white); 
                                   border: 4px solid var(--snes-white); 
                                   padding: 12px 25px; 
                                   font-size: 10px; 
                                   font-family: 'Press Start 2P';
                                   cursor: pointer;
                                   border-radius: 0;
                                   font-weight: normal;
                                   text-transform: uppercase;
                                   transition: none;
                                   box-shadow: inset 2px 2px 0 var(--snes-cosmic-pink), inset -2px -2px 0 var(--snes-dark-purple), 4px 4px 0 rgba(0,0,0,0.5);"
                            onmouseover="this.style.background='var(--snes-cosmic-pink)'; this.style.transform='translate(2px, 2px)'; this.style.boxShadow='inset 2px 2px 0 #FFA8FF, inset -2px -2px 0 var(--snes-dark-purple), 2px 2px 0 rgba(0,0,0,0.5)';"
                            onmouseout="this.style.background='var(--snes-cosmic-purple)'; this.style.transform='translate(0, 0)'; this.style.boxShadow='inset 2px 2px 0 var(--snes-cosmic-pink), inset -2px -2px 0 var(--snes-dark-purple), 4px 4px 0 rgba(0,0,0,0.5)';"
                            onclick="this.style.transform='translate(4px, 4px)'; this.style.boxShadow='none'; handleReviveOrRespawn();">
                        REVIVE (<span id="revivesLeft">3</span>)
                    </button>
                    <button id="newGameBtn" onclick="returnToMainMenu()" 
                            style="background: #333; 
                                   color: #fff; 
                                   border: 4px solid #666; 
                                   padding: 12px 25px; 
                                   font-size: 10px; 
                                   font-family: 'Press Start 2P';
                                   cursor: pointer;
                                   border-radius: 0;
                                   text-transform: uppercase;
                                   transition: none;
                                   box-shadow: 4px 4px 0 rgba(0,0,0,0.5);"
                            onmouseover="this.style.transform='translate(2px, 2px)'; this.style.boxShadow='2px 2px 0 rgba(0,0,0,0.5)';"
                            onmouseout="this.style.transform='translate(0, 0)'; this.style.boxShadow='4px 4px 0 rgba(0,0,0,0.5)';">
                        MAIN MENU
                    </button>
                </div>
                
                
                <div id="respawnPenaltyText" style="margin-top: 8px; font-size: 12px; color: #ff9999;  display: none;">
                    <!-- No penalty on respawn anymore -->
                </div>
            </div>
        </div>
    </div>
    
    <!-- Pause Overlay -->
    <div id="pauseOverlay">
        <div id="pauseMenu">
            <h2 style="text-align: center;">Game Paused</h2>
            <p style="color: #AAA; font-size: 14px; margin: 10px 0; text-align: center;">High Score: <span style="color: #FFD700;" id="highScoreDisplay">0</span></p>
            
            <!-- Tab Navigation -->
            <div class="tab-navigation">
                <button class="tab-button active" onclick="switchTab('skins')">Skins</button>
                <button class="tab-button" onclick="switchTab('journal')">Discovery Journal</button>
                <button class="tab-button" onclick="switchTab('howto')">How to Play</button>
                <button class="tab-button" onclick="switchTab('leaderboard')">Leaderboard</button>
            </div>
            
            <!-- Skins Tab -->
            <div id="skinsTab" class="tab-content active">
                <div id="skinSelection">
                    <div id="availableUnlocks" style="text-align: center;">Available Unlocks: 0</div>
                    
                    <!-- Rarity Tabs -->
                    <div class="rarity-tabs" style="text-align: center;">
                        <button class="rarity-tab common active" data-rarity="common">Common</button>
                        <button class="rarity-tab uncommon" data-rarity="uncommon">Uncommon</button>
                        <button class="rarity-tab rare" data-rarity="rare">Rare</button>
                        <button class="rarity-tab legendary" data-rarity="legendary">Legendary</button>
                        <button class="rarity-tab exotic" data-rarity="exotic">Exotic</button>
                        <button class="rarity-tab secret" data-rarity="secret">Secret</button>
                    </div>
                    
                    <!-- Skin Grid Container -->
                    <div id="skinGrid"></div>
                </div>
            </div>
            
            <!-- Discovery Journal Tab -->
            <div id="journalTab" class="tab-content">
                <div id="discoveryJournal">
                    <h4 style="color: #FFD700; margin-bottom: 10px; text-align: center;">Discovery Journal</h4>
                    <p id="discoveryCount" style="color: #4ecdc4; margin-bottom: 10px; text-align: center;">Loading discoveries...</p>
                    <div class="discovery-grid" id="discoveryGrid">
                        <!-- Discoveries will be populated here -->
                    </div>
                </div>
            </div>
            
            <!-- How to Play Tab -->
            <div id="howtoTab" class="tab-content">
                <div style="padding: 20px; max-height: 400px; overflow-y: auto;">
                    <h4 style="color: #FFD700; margin-bottom: 15px; text-align: center;">How to Play Infinite Snake</h4>
                    
                    <div style="color: #ddd; font-size: 14px; line-height: 1.6;">
                        <div style="margin-bottom: 15px;">
                            <h5 style="color: #4ecdc4; margin-bottom: 5px;">ðŸŽ® Controls</h5>
                            <p><strong>Desktop:</strong> Mouse to steer OR WASD keys</p>
                            <p><strong>WASD:</strong> A/D to turn, W to boost</p>
                            <p><strong>Mobile:</strong> Virtual joystick to steer</p>
                            <p><strong>Boost:</strong> Click or W (Desktop)</p>
                            <p><strong>Keyboard:</strong> P to pause, M to mute/unmute</p>
                        </div>
                        
                        <!-- Game Interface Screenshot -->
                        <div style="text-align: center; margin-bottom: 20px; padding: 15px; background: rgba(120, 40, 248, 0.1); border: 2px solid #7828F8; border-radius: 0;">
                            <img src="/screenshots/screenshot-captions.png" 
                                 alt="Infinite Snake Game Interface with UI element callouts" 
                                 onclick="openPauseImageModal(this.src)"
                                 style="
                                    width: 96%;
                                    max-width: 720px;
                                    height: auto;
                                    border: 3px solid #7828F8;
                                    box-shadow: 
                                        0 0 0 2px #F828F8,
                                        0 0 15px rgba(120, 40, 248, 0.5),
                                        4px 4px 0 rgba(0,0,0,0.5);
                                    image-rendering: auto;
                                    cursor: pointer;
                                    transition: transform 0.2s;
                                "
                                onmouseover="this.style.transform='scale(1.02)'"
                                onmouseout="this.style.transform='scale(1)'">
                            <p style="margin-top: 10px; color: #A8A8A8; font-size: 10px; text-transform: uppercase; font-family: 'Press Start 2P';">
                                Labeled UI Elements â€¢ Click to enlarge
                            </p>
                        </div>
                        
                        <div style="margin-bottom: 15px;">
                            <h5 style="color: #4ecdc4; margin-bottom: 5px;">ðŸŽ¯ Goal</h5>
                            <p>Grow your snake by collecting elements and discovering new combinations! Climb the global leaderboard in Classic Mode, unlock new snake skins, build your Discovery Journal, and compete in Weekly, Monthly, and All-Time rankings.</p>
                        </div>
                        
                        <div style="margin-bottom: 15px;">
                            <h5 style="color: #4ecdc4; margin-bottom: 5px;">ðŸ”¬ Element System</h5>
                            <p>â€¢ Collect basic elements: Earth ðŸŒ, Air ðŸ’¨, Fire ðŸ”¥, Water ðŸ’§</p>
                            <p>â€¢ Your snake can hold up to 6 elements</p>
                            <p>â€¢ Elements automatically combine when compatible!</p>
                            <p>â€¢ Example: Fire + Water = Steam â˜ï¸</p>
                            <p>â€¢ <strong>Over 10,000 elements</strong> available today!</p>
                            <p>â€¢ New elements and combinations added regularly!</p>
                        </div>
                        
                        <div style="margin-bottom: 15px;">
                            <h5 style="color: #4ecdc4; margin-bottom: 5px;">ðŸ“– Discovery Journal</h5>
                            <p>â€¢ Build your collection of discovered elements</p>
                            <p>â€¢ Your discoveries persist between sessions</p>
                            <p>â€¢ Track your progress and unlock achievements</p>
                            <p>â€¢ Compare your collection with other players</p>
                            <p>â€¢ Access from the pause menu</p>
                        </div>
                        
                        <div style="margin-bottom: 15px;">
                            <h5 style="color: #4ecdc4; margin-bottom: 5px;">âœ¨ Power-ups</h5>
                            <p><strong>ðŸŒ€ Void Orb:</strong> Clears element inventory and converts to points. May produce a random element!</p>
                            <p><strong>ðŸ’Ž Catalyst Gem:</strong> Summons 2 random elements not in the current spawn pool</p>
                        </div>
                        
                        <div style="margin-bottom: 15px;">
                            <h5 style="color: #4ecdc4; margin-bottom: 5px;">âš”ï¸ Combat</h5>
                            <p>â€¢ Collide head-on with smaller snakes to eliminate them</p>
                            <p>â€¢ Collect their dropped elements for points</p>
                            <p>â€¢ Avoid head-on collisions with larger snakes!</p>
                            <p>â€¢ Use boost strategically to escape or attack</p>
                        </div>
                        
                        <div style="margin-bottom: 15px;">
                            <h5 style="color: #4ecdc4; margin-bottom: 5px;">ðŸ† Game Modes</h5>
                            <p><strong>ðŸ† Classic Mode:</strong> Competitive survival with 3 lives</p>
                            <p>â€¢ Survive as long as possible to achieve high scores</p>
                            <p>â€¢ Game ends permanently on 4th death (permadeath)</p>
                            <p>â€¢ Scores submitted to leaderboard only on permadeath</p>
                            <p>â€¢ Defeat bosses to earn extra lives (up to 3 max)</p>
                            <p><strong>ðŸŒ™ "Cozy" Mode:</strong> Peaceful exploration</p>
                            <p>â€¢ No enemy snakes - just you</p>
                            <p>â€¢ Unlimited respawns with no penalties</p>
                            <p>â€¢ Relaxing lofi soundtrack</p>
                            <p>â€¢ Perfect for stress-free discovery</p>
                        </div>
                        
                        <div style="margin-bottom: 15px;">
                            <h5 style="color: #4ecdc4; margin-bottom: 5px;">ðŸ‘¹ Boss Encounters</h5>
                            <p>â€¢ Ancient beings known as Deep Old Ones emerge from the void</p>
                            <p>â€¢ Each has unique attack patterns</p>
                            <p>â€¢ Defeat them to unlock exclusive snake skins</p>
                            <p>â€¢ Earn rare elements and special buffs</p>
                        </div>
                        
                        <div style="margin-bottom: 15px;">
                            <h5 style="color: #4ecdc4; margin-bottom: 5px;">ðŸ“œ Lore Unlocks</h5>
                            <p>â€¢ Defeat bosses to uncover their backstories</p>
                            <p>â€¢ Reach score milestones to unlock world lore</p>
                            <p>â€¢ Discover rare elements to reveal secrets</p>
                            <p>â€¢ Track your lore discovery progress</p>
                            <p>â€¢ Visit <a href="/lore" style="color: #FFD700;">infinitesnake.io/lore</a> for full library</p>
                        </div>
                        
                        <div style="margin-bottom: 15px;">
                            <h5 style="color: #4ecdc4; margin-bottom: 5px;">ðŸ’¡ Tips</h5>
                            <p>â€¢ Use boost strategically - it drains stamina!</p>
                            <p>â€¢ Experiment with different element combinations</p>
                            <p>â€¢ Stay away from the map borders!</p>
                            <p>â€¢ Check back regularly for new elements</p>
                            <p>â€¢ Plan your element combinations for max points</p>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Leaderboard Tab -->
            <div id="leaderboardTab" class="tab-content">
                <div style="padding: 20px; max-height: 400px; overflow-y: auto;">
                    <h4 style="color: #4ecdc4; margin-bottom: 15px; text-align: center;">Classic Mode Leaderboard</h4>
                    
                    <!-- Mini leaderboard tabs -->
                    <div style="display: flex; margin-bottom: 15px; border-bottom: 2px solid #333; justify-content: center;">
                        <button class="mini-lb-tab active" onclick="loadPauseLeaderboard(event, 'weekly')" 
                                style="flex: 1; padding: 10px; background: transparent; border: none; 
                                       color: #4ecdc4; font-size: 14px; cursor: pointer; font-family: monospace;">
                            Weekly
                        </button>
                        <button class="mini-lb-tab" onclick="loadPauseLeaderboard(event, 'monthly')" 
                                style="flex: 1; padding: 10px; background: transparent; border: none; 
                                       color: #888; font-size: 14px; cursor: pointer; font-family: monospace;">
                            Monthly
                        </button>
                        <button class="mini-lb-tab" onclick="loadPauseLeaderboard(event, 'all')" 
                                style="flex: 1; padding: 10px; background: transparent; border: none; 
                                       color: #888; font-size: 14px; cursor: pointer; font-family: monospace;">
                            All Time
                        </button>
                    </div>
                    
                    <!-- Leaderboard entries -->
                    <div id="pauseLeaderboardEntries" style="font-family: 'Press Start 2P', monospace;">
                        <div style="color: #888; padding: 20px; font-size: 8px;">Loading...</div>
                    </div>
                </div>
            </div>
            
            <!-- Resume and Main Menu buttons - moved inside pauseMenu -->
            <div style="margin-top: 20px; padding-top: 20px; border-top: 1px solid rgba(138, 43, 226, 0.3); text-align: center;">
                <button onclick="resumeGame()" style="margin: 10px; padding: 12px 30px; font-size: 10px; background: var(--snes-cosmic-purple); color: var(--snes-white); border: 4px solid var(--snes-white); border-radius: 0; cursor: pointer; font-family: 'Press Start 2P'; text-transform: uppercase; box-shadow: inset 2px 2px 0 var(--snes-cosmic-pink), inset -2px -2px 0 var(--snes-dark-purple), 4px 4px 0 rgba(0,0,0,0.5); transition: none;"
                        onmouseover="this.style.background='var(--snes-cosmic-pink)'; this.style.transform='translate(2px, 2px)'; this.style.boxShadow='inset 2px 2px 0 #FFA8FF, inset -2px -2px 0 var(--snes-dark-purple), 2px 2px 0 rgba(0,0,0,0.5)';"
                        onmouseout="this.style.background='var(--snes-cosmic-purple)'; this.style.transform='translate(0, 0)'; this.style.boxShadow='inset 2px 2px 0 var(--snes-cosmic-pink), inset -2px -2px 0 var(--snes-dark-purple), 4px 4px 0 rgba(0,0,0,0.5)';">Resume</button>
                <button onclick="playUISound(); handleMainMenuClick();" style="margin: 10px; padding: 12px 30px; font-size: 10px; background: #333; color: var(--snes-white); border: 4px solid #666; border-radius: 0; cursor: pointer; font-family: 'Press Start 2P'; text-transform: uppercase; box-shadow: 4px 4px 0 rgba(0,0,0,0.5); transition: none;"
                        onmouseover="this.style.transform='translate(2px, 2px)'; this.style.boxShadow='2px 2px 0 rgba(0,0,0,0.5)';"
                        onmouseout="this.style.transform='translate(0, 0)'; this.style.boxShadow='4px 4px 0 rgba(0,0,0,0.5)';">Main Menu</button>
            </div>
        </div>
    </div>
    
    <!-- Skin Preview Modal -->
    <div id="skinPreviewModal" class="skin-preview-modal" style="display: none;">
        <div class="modal-content">
            <button class="modal-close">&times;</button>
            <div class="preview-container">
                <canvas id="skinPreviewCanvas" width="300" height="300"></canvas>
                <div class="preview-info">
                    <h2 id="previewSkinName">Skin Name</h2>
                    <div class="rarity-badge" id="previewRarity">
                        <span class="rarity-stars"></span>
                        <span class="rarity-text">Common</span>
                    </div>
                    <p id="previewBio" class="skin-bio">Skin description goes here...</p>
                    <div class="unlock-criteria" id="previewUnlockCriteria">
                        <h3>How to Unlock:</h3>
                        <p id="unlockText">Complete specific challenge</p>
                        <div class="progress-bar">
                            <div class="progress-fill" id="unlockProgress"></div>
                        </div>
                        <p class="progress-text" id="progressText">0/100</p>
                    </div>
                    <button id="equipButton" class="equip-button">Equip</button>
                    <button id="unlockButton" class="unlock-button" style="display: none;">Unlock (1 Token)</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Welcome Modal -->
    <div id="welcomeModal" class="welcome-modal" style="display: none;">
        <div class="welcome-modal-overlay"></div>
        <div class="welcome-modal-content">
            <button class="welcome-modal-close">&times;</button>
            <h2>Welcome to <span class="title-green">Infinite Snake</span> - <span class="title-yellow">Preview</span>!</h2>
            <div class="welcome-message">
                <p>Thanks for checking out this early preview! This is a work in progress, so you may encounter bugs, unexpected element combos, or other quirks. I'm updating the game daily to improve the experience and to add more fun stuff.</p>
                <p>If you run into any issues or have feedback, feel free to join the community <a href="https://discord.gg/a6X4W7QbkG" target="_blank" class="link-blue">Discord</a> or email me directly at <a href="mailto:jason@infinitesnake.io" class="link-blue">jason@infinitesnake.io</a></p>
                <p>Thanks for playing and enjoy the game!</p>
                <p class="signature">- Jason</p>
            </div>
        </div>
    </div>
    
    <!-- Unlock Notification Container -->
    <div id="unlockNotificationContainer" class="unlock-notification-container"></div>
    
    <!-- Leaderboard Modal -->
    <div id="leaderboardModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.8); z-index: 100;">
        <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); 
                    width: 90%; max-width: 800px; max-height: 90vh; 
                    background: linear-gradient(135deg, rgba(20, 20, 40, 0.98) 0%, rgba(30, 30, 50, 0.95) 100%);
                    border: 3px solid #4ecdc4;
                    box-shadow: 0 0 20px rgba(78, 205, 196, 0.5);
                    overflow: hidden;
                    image-rendering: pixelated;">
            
            <!-- Header -->
            <div style="background: rgba(0, 0, 0, 0.5); padding: 20px; border-bottom: 2px solid #4ecdc4;">
                <h2 style="color: #4ecdc4; margin: 0; font-family: monospace; font-size: 28px; ">
                    CLASSIC MODE LEADERBOARD
                </h2>
                <button onclick="closeLeaderboard()" 
                        style="position: absolute; top: 15px; right: 15px; 
                               background: transparent; border: 2px solid #ff4444; 
                               color: #ff4444; width: 40px; height: 40px; 
                               font-size: 20px; cursor: pointer; font-family: monospace;">
                    X
                </button>
            </div>
            
            <!-- Time Period Tabs -->
            <div style="display: flex; background: rgba(0, 0, 0, 0.3); border-bottom: 2px solid #333;">
                <button class="leaderboard-tab active" onclick="switchLeaderboardPeriod('daily')" 
                        style="flex: 1; padding: 15px; background: transparent; border: none; 
                               color: #4ecdc4; font-size: 16px; cursor: pointer; 
                               font-family: monospace; border-right: 2px solid #333;">
                    DAILY
                </button>
                <button class="leaderboard-tab" onclick="switchLeaderboardPeriod('weekly')" 
                        style="flex: 1; padding: 15px; background: transparent; border: none; 
                               color: #888; font-size: 16px; cursor: pointer; 
                               font-family: monospace; border-right: 2px solid #333;">
                    WEEKLY
                </button>
                <button class="leaderboard-tab" onclick="switchLeaderboardPeriod('monthly')" 
                        style="flex: 1; padding: 15px; background: transparent; border: none; 
                               color: #888; font-size: 16px; cursor: pointer; 
                               font-family: monospace; border-right: 2px solid #333;">
                    MONTHLY
                </button>
                <button class="leaderboard-tab" onclick="switchLeaderboardPeriod('all')" 
                        style="flex: 1; padding: 15px; background: transparent; border: none; 
                               color: #888; font-size: 16px; cursor: pointer; 
                               font-family: monospace;">
                    ALL TIME
                </button>
            </div>
            
            <!-- Reset Time Indicator -->
            <div style="padding: 10px 20px; background: rgba(0, 0, 0, 0.3); border-bottom: 1px solid #333;">
                <p style="margin: 0; color: #888; font-size: 12px; font-family: monospace; text-align: center;">
                    Scores reset daily at midnight UTC (7/8 PM ET)
                </p>
            </div>
            
            <!-- Leaderboard Content -->
            <div id="leaderboardContent" style="padding: 20px; overflow-y: auto; max-height: calc(90vh - 220px);">
                <!-- Table Header -->
                <div style="display: grid; grid-template-columns: 80px 80px 200px 150px 120px 120px 100px; 
                            gap: 10px; padding: 8px 12px; background: rgba(0, 0, 0, 0.5); 
                            border: 2px solid #555; margin-bottom: 10px; font-family: monospace;
                            font-weight: bold; color: #AAA; font-size: 12px; align-items: center;">
                    <div>RANK</div>
                    <div>COUNTRY</div>
                    <div>NAME</div>
                    <div style="text-align: right;">SCORE</div>
                    <div style="text-align: right;">ELEMENTS</div>
                    <div style="text-align: right;">TIME</div>
                    <div style="text-align: right;">KILLS</div>
                </div>
                
                <!-- Leaderboard Entries -->
                <div id="leaderboardEntries">
                    <div style="color: #888;  padding: 40px; font-family: monospace;">
                        Loading leaderboard...
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <style>
        .leaderboard-tab.active {
            color: #4ecdc4 !important;
            border-bottom: 2px solid #4ecdc4 !important;
        }
        
        .leaderboard-entry {
            display: grid;
            grid-template-columns: 80px 80px 200px 150px 120px 120px 100px;
            gap: 10px;
            padding: 6px 10px;
            margin-bottom: 2px;
            background: rgba(0, 0, 0, 0.3);
            border: 2px solid transparent;
            font-family: 'Press Start 2P', monospace;
            font-size: 12px;
            transition: all 0.2s;
            align-items: center;
        }
        
        .leaderboard-entry:hover {
            background: rgba(78, 205, 196, 0.1);
            border-color: rgba(78, 205, 196, 0.3);
        }
        
        .leaderboard-entry.player-entry {
            background: rgba(78, 205, 196, 0.2);
            border-color: #4ecdc4;
            animation: pixelPulse 2s steps(2) infinite;
        }
        
        .rank-1 { color: #FFD700; font-size: 16px !important; }
        .rank-2 { color: #C0C0C0; font-size: 16px !important; }
        .rank-3 { color: #CD7F32; font-size: 16px !important; }
        
        /* ===== PROFESSIONAL MOBILE UI ENHANCEMENTS ===== */
        /* ===== MOBILE DETECTION & BASE SETUP ===== */
        @media (max-width: 1024px), (pointer: coarse) {
            /* Hide player portrait on mobile as per mockup */
            .player-portrait {
                display: none !important;
            }
            
            /* Adjust player info box for mobile without portrait */
            body.mobile .player-info-box {
                width: 200px !important;
                padding: 6px !important;
            }
            
            body.mobile .player-stats {
                margin-left: 0 !important;
                gap: 2px !important; /* Increased gap for better readability */
                padding: 4px !important; /* Add padding to prevent content cutoff */
            }
            
            /* Ensure joystick and boost are same size */
            .virtual-joystick {
                width: 120px !important;
                height: 120px !important;
            }
        }

        /* ===== LANDSCAPE ORIENTATION (iPad Mini and larger tablets) ===== */
        @media screen and (orientation: landscape) and (max-width: 1024px) {
            /* Player Card - Top Left */
            body.mobile .player-info-box {
                position: fixed !important;
                top: var(--mobile-scorecard-top) !important;
                left: var(--mobile-scorecard-left) !important;
                bottom: var(--mobile-scorecard-bottom) !important;
                right: var(--mobile-scorecard-right) !important;
                width: 200px;
            }
            
            /* Scoreboard - Top Right */
            body.mobile .leaderboard-box {
                position: fixed !important;
                top: var(--mobile-leaderboard-top) !important;
                right: var(--mobile-leaderboard-right) !important;
                bottom: var(--mobile-leaderboard-bottom) !important;
                left: var(--mobile-leaderboard-left) !important;
                width: 240px;
            }
            
            /* Discovery Feed - Left Middle - Smaller and translucent */
            body.mobile .discovery-feed {
                left: 20px;
                top: 50%;
                transform: translateY(-50%) scale(var(--mobile-discovery-scale));
                bottom: auto;
                width: 200px;
                max-height: 30vh;
                opacity: var(--mobile-discovery-opacity);
                backdrop-filter: blur(5px);
            }
            
            /* Boost Bar & Element Bank - Top Center (compact) */
            body.mobile .bottom-ui {
                top: 5px;
                bottom: auto;
                padding: 5px 15px;
                left: 220px; /* Clear player card */
                right: 250px; /* Clear leaderboard */
                width: auto;
            }
            
            /* Compact boost bar for landscape */
            body.mobile .boost-bar-container {
                height: var(--mobile-boost-bar-height);
                margin-bottom: 5px;
            }
            
            body.mobile .boost-bar-frame {
                height: var(--mobile-boost-bar-height);
            }
            
            /* Joystick - Bottom Left Corner */
            body.mobile .virtual-joystick {
                bottom: 120px !important;
                left: 80px !important;
                right: auto !important;
                width: 105px !important;
                height: 105px !important;
            }
            
            
            /* Pause & Mute - Bottom center - OVERRIDE DEFAULT POSITIONS */
            body.mobile .pause-button-mobile {
                position: fixed !important;
                bottom: 20px !important;
                top: auto !important;
                left: 50% !important;
                right: auto !important;
                transform: translateX(-60px) !important; /* Offset left from center */
            }
            
            body.mobile .mute-button-mobile {
                position: fixed !important;
                bottom: 20px !important;
                top: auto !important;
                left: 50% !important;
                right: auto !important;
                transform: translateX(10px) !important; /* Offset right from center */
            }
            
            /* Show buttons during gameplay for mobile */
            body.mobile.game-active .pause-button-mobile,
            body.mobile.game-active .mute-button-mobile {
                display: flex !important;
            }
            
            /* Pop-up messages area - Bottom of screen */
            body.mobile #recentDiscovery {
                bottom: 20% !important; /* Bottom 20% of screen */
                left: 50% !important;
                transform: translateX(-50%) !important;
            }
        }

        /* ===== PORTRAIT ORIENTATION ===== */
        @media (orientation: portrait) and (max-width: 1024px) {
            /* Player Card - Top Left */
            body.mobile .player-info-box {
                position: fixed !important;
                top: 60px !important;
                left: 10px !important;
                bottom: unset !important;
                right: auto !important;
                width: 170px; /* Slightly increased width */
                font-size: 7px;
                min-height: auto; /* Ensure height adjusts to content */
            }
            
            /* Scoreboard - Top Right */
            body.mobile .leaderboard-box {
                position: fixed !important;
                top: 60px !important;
                right: 10px !important;
                left: auto !important;
                bottom: unset !important;
                width: 180px;
                font-size: 9px;
            }
            
            /* Discovery Feed - Left side, smaller and translucent */
            body.mobile .discovery-feed {
                left: 10px;
                top: 180px;
                transform: scale(var(--mobile-discovery-scale));
                transform-origin: top left;
                bottom: auto;
                width: 180px;
                max-height: 25vh;
                opacity: var(--mobile-discovery-opacity);
                backdrop-filter: blur(5px);
                /* Mobile gradient - lighter for better visibility */
                background: linear-gradient(
                    to right,
                    rgba(0, 0, 0, 0.4) 0%,
                    rgba(0, 0, 0, 0.2) 70%,
                    rgba(0, 0, 0, 0) 100%
                );
                backdrop-filter: blur(3px); /* Lighter blur on mobile */
            }
            
            /* Add top fade mask for mobile discovery feed */
            body.mobile .discovery-feed-inner {
                mask-image: linear-gradient(
                    to bottom,
                    transparent 0%,
                    black 15%,
                    black 85%,
                    transparent 100%
                );
                -webkit-mask-image: linear-gradient(
                    to bottom,
                    transparent 0%,
                    black 15%,
                    black 85%,
                    transparent 100%
                );
            }
            
            /* Disable hover effects on mobile */
            body.mobile .discovery-message:hover {
                transform: none;
                background: linear-gradient(
                    135deg,
                    var(--snes-dark-blue) 0%,
                    rgba(16, 32, 64, 0.95) 50%,
                    rgba(16, 32, 64, 0.85) 100%
                );
            }
            
            /* Boost Bar & Element Bank - Top */
            body.mobile .bottom-ui {
                top: 0;
                bottom: auto;
                padding: 5px 10px;
            }
            
            /* Compact boost bar for portrait */
            body.mobile .boost-bar-container {
                height: var(--mobile-boost-bar-height);
                margin-bottom: 5px;
            }
            
            body.mobile .boost-bar-frame {
                height: var(--mobile-boost-bar-height);
            }
            
            body.mobile .element-collection-bar {
                justify-content: center !important;
                margin: 0 auto !important;
            }
            
            /* Joystick - Bottom Left */
            body.mobile .virtual-joystick {
                bottom: 120px !important;
                left: 80px !important;
                right: auto !important;
            }
            
            
            /* Pause & Mute - Bottom center */
            body.mobile .pause-button-mobile,
            body.mobile .mute-button-mobile {
                bottom: 20px !important;
                top: auto !important;
                left: 50% !important;
                right: auto !important;
            }
            
            body.mobile .pause-button-mobile {
                transform: translateX(-80px) !important; /* Offset left from center */
            }
            
            body.mobile .mute-button-mobile {
                transform: translateX(20px) !important; /* Offset right from center */
            }
            
            /* Show buttons during gameplay for mobile portrait */
            body.mobile.game-active .pause-button-mobile,
            body.mobile.game-active .mute-button-mobile {
                display: flex !important;
            }
            
            /* Pop-up messages - Bottom of screen */
            body.mobile #recentDiscovery {
                bottom: 25% !important; /* Bottom 25% of screen */
                left: 50% !important;
                top: auto !important;
                transform: translateX(-50%) !important;
            }
            
            /* Smaller stat text for portrait */
            body.mobile .stat-label {
                font-size: 7px !important;
            }
            
            body.mobile .stat-value {
                font-size: 8px !important;
            }
            
            body.mobile .leaderboard-entry {
                font-size: 8px !important;
                padding: 3px 5px !important;
                min-height: 22px !important;
                font-family: 'Press Start 2P', monospace !important;
            }
        }

        /* ===== MOBILE FONT SIZE REDUCTIONS ===== */
        /* Ensure mobile body fills viewport */
        body.mobile {
            margin: 0 !important;
            padding: 0 !important;
            width: 100vw !important;
            height: 100vh !important;
            overflow: hidden !important;
            background-color: transparent !important;
        }
        
        /* Force canvas to fill viewport on mobile */
        body.mobile #gameCanvas {
            width: 100vw !important;
            height: 100vh !important;
            position: fixed !important;
            top: 0 !important;
            left: 0 !important;
            background-color: transparent !important;
        }
        
        /* ===== ENHANCED MOBILE CONTROLS ===== */
        .virtual-joystick {
            background: rgba(0, 0, 0, var(--mobile-joystick-opacity));
            border: 3px solid rgba(78, 205, 196, 0.4);
            backdrop-filter: blur(5px);
        }

        .joystick-base {
            background: radial-gradient(circle, rgba(78, 205, 196, 0.15) 0%, transparent 70%);
        }

        .joystick-knob {
            background: radial-gradient(circle, rgba(78, 205, 196, 0.6) 0%, rgba(42, 117, 113, 0.6) 100%);
            box-shadow: 0 0 20px rgba(78, 205, 196, 0.5);
        }


        /* ===== RESPONSIVE ELEMENT SLOTS ===== */
        @media (max-width: 768px) {
            .element-slot {
                width: 36px !important;
                height: 36px !important;
            }
            
            .element-slot .emoji {
                font-size: 20px !important;
            }
            
            /* Small screen specific grid layouts */
            @media (max-width: 768px) {
                .element-collection-bar.two-rows[data-slots="9"] {
                    grid-template-columns: repeat(5, 36px) !important;
                }
                
                .element-collection-bar.two-rows[data-slots="10"] {
                    grid-template-columns: repeat(5, 36px) !important;
                }
                
                .element-collection-bar.two-rows[data-slots="11"] {
                    grid-template-columns: repeat(6, 36px) !important;
                }
                
                .element-collection-bar.two-rows[data-slots="12"] {
                    grid-template-columns: repeat(6, 36px) !important;
                }
            }
        }

        /* ===== COLLAPSIBLE SCOREBOARD ENHANCEMENT ===== */
        body.mobile .leaderboard-box {
            transition: all 0.3s ease !important;
            max-height: none !important;
            overflow: visible !important;
        }

        body.mobile .leaderboard-box.collapsed {
            width: 320px !important; /* Keep same width as expanded */
            min-height: 40px !important;
        }

        body.mobile .leaderboard-box.collapsed .leaderboard-header {
            font-size: 11px !important; /* Keep same size as expanded */
            padding: 10px !important;
            margin: 0 !important;
        }
        
        /* Hide scrollable content when collapsed, not the entries themselves */
        body.mobile .leaderboard-box.collapsed .scrollable-content {
            display: none !important;
        }
        
        /* Ensure entries are visible when expanded */
        body.mobile .leaderboard-box:not(.collapsed) .scrollable-content {
            display: block !important;
            max-height: 250px !important;
            overflow-y: auto !important;
        }
        
        body.mobile .leaderboard-box:not(.collapsed) .leaderboard-entry {
            display: flex !important;
            visibility: visible !important;
            opacity: 1 !important;
            justify-content: space-between !important;
            align-items: center !important;
            gap: 10px !important;
        }
        
        /* Fix leaderboard text overflow on mobile */
        body.mobile .leaderboard-name {
            flex: 1 !important;
            min-width: 0 !important; /* Important for text-overflow to work */
            overflow: hidden !important;
            text-overflow: ellipsis !important;
            white-space: nowrap !important;
            display: block !important;
            max-width: 60% !important; /* Ensure space for score */
            font-family: 'Press Start 2P', monospace !important;
            text-transform: uppercase !important;
        }
        
        body.mobile .leaderboard-stats {
            flex-shrink: 0 !important;
            white-space: nowrap !important;
            margin-left: auto !important;
        }
        
        /* Fix for the SCOREBOARD header font size */
        body.mobile .leaderboard-box .leaderboard-header {
            font-size: 11px !important;
            font-family: 'Press Start 2P', monospace !important;
            text-transform: none !important;
            letter-spacing: 0 !important;
            margin: 0 !important;
            padding: 10px !important;
            box-sizing: border-box !important;
        }
        
        /* Remove any duplicate headers */
        body.mobile .mobile-leaderboard-header {
            display: none !important;
        }

        /* ===== IPAD MINI SPECIFIC OPTIMIZATIONS ===== */
        @media (min-width: 768px) and (max-width: 1024px) {
            /* Slightly larger controls for iPad Mini */
            .virtual-joystick {
                width: 140px !important;
                height: 140px !important;
            }
            
            body.mobile .player-info-box {
                width: 240px !important;
            }
            
            body.mobile .leaderboard-box {
                width: 260px !important;
            }
            
            .element-slot {
                width: 44px !important;
                height: 44px !important;
            }
        }

        
        /* Override circular shapes for mobile controls */
        body.mobile .joystick-base,
        body.mobile .joystick-knob {
            border-radius: 0 !important;
        }
        
        /* ===== SCOREBOARD HEADER CLICKABILITY FIX ===== */
        body.mobile .leaderboard-box .leaderboard-header {
            position: relative !important;
            z-index: 1010 !important;
            pointer-events: auto !important;
            cursor: pointer !important;
            -webkit-tap-highlight-color: transparent !important;
            user-select: none !important;
            min-height: 40px !important;
            display: flex !important;
            align-items: center !important;
        }
        
        body.mobile .leaderboard-box {
            pointer-events: auto !important;
        }
        
        /* ===== VIRTUAL JOYSTICK SIZE FIX ===== */
        body.mobile .mobile-controls .virtual-joystick {
            width: 105px !important;
            height: 105px !important;
            bottom: 120px !important;
            left: 80px !important;
            right: auto !important;
            position: fixed !important;
            z-index: 1002 !important;
        }
        
        /* ===== MOBILE CONTROLS VISUAL STYLING ===== */
        /* Work WITH JavaScript sizing, not against it */
        
        
        /* Remove circular joystick styles */
        body.mobile .joystick-base {
            border-radius: 0 !important;
        }
        
        body.mobile .joystick-knob {
            border-radius: 0 !important;
        }
        
        /* ===== FPS COUNTER POSITION FIX ===== */
        body.mobile #pauseText {
            display: none !important; /* Hide keyboard shortcuts on mobile */
        }

            font-size: 10px !important;
            color: rgba(255, 255, 255, 0.5) !important;
        }
        
        /* ===== UNIFIED LANDSCAPE POSITIONING ===== */
        @media screen and (orientation: landscape) and (max-width: 1024px) {
            /* Ensure consistent positioning without conflicts */
            body.mobile .player-info-box,
            body.mobile .leaderboard-box {
                z-index: 21; /* Above game elements but below controls */
            }
            
            /* Adjust element collection slots for landscape */
            body.mobile .element-slot {
                width: 32px;
                height: 32px;
            }
            
            body.mobile .element-slot .emoji {
                font-size: 18px;
            }
        }
        
        /* ===== MOBILE PAUSE MENU FIXES ===== */
        @media (max-width: 768px) {
            #pauseMenu {
                width: 95vw !important;
                height: 95vh !important;
                max-width: 95vw !important;
                max-height: 95vh !important;
                padding: 16px !important;
            }
            
            /* Smaller tab buttons for mobile */
            .tab-button {
                padding: 8px 12px !important;
                font-size: 8px !important;
                box-shadow: 2px 2px 0 rgba(0,0,0,0.5) !important;
            }
            
            .tab-navigation {
                gap: 4px !important;
                margin: 8px 0 !important;
                padding-bottom: 8px !important;
            }
            
            /* Fix skin grid for mobile */
            #skinGrid {
                gap: 8px !important;
                padding-right: 10px !important;
            }
            
            
            .skin-item {
                padding: 6px !important;
            }
            
            .skin-item h5 {
                font-size: 8px !important;
                margin-top: 4px !important;
            }
            
            .skin-preview {
                width: 40px !important;
                height: 40px !important;
            }
            
            /* Fix discovery grid for mobile */
            .discovery-grid {
                grid-template-columns: repeat(4, 1fr) !important;
                gap: 8px !important;
                padding-right: 5px !important;
            }
            
            .discovery-item {
                padding: 2px !important;
            }
            
            .discovery-item .emoji {
                font-size: 24px !important;
            }
            
            .discovery-item .discovery-item-name {
                font-size: 7px !important;
            }
            
            /* Headers in pause menu */
            #pauseMenu h3 {
                font-size: 14px !important;
                margin-bottom: 8px !important;
            }
            
            #pauseMenu h4 {
                font-size: 12px !important;
                margin-bottom: 8px !important;
            }
            
            /* Available unlocks text */
            #availableUnlocks {
                font-size: 12px !important;
                margin-bottom: 8px !important;
            }
            
            /* Discovery count text */
            #discoveryCount {
                font-size: 10px !important;
                margin-bottom: 8px !important;
            }
            
            /* Tab content adjustments */
            .tab-content {
                flex: 1;
                /* Remove display: flex here - only active tabs should display */
                flex-direction: column;
                min-height: 0;
                overflow: hidden;
            }
            
            /* Ensure proper scrolling */
            #skinSelection,
            #discoveryJournal {
                height: 100% !important;
                display: flex !important;
                flex-direction: column !important;
                overflow: hidden !important;
            }
            
            
            /* Fix button spacing in pause menu */
            #pauseMenu button {
                margin: 4px !important;
            }
            
            /* Fix leaderboard content on mobile */
            #leaderboardContent {
                padding: 10px !important;
                max-height: calc(90vh - 140px) !important;
            }
            
            /* Make leaderboard grid responsive */
            #leaderboardContent > div[style*="grid-template-columns"] {
                grid-template-columns: 40px 1fr 60px 60px 60px 50px !important;
                gap: 5px !important;
                font-size: 10px !important;
            }
            
            /* How to play content */
            #howToPlayTab {
                font-size: 10px !important;
                line-height: 1.4 !important;
            }
            
            #howToPlayTab h4 {
                font-size: 11px !important;
            }
            
            #howToPlayTab ul {
                padding-left: 15px !important;
            }
            
            /* Resume and New Game buttons */
            button[onclick*="resumeGame"],
            button[onclick*="reload"] {
                padding: 8px 20px !important;
                font-size: 12px !important;
                margin: 5px !important;
            }
            
            /* Fix the bottom button container */
            #pauseMenu > div > div[style*="margin-top: 20px"] {
                margin-top: 10px !important;
                padding-top: 10px !important;
            }
        }
        
        /* Landscape mobile specific */
        @media screen and (orientation: landscape) and (max-width: 812px) {
            #pauseMenu {
                padding: 12px !important;
            }
            
            .tab-button {
                padding: 6px 10px !important;
                font-size: 7px !important;
            }
            
            /* Even smaller grids in landscape */
            .discovery-grid {
                grid-template-columns: repeat(4, 1fr) !important;
                gap: 6px !important;
            }
            
            .skin-preview {
                width: 35px !important;
                height: 35px !important;
            }
            
            .discovery-item .emoji {
                font-size: 20px !important;
            }
            
            #pauseMenu h3 {
                font-size: 12px !important;
            }
            
            #pauseMenu h4 {
                font-size: 10px !important;
            }
        }
        
        /* Small mobile portrait (iPhone SE, etc) */
        @media (max-width: 375px) and (orientation: portrait) {
            .discovery-grid {
                grid-template-columns: repeat(2, 1fr) !important;
            }
            
            .tab-button {
                padding: 6px 8px !important;
                font-size: 7px !important;
            }
        }
        
        /* ===== CRITICAL MOBILE POSITIONING FIX ===== */
        /* Ensure scorecard and leaderboard ALWAYS appear at TOP on mobile */
        @media (max-width: 1024px) {
            body.mobile .player-info-box {
                position: fixed !important;
                top: 20px !important;
                bottom: unset !important;
                left: 10px !important;
                right: auto !important;
            }
            
            body.mobile .leaderboard-box {
                position: fixed !important;
                top: 20px !important;
                bottom: unset !important;
                right: 10px !important;
                left: auto !important;
            }
        }
        
        /* Landscape adjustments - removed hardcoded positions that were overriding CSS variables */
        
        
        
        
        /* Ensure tab content takes remaining height */
        .tab-content {
            /* Remove fixed height calculation - let flexbox handle it */
            flex: 1;
            /* Remove display: flex here - only active tabs should display */
            flex-direction: column;
            min-height: 0;
            overflow: hidden;
        }
        
        /* Rarity tabs should not cause overflow */
        .rarity-tabs {
            flex-shrink: 0; /* Prevent tabs from shrinking */
            margin-bottom: 15px;
            max-width: 100%;
            overflow-x: auto;
            overflow-y: hidden;
            scrollbar-width: thin;
        }
        
        /* Available unlocks should not cause overflow */
        #availableUnlocks {
            flex-shrink: 0;
            flex-shrink: 0; /* Prevent from shrinking */
            margin-bottom: 10px;
        }
        
        /* Mobile-specific overflow fixes */
        @media (max-width: 768px) {
            #pauseMenu {
                padding: 20px !important;
            }
            
            .tab-content {
                flex: 1;
                min-height: 0;
            }
            
            #skinGrid {
                padding-bottom: 20px; /* Add extra bottom padding for last row visibility */
            }
        }
        
        /* Landscape mobile specific */
        @media screen and (orientation: landscape) and (max-width: 812px) {
            #pauseMenu {
                height: 85vh !important;
                max-height: 85vh !important;
            }
            
            .tab-content {
                flex: 1;
                min-height: 0;
            }
        }
        
        /* Critical flexbox structure fixes for pause menu */
        #pauseMenu > h2,
        #pauseMenu > p {
            flex-shrink: 0;
        }
        
        .tab-navigation {
            flex-shrink: 0;
            margin-bottom: 15px;
        }
        
        /* Bottom buttons container */
        #pauseMenu > div:last-child {
            flex-shrink: 0;
            margin-top: 10px;
        }
        
        /* Fix for tab content display */
        .tab-content.active {
            display: flex !important;
            flex-direction: column;
        }
        
        /* Settings tab now uses the same structure as other working tabs */
        /* Removed custom CSS rules that were causing conflicts */
        
        /* Ensure skin selection fills space properly */
        #skinSelection {
            flex: 1;
            min-height: 0;
        }
        
        
        /* Firefox scrollbar support */
        * {
            scrollbar-width: thin;
        }
        
        /* Welcome Modal Styles */
        .welcome-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 10000;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .welcome-modal-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            cursor: pointer;
        }
        
        .welcome-modal-content {
            position: relative;
            background: #1a1a2e; /* Solid dark background */
            border: 4px solid var(--snes-cosmic-purple);
            border-radius: 0;
            padding: 30px;
            max-width: 600px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 
                inset 2px 2px 0 var(--snes-cosmic-pink),
                inset -2px -2px 0 var(--snes-dark-purple),
                8px 8px 0 rgba(0,0,0,0.5);
            font-family: 'Press Start 2P', monospace;
        }
        
        .welcome-modal-close {
            position: absolute;
            top: 10px;
            right: 10px;
            background: var(--snes-cosmic-purple);
            color: var(--snes-white);
            border: 2px solid var(--snes-cosmic-pink);
            padding: 5px 10px;
            font-size: 16px;
            cursor: pointer;
            font-family: 'Press Start 2P', monospace;
            box-shadow: 2px 2px 0 rgba(0,0,0,0.5);
            transition: none;
        }
        
        .welcome-modal-close:hover {
            background: var(--snes-cosmic-pink);
            transform: translate(1px, 1px);
            box-shadow: 1px 1px 0 rgba(0,0,0,0.5);
        }
        
        .welcome-modal-content h2 {
            color: var(--snes-white);
            font-size: 16px;
            margin-bottom: 20px;
            
            text-transform: uppercase;
            text-shadow: 2px 2px 0 rgba(0,0,0,0.5);
        }
        
        .title-green {
            color: #4ECB71; /* Bright green */
        }
        
        .title-yellow {
            color: #FFD700; /* Gold/yellow */
        }
        
        .welcome-message {
            color: var(--snes-white);
            font-size: 10px;
            line-height: 2;
        }
        
        .welcome-message p {
            margin-bottom: 15px;
        }
        
        .welcome-message a {
            color: var(--snes-cosmic-blue);
            text-decoration: none;
            border-bottom: 2px solid var(--snes-cosmic-blue);
            transition: none;
        }
        
        .welcome-message a:hover {
            color: var(--snes-cosmic-pink);
            border-bottom-color: var(--snes-cosmic-pink);
        }
        
        .welcome-message .link-blue {
            color: #4A90E2; /* Nice blue color */
            border-bottom-color: #4A90E2;
        }
        
        .welcome-message .link-blue:hover {
            color: #6BB6FF; /* Lighter blue on hover */
            border-bottom-color: #6BB6FF;
        }
        
        .welcome-message .signature {
            text-align: right;
            color: var(--snes-cosmic-pink);
            margin-top: 20px;
            font-style: italic;
        }
        
        /* Mobile adjustments for welcome modal */
        @media (max-width: 768px) {
            .welcome-modal-content {
                padding: 20px;
                width: 95%;
                max-height: 70vh;
            }
            
            .welcome-modal-content h2 {
                font-size: 12px;
            }
            
            .welcome-message {
                font-size: 8px;
            }
        }
        
        /* Title Page Footer Styles */
        .title-footer-links {
            display: flex;
            justify-content: center;
            gap: 1.5rem;
            flex-wrap: nowrap;
        }
        
        .title-footer-links a {
            color: #00ff00;
            text-decoration: none;
            font-family: 'Press Start 2P', monospace;
            font-size: 10px;
            padding: 0.25rem 0.5rem;
            border: 1px solid transparent;
            transition: all 0.3s ease;
        }
        
        .title-footer-links a:hover {
            border-color: #00ff00;
            background-color: rgba(0, 255, 0, 0.1);
        }
        
    </style>
    
    <!-- Force text centering override -->
    <style>
        /* Maximum specificity override for stubborn text alignment */
        html body .gameplay-showcase p.feature-description,
        html body .story-section p.story-text,
        html body .gameplay-showcase div p,
        html body .story-section div p {
            text-align: center !important;
            display: block !important;
            width: 100% !important;
        }
        
        /* Also target any paragraph inside these sections */
        .gameplay-showcase p,
        .story-section p,
        .section-subtitle,
        p.section-subtitle,
        .section-block p.section-subtitle,
        .gameplay-showcase p.section-subtitle,
        html body p.section-subtitle,
        html body .section-block p.section-subtitle,
        html body .gameplay-showcase p.section-subtitle {
            text-align: center !important;
            display: block !important;
        }
        
        /* Nuclear option - target by content */
        p:contains("THE UNIVERSE COLLAPSED"),
        p:contains("Mix and match") {
            text-align: center !important;
        }
        
        /* Mobile-specific styles for game mode selection */
        body.mobile #mobileMessage {
            display: block !important;
        }
        
        /* Mobile modes are now enabled - no restrictions */
        
        /* Mobile canvas - no zoom for full screen gameplay */
        body.mobile #gameCanvas {
            transform: none !important;
            transform-origin: center center;
            width: 100vw !important;
            height: 100vh !important;
            position: fixed !important;
            top: 0 !important;
            left: 0 !important;
            z-index: 0 !important;
        }
        
        
        /* Position joystick on left side for mobile */
        body.mobile .virtual-joystick {
            left: 80px !important;
            right: auto !important;
            bottom: 120px !important;
            width: 105px !important;
            height: 105px !important;
        }
        
        /* Mobile boost button */
        .mobile-boost-button {
            position: absolute;
            bottom: 120px;
            right: 80px;
            width: 105px;
            height: 105px;
            background: rgba(255, 255, 255, 0.05);
            border: 3px solid rgba(255, 255, 255, 0.15);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            pointer-events: auto;
            touch-action: none;
            z-index: 1005;
            transition: all 0.2s ease;
            display: none;
        }
        
        body.mobile .mobile-boost-button {
            display: flex !important;
        }
        
        .mobile-boost-button:active,
        .mobile-boost-button.active {
            background: rgba(255, 255, 255, 0.1);
            border-color: rgba(255, 255, 255, 0.3);
            transform: scale(0.95);
        }
        
        .boost-button-text {
            color: rgba(255, 255, 255, 0.5);
            font-size: 12px;
            font-family: 'Press Start 2P', monospace;
            text-align: center;
            user-select: none;
        }
        
        /* Game Hint Styling */
        #gameHint {
            position: fixed;
            top: 60px;
            left: 20px;
            background: rgba(0, 0, 20, 0.9);
            border: 2px solid var(--snes-cosmic-teal);
            border-radius: 0;
            padding: 12px 20px;
            font-family: 'Press Start 2P', monospace;
            font-size: 10px;
            line-height: 16px;
            color: #00D9FF;
            opacity: 0;
            transition: opacity 0.5s ease-in-out;
            z-index: 15;
            max-width: 400px;
            pointer-events: none;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.5);
            display: none;
        }
        
        #gameHint.show {
            display: block;
            opacity: 1;
        }
        
        /* Mobile positioning for hint */
        body.mobile #gameHint {
            top: auto;
            bottom: 160px; /* Below player stat box */
            left: 50%;
            right: auto;
            transform: translateX(-50%);
            max-width: 250px; /* Make less wide */
            font-size: 9px;
            padding: 8px 12px;
            text-align: center;
        }
        
        }
    </style>

    <!-- External Dependencies -->
    <script src="elements/data/loader.js?v=1.12.0"></script>
    <script src="js/asset-preloader.js?v=1.12.0"></script>
    
    <!-- Version System -->
    <script>
        // Load and display version
        fetch('/version.json?t=' + Date.now())
            .then(res => res.json())
            .then(data => {
                const versionElement = document.getElementById('versionNumber');
                if (versionElement) {
                    versionElement.textContent = data.version;
                }
                
                window.GAME_VERSION = data.version;
            })
            .catch(err => {
                console.log('Version file not found, using default');
                window.GAME_VERSION = '1.0.0';
            });
    </script>
    
    <!-- Skin System -->
    <script src="js/skinData.js?v=1.12.0" defer></script>
    <script src="js/skinIdMapping.js?v=1.12.0" defer></script>
    <script src="js/codeValidator.js?v=1.12.0" defer></script>
    <script src="js/loreData.js?v=1.12.0" defer></script>
    <script src="js/playerStats.js?v=1.12.0" defer></script>
    <script src="js/killstreakManager.js?v=1.12.0" defer></script>
    <script src="js/unlockManager.js?v=1.12.0" defer></script>
    <script src="js/loreUnlockManager.js?v=1.12.0" defer></script>
    <script src="js/nameGenerator.js?v=1.12.0" defer></script>
    
    <!-- Rendering Systems -->
    <script src="js/webgl-renderer.js?v=1.12.0"></script>
    <script src="js/quadtree.js?v=1.12.0"></script>
    <script src="js/performance-optimizer.js?v=1.12.0"></script>
    <script src="js/math-optimizations.js?v=1.12.0"></script>
    <script src="js/texture-atlas.js?v=1.12.0"></script>
    <script src="js/gpu-particle-system.js?v=1.12.0"></script>
    <script src="js/mobile-star-renderer.js?v=1.12.0"></script>
    <script src="js/battery-optimizer.js?v=1.12.0"></script>
    <script src="js/mobile-background-optimizer.js?v=1.12.0"></script>
    <script src="js/mobile-background-integration.js?v=1.12.0"></script>
    
    <!-- Modernized Systems -->
    <script src="js/core/module-loader.js?v=1.12.0"></script>
    <script src="js/core/init-sequence.js?v=1.12.0" type="module"></script>
    
    <!-- Logger (must load before game-original.js) -->
    <script src="js/core/logger.js?v=1.12.0"></script>
    <!-- Game Entities -->
    <!-- Particle and ParticlePool are loaded by the module system -->
    <!-- Spaceship modules disabled - not using spaceships -->
    <!-- <script src="js/core/entities/Spaceship.js?v=1.12.0" type="module"></script> -->
    <!-- <script src="js/core/entities/SpaceshipManager.js?v=1.12.0" type="module"></script> -->
    
    <!-- Main Game Code (extracted from inline script) -->
    <script src="js/core/rendering/batch-renderer.js?v=1.12.0" defer></script>
    <script src="js/core/collision/spatial-hash.js?v=1.12.0" defer></script>
    
    <!-- Performance Optimization Systems -->
    <script src="js/performance/canvas-layers.js?v=1.12.0" defer></script>
    <script src="js/performance/gradient-cache.js?v=1.12.0" defer></script>
    <script src="js/performance/canvas-state-optimizer.js?v=1.12.0" defer></script>
    <script src="js/performance/enhanced-batch-renderer.js?v=1.12.0" defer></script>
    
    <script src="js/core/game-original.js?v=1.12.0" defer></script>
    
    <!-- Performance Integration (must load after game-original.js) -->
    <script src="js/performance-integration.js?v=1.12.0" defer></script>
    
    
    <!-- Integration -->
    <script>
        // Wait for modules to load
        window.addEventListener('gameReady', function(e) {
            console.log('Modernized systems ready');
        });
        
        // Configure mobile UI
        window.MOBILE_UI_CONFIG = window.MOBILE_UI_CONFIG || {};
        window.MOBILE_UI_CONFIG.mode = 'fixed'; // or 'slideout'
        
        // Enable debug in development
        if (location.hostname === 'localhost' || location.hostname === '127.0.0.1') {
            window.DEBUG_CONFIG = window.DEBUG_CONFIG || {};
            window.DEBUG_CONFIG.enabled = true;
            // Debug mode enabled for development
        }
    </script>
    
    <!-- Analytics (if needed) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YOUR_ID"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-YOUR_ID');
    </script>
    
    <!-- Tab switching function -->
    <script>
        // Tab switching for pause menu
        window.switchTab = function(tabName) {
            // Update button states
            const buttons = document.querySelectorAll('.tab-button');
            buttons.forEach(btn => btn.classList.remove('active'));
            if (event && event.target) {
                event.target.classList.add('active');
            }
            
            // Update content visibility
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
                // Remove any inline styles that might interfere
                content.style.display = '';
                content.style.visibility = '';
                content.style.opacity = '';
            });
            
            // Activate the selected tab
            const tabMap = {
                'skins': 'skinsTab',
                'journal': 'journalTab',
                'howto': 'howtoTab',
                'leaderboard': 'leaderboardTab'
            };
            
            const tabId = tabMap[tabName];
            if (tabId) {
                const tab = document.getElementById(tabId);
                if (tab) {
                    tab.classList.add('active');
                    
                    // Special handling for specific tabs
                    if (tabName === 'journal' && typeof populateDiscoveryJournal === 'function') {
                        populateDiscoveryJournal();
                    } else if (tabName === 'leaderboard' && typeof loadPauseLeaderboard === 'function') {
                        setTimeout(() => loadPauseLeaderboard(null, 'weekly'), 50);
                    }
                }
            }
        };
    </script>
    
    <!-- Asset Preloading Script -->
    <script>
        // Initialize asset preloading on page load
        window.assetsReady = false;
        window.assetLoadingPromise = null;
        
        async function initializeAssetsOnLoad() {
            if (!window.AssetPreloader) {
                console.warn('AssetPreloader not available yet');
                return;
            }
            
            const loadingText = document.getElementById('loadingText');
            if (loadingText) {
                loadingText.style.display = 'inline';
            }
            
            try {
                window.assetPreloader = new AssetPreloader();
                window.preloadedAssets = await window.assetPreloader.preload((progress) => {
                    if (loadingText) {
                        loadingText.textContent = `Loading assets... ${Math.floor(progress.percent)}%`;
                    }
                });
                
                window.assetsReady = true;
                if (loadingText) {
                    loadingText.style.display = 'none';
                }
                console.log('Assets preloaded successfully');
            } catch (error) {
                console.error('Failed to preload assets:', error);
                window.assetsReady = true; // Allow game to continue with fallbacks
                if (loadingText) {
                    loadingText.style.display = 'none';
                }
            }
        }
        
        // Start loading assets when DOM is ready
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', () => {
                window.assetLoadingPromise = initializeAssetsOnLoad();
            });
        } else {
            window.assetLoadingPromise = initializeAssetsOnLoad();
        }
    </script>
    
    <!-- Random Name Cycling for Player Input -->
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const playerNameInput = document.getElementById('playerNameInput');
            let nameInterval;
            let isUserTyping = false;
            
            // Function to cycle through random names
            function cycleRandomNames() {
                // Only cycle if input is empty and user hasn't typed
                if (!playerNameInput.value && !isUserTyping && window.nameGenerator && window.nameGenerator.generateRandomName) {
                    const randomName = window.nameGenerator.generateRandomName();
                    playerNameInput.placeholder = randomName;
                }
            }
            
            // Wait for nameGenerator to be loaded (important for incognito mode)
            function waitForNameGenerator() {
                if (window.nameGenerator && window.nameGenerator.generateRandomName) {
                    // Start cycling names every 3 seconds
                    nameInterval = setInterval(cycleRandomNames, 3000);
                    
                    // Set initial random name
                    if (!playerNameInput.value) {
                        playerNameInput.placeholder = window.nameGenerator.generateRandomName();
                    }
                } else {
                    // Try again in 100ms
                    setTimeout(waitForNameGenerator, 100);
                }
            }
            
            // Start waiting for nameGenerator
            waitForNameGenerator();
            
            // Stop cycling when user starts typing and validate
            playerNameInput.addEventListener('input', () => {
                isUserTyping = playerNameInput.value.length > 0;
                if (isUserTyping) {
                    playerNameInput.placeholder = "Enter your name";
                    
                    // Real-time validation
                    const name = playerNameInput.value.trim();
                    if (name.length > 0) {
                        // Check if validateUsername function exists (from game-original.js)
                        if (window.validateUsername) {
                            const validation = window.validateUsername(name);
                            if (!validation.valid) {
                                window.showUsernameError(validation.error);
                            } else {
                                window.clearUsernameError();
                            }
                        }
                    } else {
                        // Clear error if input is empty
                        if (window.clearUsernameError) {
                            window.clearUsernameError();
                        }
                    }
                }
            });
            
            // Resume cycling if user clears the input
            playerNameInput.addEventListener('blur', () => {
                if (!playerNameInput.value) {
                    isUserTyping = false;
                }
            });
            
            // Also check for saved name
            const savedName = localStorage.getItem('playerName');
            if (savedName) {
                playerNameInput.value = savedName;
                isUserTyping = true;
            }
        });
    </script>
    
    <!-- Handle Main Menu Click -->
    <script>
        function handleMainMenuClick() {
            // Try multiple ways to end the game
            try {
                // Method 1: Direct dispatch
                if (window.dispatchEvent && window.CustomEvent) {
                    const event = new CustomEvent('gameEnd', { 
                        detail: { 
                            score: 0, 
                            mode: window.gameMode || 'cozy',
                            discoveries: 0,
                            kills: 0,
                            playTime: 0,
                            finalRank: 1
                        } 
                    });
                    window.dispatchEvent(event);
                }
                
                // Method 2: Try calling endGame if it exists
                if (typeof window.endGame === 'function') {
                    window.endGame();
                }
                
                // Method 3: Try recording directly to playerStats
                if (window.playerStats && window.playerStats.recordGameEnd) {
                    window.playerStats.recordGameEnd(0, window.gameMode || 'cozy');
                }
            } catch (e) {
                console.error('Error ending game:', e);
            }
            
            // Reload after a short delay
            setTimeout(() => {
                location.reload();
            }, 150);
        }
    </script>
    
    <script>
    // Scoreboard collapse functionality
    document.addEventListener('DOMContentLoaded', function() {
        const leaderboardBox = document.getElementById('leaderboardBox');
        const leaderboardHeader = leaderboardBox?.querySelector('.leaderboard-header');
        const collapseIcon = leaderboardBox?.querySelector('.collapse-icon');
        
        if (leaderboardHeader) {
            leaderboardHeader.addEventListener('click', function() {
                leaderboardBox.classList.toggle('collapsed');
                if (collapseIcon) {
                    collapseIcon.textContent = leaderboardBox.classList.contains('collapsed') ? 'â–¶' : 'â–¼';
                }
            });
        }
    });
    </script>
    
    <!-- Pause Menu Image Modal -->
    <div id="pauseImageModal" style="
        display: none;
        position: fixed;
        z-index: 10000;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0,0,0,0.95);
        cursor: pointer;
    " onclick="closePauseImageModal()">
        <span style="
            position: absolute;
            top: 20px;
            right: 40px;
            color: #F8F8F8;
            font-size: 40px;
            font-weight: bold;
            cursor: pointer;
            font-family: Arial;
            text-shadow: 0 0 10px rgba(120, 40, 248, 0.8);
        ">&times;</span>
        <img id="pauseModalImage" style="
            margin: auto;
            display: block;
            max-width: 90%;
            max-height: 90%;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            border: 4px solid #7828F8;
            box-shadow: 0 0 30px rgba(120, 40, 248, 0.8);
        ">
    </div>
    
    <script>
        function openPauseImageModal(src) {
            document.getElementById('pauseImageModal').style.display = 'block';
            document.getElementById('pauseModalImage').src = src;
        }
        
        function closePauseImageModal() {
            document.getElementById('pauseImageModal').style.display = 'none';
        }
        
        // Close modal on ESC key
        document.addEventListener('keydown', function(event) {
            if (event.key === 'Escape' && document.getElementById('pauseImageModal').style.display === 'block') {
                closePauseImageModal();
            }
        });
    </script>
    
    <!-- Vercel Web Analytics -->
    <script>
      window.va = window.va || function () { (window.vaq = window.vaq || []).push(arguments); };
    </script>
    <script defer src="/_vercel/insights/script.js"></script>
    
    <!-- Inline functions for Settings tab -->
    <script>
        // Function to redeem codes
        window.redeemCode = function() {
            const codeInput = document.getElementById('codeInput');
            const codeMessage = document.getElementById('codeMessage');
            
            if (!codeInput || !codeMessage) return;
            
            const code = codeInput.value.trim();
            
            if (!code) {
                codeMessage.style.color = '#ff6b6b';
                codeMessage.textContent = 'Please enter a code';
                return;
            }
            
            if (!window.unlockManager) {
                codeMessage.style.color = '#ff6b6b';
                codeMessage.textContent = 'System not ready, please try again';
                return;
            }
            
            // Try to redeem the code
            const result = window.unlockManager.redeemCode(code);
            
            if (result.success) {
                codeMessage.style.color = '#4ecdc4';
                codeMessage.textContent = result.message;
                codeInput.value = '';
                
                // Play success sound
                if (typeof playUISound === 'function') {
                    playUISound();
                }
                
                // Refresh the skin grid if visible
                if (window.loadSkinData) {
                    window.loadSkinData();
                }
            } else {
                codeMessage.style.color = '#ff6b6b';
                codeMessage.textContent = result.message;
            }
        }
        
        // Function to toggle mute
        window.toggleMute = function() {
            if (typeof toggleMusic === 'function') {
                toggleMusic();
            } else {
                console.log('Music toggle not available');
            }
        }
        
    </script>
    
    <!-- Mobile Phone Detection -->
    <script type="module" src="js/mobile/mobile-phone-detection.js"></script>
    <script type="module" src="js/mobile/mobile-phone-landing.js"></script>
    
</body>
</html>